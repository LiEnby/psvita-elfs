WebInspector.MemoryStatistics=function(a,b,c){this._timelinePanel=a;this._counters=[];b.addEventListener(WebInspector.TimelineModel.Events.RecordAdded,this._onRecordAdded,this);b.addEventListener(WebInspector.TimelineModel.Events.RecordsCleared,this._onRecordsCleared,this);this._containerAnchor=a.element.lastChild;this._memorySidebarView=new WebInspector.SidebarView(WebInspector.SidebarView.SidebarPosition.Start,void 0,c);this._memorySidebarView.sidebarElement.addStyleClass("sidebar");this._memorySidebarView.element.id=
"memory-graphs-container";this._memorySidebarView.addEventListener(WebInspector.SidebarView.EventTypes.Resized,this._sidebarResized.bind(this));this._canvasContainer=this._memorySidebarView.mainElement;this._canvasContainer.id="memory-graphs-canvas-container";this._createCurrentValuesBar();this._canvas=this._canvasContainer.createChild("canvas");this._canvas.id="memory-counters-graph";this._lastMarkerXPosition=0;this._canvas.addEventListener("mouseover",this._onMouseOver.bind(this),!0);this._canvas.addEventListener("mousemove",
this._onMouseMove.bind(this),!0);this._canvas.addEventListener("mouseout",this._onMouseOut.bind(this),!0);this._canvas.addEventListener("click",this._onClick.bind(this),!0);this._timelineGrid=new WebInspector.TimelineGrid;this._canvasContainer.appendChild(this._timelineGrid.dividersElement);this._memorySidebarView.sidebarElement.createChild("div","sidebar-tree sidebar-tree-section").textContent=WebInspector.UIString("COUNTERS");this._counterUI=this._createCounterUIList()};
WebInspector.MemoryStatistics.Counter=function(a){this.time=a};WebInspector.SwatchCheckbox=function(a,b){this.element=document.createElement("div");this._swatch=this.element.createChild("div","swatch");this.element.createChild("span","title").textContent=a;this._color=b;this.checked=!0;this.element.addEventListener("click",this._toggleCheckbox.bind(this),!0)};WebInspector.SwatchCheckbox.Events={Changed:"Changed"};
WebInspector.SwatchCheckbox.prototype={get checked(){return this._checked},set checked(a){this._checked=a;this._swatch.style.backgroundColor=this._checked?this._color:""},_toggleCheckbox:function(a){this.checked=!this.checked;this.dispatchEventToListeners(WebInspector.SwatchCheckbox.Events.Changed)},__proto__:WebInspector.Object.prototype};
WebInspector.CounterUIBase=function(a,b,c,e){this._memoryCountersPane=a;this.valueGetter=e;a=a._memorySidebarView.sidebarElement.createChild("div","memory-counter-sidebar-info");this._swatch=new WebInspector.SwatchCheckbox(WebInspector.UIString(b),c);this._swatch.addEventListener(WebInspector.SwatchCheckbox.Events.Changed,this._toggleCounterGraph.bind(this));a.appendChild(this._swatch.element);this._value=null;this.strokeColor=this.graphColor=c;this.graphYValues=[]};
WebInspector.CounterUIBase.prototype={_toggleCounterGraph:function(a){this._swatch.checked?this._value.removeStyleClass("hidden"):this._value.addStyleClass("hidden");this._memoryCountersPane.refresh()},updateCurrentValue:function(a){this._value.textContent=Number.bytesToString(this.valueGetter(a))},clearCurrentValueAndMarker:function(a){this._value.textContent=""},get visible(){return this._swatch.checked}};
WebInspector.MemoryStatistics.prototype={_createCurrentValuesBar:function(){throw Error("Not implemented");},_createCounterUIList:function(){throw Error("Not implemented");},_onRecordsCleared:function(){this._counters=[]},setMainTimelineGrid:function(a){this._mainTimelineGrid=a},setTopPosition:function(a){this._memorySidebarView.element.style.top=a+"px";this._updateSize()},setSidebarWidth:function(a){this._ignoreSidebarResize||(this._ignoreSidebarResize=!0,this._memorySidebarView.setSidebarWidth(a),
this._ignoreSidebarResize=!1)},_sidebarResized:function(a){this._ignoreSidebarResize||(this._ignoreSidebarResize=!0,this._timelinePanel.splitView.setSidebarWidth(a.data),this._ignoreSidebarResize=!1)},_canvasHeight:function(){throw Error("Not implemented");},_updateSize:function(){var a=this._mainTimelineGrid.dividersElement.offsetWidth+1;this._canvasContainer.style.width=a+"px";var b=this._canvasHeight();this._canvas.width=a;this._canvas.height=b},_onRecordAdded:function(a){throw Error("Not implemented");
},_draw:function(){this._calculateVisibleIndexes();this._calculateXValues();this._clear();this._setVerticalClip(10,this._canvas.height-20)},_calculateVisibleIndexes:function(){for(var a=this._timelinePanel.calculator,b=1E3*a.minimumBoundary(),a=1E3*a.maximumBoundary(),c=0,e=this._counters.length-1,d=0;d<this._counters.length;d++){var f=this._counters[d].time;if(f<=b)c=d;else{if(a<f)break;e=d}}this._minimumIndex=c;this._maximumIndex=e;this._minTime=b;this._maxTime=a},_onClick:function(a){a=this._recordIndexAt(a.x-
a.target.offsetParent.offsetLeft);(a=this._counters[a])&&this._timelinePanel.revealRecordAt(a.time/1E3)},_onMouseOut:function(a){delete this._markerXPosition;a=this._canvas.getContext("2d");this._clearCurrentValueAndMarker(a)},_clearCurrentValueAndMarker:function(a){for(var b=0;b<this._counterUI.length;b++)this._counterUI[b].clearCurrentValueAndMarker(a)},_onMouseOver:function(a){this._onMouseMove(a)},_onMouseMove:function(a){this._markerXPosition=a.x-a.target.offsetParent.offsetLeft;this._refreshCurrentValues()},
_refreshCurrentValues:function(){if(this._counters.length&&void 0!==this._markerXPosition&&-1!==this._maximumIndex){var a=this._recordIndexAt(this._markerXPosition);this._updateCurrentValue(this._counters[a]);this._highlightCurrentPositionOnGraphs(this._markerXPosition,a)}},_updateCurrentValue:function(a){for(var b=0;b<this._counterUI.length;b++)this._counterUI[b].updateCurrentValue(a)},_recordIndexAt:function(a){var b;for(b=this._minimumIndex+1;b<=this._maximumIndex&&!(a<this._counters[b].x);b++);
b--;return b},_highlightCurrentPositionOnGraphs:function(a,b){var c=this._canvas.getContext("2d");this._restoreImageUnderMarker(c);this._drawMarker(c,a,b)},_restoreImageUnderMarker:function(a){throw Error("Not implemented");},_drawMarker:function(a,b,c){throw Error("Not implemented");},visible:function(){return this._memorySidebarView.isShowing()},show:function(){this._memorySidebarView.show(this._timelinePanel.element,this._containerAnchor.nextSibling);this._updateSize();this._refreshDividers();
setTimeout(this._draw.bind(this),0)},refresh:function(){this._updateSize();this._refreshDividers();this._draw();this._refreshCurrentValues()},hide:function(){this._memorySidebarView.detach()},_refreshDividers:function(){this._timelineGrid.updateDividers(this._timelinePanel.calculator)},_setVerticalClip:function(a,b){this._originY=a;this._clippedHeight=b},_calculateXValues:function(){if(this._counters.length){var a=this._canvas.width,b=a/(this._maxTime-this._minTime);this._counters[this._minimumIndex].x=
0;for(var c=this._minimumIndex+1;c<this._maximumIndex;c++)this._counters[c].x=b*(this._counters[c].time-this._minTime);this._counters[this._maximumIndex].x=a}},_clear:function(){var a=this._canvas.getContext("2d");a.clearRect(0,0,a.canvas.width,a.canvas.height);this._discardImageUnderMarker()},_discardImageUnderMarker:function(){throw Error("Not implemented");}};WebInspector.DOMCountersGraph=function(a,b,c){WebInspector.MemoryStatistics.call(this,a,b,c)};
WebInspector.DOMCounterUI=function(a,b,c,e,d){var f="rgb("+e.join(",")+")";WebInspector.CounterUIBase.call(this,a,b,f,d);this._range=this._swatch.element.createChild("span");this._value=a._currentValuesBar.createChild("span","memory-counter-value");this._value.style.color=f;this._currentValueLabel=c;this.graphColor="rgba("+e.join(",")+",0.8)";this.graphYValues=[]};
WebInspector.DOMCountersGraph.Counter=function(a,b,c,e){WebInspector.MemoryStatistics.Counter.call(this,a);this.documentCount=b;this.nodeCount=c;this.listenerCount=e};
WebInspector.DOMCounterUI.prototype={setRange:function(a,b){this._range.textContent=WebInspector.UIString("[ %d - %d ]",a,b)},updateCurrentValue:function(a){this._value.textContent=WebInspector.UIString(this._currentValueLabel,this.valueGetter(a))},clearCurrentValueAndMarker:function(a){this._value.textContent="";this.restoreImageUnderMarker(a)},saveImageUnderMarker:function(a,b,c,e){e+=1;a=a.getImageData(b-e,c-e,2*e,2*e);this._imageUnderMarker={x:b-e,y:c-e,imageData:a}},restoreImageUnderMarker:function(a){this.visible&&
(this._imageUnderMarker&&a.putImageData(this._imageUnderMarker.imageData,this._imageUnderMarker.x,this._imageUnderMarker.y),this.discardImageUnderMarker())},discardImageUnderMarker:function(){delete this._imageUnderMarker},__proto__:WebInspector.CounterUIBase.prototype};
WebInspector.DOMCountersGraph.prototype={_createCurrentValuesBar:function(){this._currentValuesBar=this._canvasContainer.createChild("div");this._currentValuesBar.id="counter-values-bar";this._canvasContainer.addStyleClass("dom-counters")},_createCounterUIList:function(){return[new WebInspector.DOMCounterUI(this,"Document Count","Documents: %d",[100,0,0],function(a){return a.documentCount}),new WebInspector.DOMCounterUI(this,"DOM Node Count","Nodes: %d",[0,100,0],function(a){return a.nodeCount}),
new WebInspector.DOMCounterUI(this,"Event Listener Count","Listeners: %d",[0,0,100],function(a){return a.listenerCount})]},_canvasHeight:function(){return this._canvasContainer.offsetHeight-this._currentValuesBar.offsetHeight},_onRecordAdded:function(a){WebInspector.TimelinePresentationModel.forAllRecords([a.data],null,function(a){var c=a.counters;c&&this._counters.push(new WebInspector.DOMCountersGraph.Counter(a.endTime||a.startTime,c.documents,c.nodes,c.jsEventListeners))}.bind(this))},_draw:function(){WebInspector.MemoryStatistics.prototype._draw.call(this);
for(var a=0;a<this._counterUI.length;a++)this._drawGraph(this._counterUI[a])},_restoreImageUnderMarker:function(a){for(var b=0;b<this._counterUI.length;b++){var c=this._counterUI[b];c.visible&&c.restoreImageUnderMarker(a)}},_saveImageUnderMarker:function(a,b,c){for(var e=0;e<this._counterUI.length;e++){var d=this._counterUI[e];d.visible&&d.saveImageUnderMarker(a,b,d.graphYValues[c],2)}},_drawMarker:function(a,b,c){this._saveImageUnderMarker(a,b,c);for(var e=0;e<this._counterUI.length;e++){var d=this._counterUI[e];
if(d.visible){var f=d.graphYValues[c];a.beginPath();a.arc(b,f,2,0,2*Math.PI,!0);a.lineWidth=1;a.fillStyle=d.graphColor;a.strokeStyle=d.graphColor;a.fill();a.stroke();a.closePath()}}},_drawGraph:function(a){var b=this._canvas,c=b.getContext("2d"),b=b.width,e=this._clippedHeight,d=this._originY,f=a.valueGetter;if(this._counters.length){for(var g,h,k=this._minimumIndex;k<=this._maximumIndex;k++){var l=f(this._counters[k]);if(void 0===h||l<h)h=l;if(void 0===g||l>g)g=l}a.setRange(h,g);if(a.visible){l=
a.graphYValues;l.length=this._counters.length;g=(k=g-h)?e/k:1;c.beginPath();var m=d+(e-(f(this._counters[this._minimumIndex])-h)*g);c.moveTo(0,m);for(k=this._minimumIndex;k<=this._maximumIndex;k++){var n=this._counters[k].x;c.lineTo(n,m);m=d+(e-(f(this._counters[k])-h)*g);c.lineTo(n,m);l[k]=m}c.lineTo(b,m);c.lineWidth=1;c.strokeStyle=a.graphColor;c.stroke();c.closePath()}}},_discardImageUnderMarker:function(){for(var a=0;a<this._counterUI.length;a++)this._counterUI[a].discardImageUnderMarker()},__proto__:WebInspector.MemoryStatistics.prototype};
WebInspector.NativeMemoryGraph=function(a,b,c){WebInspector.MemoryStatistics.call(this,a,b,c)};WebInspector.NativeMemoryGraph.Counter=function(a,b){WebInspector.MemoryStatistics.Counter.call(this,a);this.nativeCounters=b};WebInspector.NativeMemoryCounterUI=function(a,b,c,e){var d=this._hslToString(c);WebInspector.CounterUIBase.call(this,a,b,d,e);this._value=this._swatch.element.createChild("span","memory-category-value");c[2]-=3;this.strokeColor=this._hslToString(c);this.graphYValues=[]};
WebInspector.NativeMemoryCounterUI.prototype={_hslToString:function(a){return"hsl("+a[0]+","+a[1]+"%,"+a[2]+"%)"},updateCurrentValue:function(a){a=this.valueGetter(a)/1048576;this._value.textContent=WebInspector.UIString("%.1f\u2009MB",a)},clearCurrentValueAndMarker:function(a){this._value.textContent=""},__proto__:WebInspector.CounterUIBase.prototype};
WebInspector.NativeMemoryGraph.prototype={_createCurrentValuesBar:function(){},_createCounterUIList:function(){function a(a,b){return b.nativeCounters&&b.nativeCounters[a]||0}for(var b="JSExternalResources CSS GlyphCache Image Resources DOM Rendering Audio WebInspector JSHeap.Used JSHeap.Unused MallocWaste Other PrivateBytes".split(" "),c=[],e=b.length-1;0<=e;e--){var d=b[e];"PrivateBytes"===d?this._privateBytesCounter=d=new WebInspector.NativeMemoryCounterUI(this,"Total",[0,0,0],a.bind(this,d)):
(d=new WebInspector.NativeMemoryCounterUI(this,d,[20*e,65,63],a.bind(this,d)),c.push(d))}return c.reverse()},_canvasHeight:function(){return this._canvasContainer.offsetHeight},_onRecordAdded:function(a){var b=this._counters;WebInspector.TimelinePresentationModel.forAllRecords([a.data],null,function(a){var e=a.nativeHeapStatistics;if(e){var d=0,f;for(f in e)"PrivateBytes"!==f&&(d+=e[f]);e.Other=e.PrivateBytes-d;b.push(new WebInspector.NativeMemoryGraph.Counter(a.endTime||a.startTime,e))}})},_draw:function(){WebInspector.MemoryStatistics.prototype._draw.call(this);
var a=this._maxCounterValue();this._resetTotalValues();for(var b,c=0;c<this._counterUI.length;c++)this._drawGraph(this._counterUI[c],b,a),this._counterUI[c].visible&&(b=this._counterUI[c])},_clearCurrentValueAndMarker:function(a){WebInspector.MemoryStatistics.prototype._clearCurrentValueAndMarker.call(this,a);this._privateBytesCounter.clearCurrentValueAndMarker(a)},_updateCurrentValue:function(a){WebInspector.MemoryStatistics.prototype._updateCurrentValue.call(this,a);this._privateBytesCounter.updateCurrentValue(a)},
_restoreImageUnderMarker:function(a){this._imageUnderMarker&&a.putImageData(this._imageUnderMarker.imageData,this._imageUnderMarker.x,this._imageUnderMarker.y);this._discardImageUnderMarker()},_saveImageUnderMarker:function(a,b,c,e,d){a=a.getImageData(b,c,e,d);this._imageUnderMarker={x:b,y:c,imageData:a}},_drawMarker:function(a,b,c){b=this._counters[c].x;c=c+1<this._counters.length?this._counters[c+1].x:b;var e=this._originY,e=0,d=e+this._clippedHeight,d=d+this._originY;this._saveImageUnderMarker(a,
b,e,c,d);a.beginPath();a.moveTo(b,e);a.lineTo(c,e);a.lineTo(c,d);a.lineTo(b,d);a.lineWidth=1;a.closePath();a.fillStyle="rgba(220,220,220,0.3)";a.fill()},_maxCounterValue:function(){if(!this._counters.length)return 0;for(var a=this._privateBytesCounter.valueGetter,b=0,c=this._minimumIndex;c<this._maximumIndex;c++){var e=a(this._counters[c]);e>b&&(b=e)}return b},_resetTotalValues:function(){for(var a=this._minimumIndex;a<=this._maximumIndex;a++)this._counters[a].total=0},_drawGraph:function(a,b,c){var e=
this._canvas,d=e.getContext("2d"),e=e.width,f=this._clippedHeight,g=this._originY,h=a.valueGetter;if(this._counters.length&&a.visible){for(var k=this._minimumIndex;k<=this._maximumIndex;k++){var l=this._counters[k],m=h(l);l.total+=m}h=a.graphYValues;h.length=this._counters.length;c=c?f/c:1;d.beginPath();if(b)for(l=b.graphYValues,b=l[this._maximumIndex],d.moveTo(e,b),m=e,k=this._maximumIndex-1;k>=this._minimumIndex;k--)b=l[k],m=this._counters[k].x,d.lineTo(m,b);else k=g+f,d.moveTo(e,k),d.lineTo(0,
k);b=g+(f-this._counters[this._minimumIndex].total*c);d.lineTo(0,b);for(k=this._minimumIndex;k<=this._maximumIndex;k++)l=this._counters[k],m=l.x,b=g+(f-l.total*c),d.lineTo(m,b),h[k]=b;d.lineTo(e,b);d.closePath();d.lineWidth=1;d.strokeStyle=a.strokeColor;d.fillStyle=a.graphColor;d.fill();d.stroke()}},_discardImageUnderMarker:function(){delete this._imageUnderMarker},__proto__:WebInspector.MemoryStatistics.prototype};
WebInspector.TimelineModel=function(){this._records=[];this._stringPool=new StringPool;this._maximumRecordTime=this._minimumRecordTime=-1;this._collectionEnabled=!1;WebInspector.timelineManager.addEventListener(WebInspector.TimelineManager.EventTypes.TimelineEventRecorded,this._onRecordAdded,this)};WebInspector.TimelineModel.TransferChunkLengthBytes=5E6;
WebInspector.TimelineModel.RecordType={Root:"Root",Program:"Program",EventDispatch:"EventDispatch",BeginFrame:"BeginFrame",ScheduleStyleRecalculation:"ScheduleStyleRecalculation",RecalculateStyles:"RecalculateStyles",InvalidateLayout:"InvalidateLayout",Layout:"Layout",Paint:"Paint",Rasterize:"Rasterize",ScrollLayer:"ScrollLayer",DecodeImage:"DecodeImage",ResizeImage:"ResizeImage",CompositeLayers:"CompositeLayers",ParseHTML:"ParseHTML",TimerInstall:"TimerInstall",TimerRemove:"TimerRemove",TimerFire:"TimerFire",
XHRReadyStateChange:"XHRReadyStateChange",XHRLoad:"XHRLoad",EvaluateScript:"EvaluateScript",MarkLoad:"MarkLoad",MarkDOMContent:"MarkDOMContent",TimeStamp:"TimeStamp",Time:"Time",TimeEnd:"TimeEnd",ScheduleResourceRequest:"ScheduleResourceRequest",ResourceSendRequest:"ResourceSendRequest",ResourceReceiveResponse:"ResourceReceiveResponse",ResourceReceivedData:"ResourceReceivedData",ResourceFinish:"ResourceFinish",FunctionCall:"FunctionCall",GCEvent:"GCEvent",RequestAnimationFrame:"RequestAnimationFrame",
CancelAnimationFrame:"CancelAnimationFrame",FireAnimationFrame:"FireAnimationFrame",WebSocketCreate:"WebSocketCreate",WebSocketSendHandshakeRequest:"WebSocketSendHandshakeRequest",WebSocketReceiveHandshakeResponse:"WebSocketReceiveHandshakeResponse",WebSocketDestroy:"WebSocketDestroy"};WebInspector.TimelineModel.Events={RecordAdded:"RecordAdded",RecordsCleared:"RecordsCleared"};WebInspector.TimelineModel.startTimeInSeconds=function(a){return a.startTime/1E3};
WebInspector.TimelineModel.endTimeInSeconds=function(a){return("undefined"===typeof a.endTime?a.startTime:a.endTime)/1E3};WebInspector.TimelineModel.durationInSeconds=function(a){return WebInspector.TimelineModel.endTimeInSeconds(a)-WebInspector.TimelineModel.startTimeInSeconds(a)};
WebInspector.TimelineModel.aggregateTimeForRecord=function(a,b){for(var c=0,e=b.children||[],d=0;d<e.length;++d)WebInspector.TimelineModel.aggregateTimeForRecord(a,e[d]),c+=WebInspector.TimelineModel.durationInSeconds(e[d]);e=WebInspector.TimelinePresentationModel.recordStyle(b).category.name;c=WebInspector.TimelineModel.durationInSeconds(b)-c;a[e]=(a[e]||0)+c};WebInspector.TimelineModel.aggregateTimeByCategory=function(a,b){for(var c in b)a[c]=(a[c]||0)+b[c]};
WebInspector.TimelineModel.prototype={startRecord:function(a,b){if(!this._collectionEnabled){this.reset();var c=WebInspector.settings.timelineLimitStackFramesFlag.get()?WebInspector.settings.timelineStackFramesToCapture.get():30;WebInspector.timelineManager.start(c,a,b);this._collectionEnabled=!0}},stopRecord:function(){this._collectionEnabled&&(WebInspector.timelineManager.stop(),this._collectionEnabled=!1)},get records(){return this._records},_onRecordAdded:function(a){this._collectionEnabled&&
this._addRecord(a.data)},_addRecord:function(a){this._stringPool.internObjectStrings(a);this._records.push(a);this._updateBoundaries(a);this.dispatchEventToListeners(WebInspector.TimelineModel.Events.RecordAdded,a)},loadFromFile:function(a,b){var c=new WebInspector.TimelineModelLoadFromFileDelegate(this,b),c=this._createFileReader(a,c),e=new WebInspector.TimelineModelLoader(this,c,b);c.start(e)},loadFromURL:function(a,b){var c=new WebInspector.TimelineModelLoadFromFileDelegate(this,b),c=new WebInspector.ChunkedXHRReader(a,
c),e=new WebInspector.TimelineModelLoader(this,c,b);c.start(e)},_createFileReader:function(a,b){return new WebInspector.ChunkedFileReader(a,WebInspector.TimelineModel.TransferChunkLengthBytes,b)},_createFileWriter:function(a,b){(new WebInspector.FileOutputStream).open(a,b)},saveToFile:function(){var a="TimelineRawData-"+(new Date).toISO8601Compact()+".json";this._createFileWriter(a,function(a){(new WebInspector.TimelineSaver(a)).save(this._records,window.navigator.appVersion)}.bind(this))},reset:function(){this._records=
[];this._stringPool.reset();this._maximumRecordTime=this._minimumRecordTime=-1;this.dispatchEventToListeners(WebInspector.TimelineModel.Events.RecordsCleared)},minimumRecordTime:function(){return this._minimumRecordTime},maximumRecordTime:function(){return this._maximumRecordTime},_updateBoundaries:function(a){var b=WebInspector.TimelineModel.startTimeInSeconds(a);a=WebInspector.TimelineModel.endTimeInSeconds(a);if(-1===this._minimumRecordTime||b<this._minimumRecordTime)this._minimumRecordTime=b;
if(-1===this._maximumRecordTime||a>this._maximumRecordTime)this._maximumRecordTime=a},recordOffsetInSeconds:function(a){return WebInspector.TimelineModel.startTimeInSeconds(a)-this._minimumRecordTime},__proto__:WebInspector.Object.prototype};WebInspector.TimelineModelLoader=function(a,b,c){this._model=a;this._reader=b;this._progress=c;this._buffer="";this._firstChunk=!0};
WebInspector.TimelineModelLoader.prototype={write:function(a){a=this._buffer+a;var b=0,c;do c=b,b=WebInspector.findBalancedCurlyBrackets(a,c);while(-1!==b);b=a.slice(0,c)+"]";this._buffer=a.slice(c);if(c){this._firstChunk||(b="[0"+b);var e;try{e=JSON.parse(b)}catch(d){WebInspector.showErrorMessage("Malformed timeline data.");this._model.reset();this._reader.cancel();this._progress.done();return}this._firstChunk&&(this._version=e[0],this._firstChunk=!1,this._model.reset());a=1;for(c=e.length;a<c;++a)this._model._addRecord(e[a])}},
close:function(){}};WebInspector.TimelineModelLoadFromFileDelegate=function(a,b){this._model=a;this._progress=b};
WebInspector.TimelineModelLoadFromFileDelegate.prototype={onTransferStarted:function(){this._progress.setTitle(WebInspector.UIString("Loading\u2026"))},onChunkTransferred:function(a){if(this._progress.isCanceled())a.cancel(),this._progress.done(),this._model.reset();else{var b=a.fileSize();b&&(this._progress.setTotalWork(b),this._progress.setWorked(a.loadedSize()))}},onTransferFinished:function(){this._progress.done()},onError:function(a,b){this._progress.done();this._model.reset();switch(b.target.error.code){case FileError.NOT_FOUND_ERR:WebInspector.showErrorMessage(WebInspector.UIString('File "%s" not found.',
a.fileName()));break;case FileError.NOT_READABLE_ERR:WebInspector.showErrorMessage(WebInspector.UIString('File "%s" is not readable',a.fileName()));break;case FileError.ABORT_ERR:break;default:WebInspector.showErrorMessage(WebInspector.UIString('An error occurred while reading the file "%s"',a.fileName()))}}};WebInspector.TimelineSaver=function(a){this._stream=a};
WebInspector.TimelineSaver.prototype={save:function(a,b){this._records=a;this._recordIndex=0;this._prologue="["+JSON.stringify(b);this._writeNextChunk(this._stream)},_writeNextChunk:function(a){var b=[],c=0;if(this._prologue)b.push(this._prologue),c+=this._prologue.length,delete this._prologue;else{if(this._recordIndex===this._records.length){a.close();return}b.push("")}for(;this._recordIndex<this._records.length;){var e=JSON.stringify(this._records[this._recordIndex]),d=e.length+2;if(c+d>WebInspector.TimelineModel.TransferChunkLengthBytes)break;
c+=d;b.push(e);++this._recordIndex}this._recordIndex===this._records.length&&b.push(b.pop()+"]");a.write(b.join(",\n"),this._writeNextChunk.bind(this))}};
WebInspector.TimelineOverviewPane=function(a){WebInspector.View.call(this);this.element.id="timeline-overview-panel";this._windowStartTime=0;this._windowEndTime=Infinity;this._eventDividers=[];this._model=a;this._topPaneSidebarElement=document.createElement("div");this._topPaneSidebarElement.id="timeline-overview-sidebar";var b=document.createElement("ol");b.className="sidebar-tree";this._topPaneSidebarElement.appendChild(b);this.element.appendChild(this._topPaneSidebarElement);b=new TreeOutline(b);
this._overviewItems={};this._overviewItems[WebInspector.TimelineOverviewPane.Mode.Events]=new WebInspector.SidebarTreeElement("timeline-overview-sidebar-events",WebInspector.UIString("Events"));Capabilities.timelineSupportsFrameInstrumentation&&(this._overviewItems[WebInspector.TimelineOverviewPane.Mode.Frames]=new WebInspector.SidebarTreeElement("timeline-overview-sidebar-frames",WebInspector.UIString("Frames")));this._overviewItems[WebInspector.TimelineOverviewPane.Mode.Memory]=new WebInspector.SidebarTreeElement("timeline-overview-sidebar-memory",
WebInspector.UIString("Memory"));for(var c in this._overviewItems){var e=this._overviewItems[c];e.onselect=this.setMode.bind(this,c);b.appendChild(e)}this._overviewGrid=new WebInspector.OverviewGrid("timeline");this.element.appendChild(this._overviewGrid.element);c=document.createElement("div");c.id="timeline-overview-separator";this.element.appendChild(c);this._innerSetMode(WebInspector.TimelineOverviewPane.Mode.Events);c=WebInspector.TimelinePresentationModel.categories();for(var d in c)c[d].addEventListener(WebInspector.TimelineCategory.Events.VisibilityChanged,
this._onCategoryVisibilityChanged,this);this._overviewCalculator=new WebInspector.TimelineOverviewCalculator;a.addEventListener(WebInspector.TimelineModel.Events.RecordAdded,this._onRecordAdded,this);a.addEventListener(WebInspector.TimelineModel.Events.RecordsCleared,this._reset,this);this._overviewGrid.addEventListener(WebInspector.OverviewGrid.Events.WindowChanged,this._onWindowChanged,this)};WebInspector.TimelineOverviewPane.Mode={Events:"Events",Frames:"Frames",Memory:"Memory"};
WebInspector.TimelineOverviewPane.Events={ModeChanged:"ModeChanged",WindowChanged:"WindowChanged"};
WebInspector.TimelineOverviewPane.prototype={wasShown:function(){this._update()},onResize:function(){this._update()},setMode:function(a){this._currentMode!==a&&(this._innerSetMode(a),this.dispatchEventToListeners(WebInspector.TimelineOverviewPane.Events.ModeChanged,this._currentMode),this._update())},_innerSetMode:function(a){this._overviewControl&&this._overviewControl.detach();this._currentMode=a;this._overviewControl=this._createOverviewControl();this._overviewControl.show(this._overviewGrid.element);
this._overviewItems[this._currentMode].revealAndSelect(!1)},_createOverviewControl:function(){switch(this._currentMode){case WebInspector.TimelineOverviewPane.Mode.Events:return new WebInspector.TimelineEventOverview(this._model);case WebInspector.TimelineOverviewPane.Mode.Frames:return new WebInspector.TimelineFrameOverview(this._model);case WebInspector.TimelineOverviewPane.Mode.Memory:return new WebInspector.TimelineMemoryOverview(this._model)}throw Error("Invalid overview mode: "+this._currentMode);
},_onCategoryVisibilityChanged:function(a){this._overviewControl.categoryVisibilityChanged()},_update:function(){delete this._refreshTimeout;this._updateWindow();this._overviewCalculator.setWindow(this._model.minimumRecordTime(),this._model.maximumRecordTime());this._overviewCalculator.setDisplayWindow(0,this._overviewGrid.clientWidth());this._overviewControl.update();this._overviewGrid.updateDividers(this._overviewCalculator);this._updateEventDividers()},_updateEventDividers:function(){var a=this._eventDividers;
this._overviewGrid.removeEventDividers();for(var b=[],c=0;c<a.length;++c){var e=a[c],d=this._overviewCalculator.computeBarGraphPercentages(e),f=Math.round(10*d.start);b[f]||(e=WebInspector.TimelinePresentationModel.createEventDivider(e.type),e.style.left=d.start+"%",b[f]=e)}this._overviewGrid.addEventDividers(b)},sidebarResized:function(a){this._overviewGrid.element.style.left=a+"px";this._topPaneSidebarElement.style.width=a+"px";this._update()},addFrame:function(a){this._overviewControl.addFrame(a);
this._scheduleRefresh()},zoomToFrame:function(a){(a=this._overviewControl.framePosition(a))&&this._overviewGrid.setWindowPosition(a.start,a.end)},_onRecordAdded:function(a){var b=this._eventDividers;WebInspector.TimelinePresentationModel.forAllRecords([a.data],function(a){WebInspector.TimelinePresentationModel.isEventDivider(a)&&b.push(a)});this._scheduleRefresh()},_reset:function(){this._windowStartTime=0;this._windowEndTime=Infinity;this._overviewCalculator.reset();this._overviewGrid.reset();this._eventDividers=
[];this._overviewGrid.updateDividers(this._overviewCalculator);this._overviewControl.reset();this._update()},windowStartTime:function(){return this._windowStartTime||this._model.minimumRecordTime()},windowEndTime:function(){return Infinity>this._windowEndTime?this._windowEndTime:this._model.maximumRecordTime()},windowLeft:function(){return this._overviewGrid.windowLeft()},windowRight:function(){return this._overviewGrid.windowRight()},_onWindowChanged:function(){if(!this._ignoreWindowChangedEvent){var a=
this._overviewControl.windowTimes(this.windowLeft(),this.windowRight());this._windowStartTime=a.startTime;this._windowEndTime=a.endTime;this.dispatchEventToListeners(WebInspector.TimelineOverviewPane.Events.WindowChanged)}},setWindowTimes:function(a,b){this._windowStartTime=a;this._windowEndTime=b;this._updateWindow()},_updateWindow:function(){var a=this._model.minimumRecordTime(),b=this._model.maximumRecordTime()-a,c=this._windowStartTime?(this._windowStartTime-a)/b:0,a=Infinity>this._windowEndTime?
(this._windowEndTime-a)/b:1;this._ignoreWindowChangedEvent=!0;this._overviewGrid.setWindow(c,a);this._ignoreWindowChangedEvent=!1},_scheduleRefresh:function(){!this._refreshTimeout&&this.isShowing()&&(this._refreshTimeout=setTimeout(this._update.bind(this),300))},__proto__:WebInspector.View.prototype};WebInspector.TimelineOverviewCalculator=function(){};
WebInspector.TimelineOverviewCalculator.prototype={computePosition:function(a){return(a-this._minimumBoundary)/this.boundarySpan()*this._workingArea+this.paddingLeft},computeBarGraphPercentages:function(a){var b=(WebInspector.TimelineModel.startTimeInSeconds(a)-this._minimumBoundary)/this.boundarySpan()*100;a=(WebInspector.TimelineModel.endTimeInSeconds(a)-this._minimumBoundary)/this.boundarySpan()*100;return{start:b,end:a}},setWindow:function(a,b){this._minimumBoundary=0<=a?a:void 0;this._maximumBoundary=
0<=b?b:void 0},setDisplayWindow:function(a,b){this._workingArea=b-a;this.paddingLeft=a},reset:function(){this.setWindow()},formatTime:function(a){return Number.secondsToString(a)},maximumBoundary:function(){return this._maximumBoundary},minimumBoundary:function(){return this._minimumBoundary},zeroTime:function(){return this._minimumBoundary},boundarySpan:function(){return this._maximumBoundary-this._minimumBoundary}};
WebInspector.TimelineOverviewBase=function(a){WebInspector.View.call(this);this._model=a;this._canvas=this.element.createChild("canvas","fill")};WebInspector.TimelineOverviewBase.prototype={update:function(){},reset:function(){},categoryVisibilityChanged:function(){},addFrame:function(a){},windowTimes:function(a,b){var c=this._model.minimumRecordTime(),e=this._model.maximumRecordTime();return{startTime:c+(e-c)*a,endTime:c+(e-c)*b}},__proto__:WebInspector.View.prototype};
WebInspector.TimelineMemoryOverview=function(a){WebInspector.TimelineOverviewBase.call(this,a);this.element.id="timeline-overview-memory";this.element.classList.add("fill");this._maxHeapSizeLabel=this.element.createChild("div","max memory-graph-label");this._minHeapSizeLabel=this.element.createChild("div","min memory-graph-label")};
WebInspector.TimelineMemoryOverview.prototype={reset:function(){this._maxHeapSizeLabel.textContent="";this._minHeapSizeLabel.textContent=""},update:function(){this._canvas.width=this.element.clientWidth;this._canvas.height=this.element.clientHeight-5;var a=this._model.records;if(a.length){var b=0,c=1E11,e=this._model.minimumRecordTime(),d=this._model.maximumRecordTime();WebInspector.TimelinePresentationModel.forAllRecords(a,function(a){b=Math.max(b,a.usedHeapSize||b);c=Math.min(c,a.usedHeapSize||
c)});var c=Math.min(c,b),f=this._canvas.width,g=this._canvas.height-3,h=f/(d-e),k=g/(b-c),l=Array(f);WebInspector.TimelinePresentationModel.forAllRecords(a,function(a){if(a.usedHeapSize){var b=Math.round((WebInspector.TimelineModel.endTimeInSeconds(a)-e)*h);a=Math.round((a.usedHeapSize-c)*k);l[b]=Math.max(l[b]||0,a)}});a=this._canvas.getContext("2d");this._clear(a);g+=1;a.beginPath();for(var m=d=0;m<l.length;m++)if(l[m]){d=l[m];break}a.moveTo(0,g-d);for(m=0;m<l.length;m++)l[m]&&a.lineTo(m,g-l[m]);
a.lineWidth=0.5;a.strokeStyle="rgba(20,0,0,0.8)";a.stroke();a.fillStyle="rgba(214,225,254, 0.8);";a.lineTo(f,60);a.lineTo(0,60);a.lineTo(0,g-d);a.fill();a.closePath();this._maxHeapSizeLabel.textContent=Number.bytesToString(b);this._minHeapSizeLabel.textContent=Number.bytesToString(c)}},_clear:function(a){a.fillStyle="rgba(255,255,255,0.8)";a.fillRect(0,0,this._canvas.width,this._canvas.height)},__proto__:WebInspector.TimelineOverviewBase.prototype};
WebInspector.TimelineEventOverview=function(a){WebInspector.TimelineOverviewBase.call(this,a);this.element.id="timeline-overview-events";this._context=this._canvas.getContext("2d");this._fillStyles={};a=WebInspector.TimelinePresentationModel.categories();for(var b in a)this._fillStyles[b]=WebInspector.TimelinePresentationModel.createFillStyleForCategory(this._context,0,WebInspector.TimelineEventOverview._innerStripHeight,a[b]);this._disabledCategoryFillStyle=WebInspector.TimelinePresentationModel.createFillStyle(this._context,
0,WebInspector.TimelineEventOverview._innerStripHeight,"rgb(218, 218, 218)","rgb(170, 170, 170)","rgb(143, 143, 143)");this._disabledCategoryBorderStyle="rgb(143, 143, 143)"};WebInspector.TimelineEventOverview._canvasHeight=60;WebInspector.TimelineEventOverview._numberOfStrips=3;WebInspector.TimelineEventOverview._stripHeight=Math.round(WebInspector.TimelineEventOverview._canvasHeight/WebInspector.TimelineEventOverview._numberOfStrips);WebInspector.TimelineEventOverview._stripPadding=4;
WebInspector.TimelineEventOverview._innerStripHeight=WebInspector.TimelineEventOverview._stripHeight-2*WebInspector.TimelineEventOverview._stripPadding;
WebInspector.TimelineEventOverview.prototype={update:function(){this._canvas.width=this.element.parentElement.clientWidth;this._canvas.height=WebInspector.TimelineEventOverview._canvasHeight;var a=this._model.minimumRecordTime(),b=this._model.maximumRecordTime()-a,c=this._canvas.width/b,e=[];this._context.fillStyle="rgba(0, 0, 0, 0.05)";for(b=1;b<WebInspector.TimelineEventOverview._numberOfStrips;b+=2)this._context.fillRect(0.5,b*WebInspector.TimelineEventOverview._stripHeight+0.5,this._canvas.width,
WebInspector.TimelineEventOverview._stripHeight);WebInspector.TimelinePresentationModel.forAllRecords(this._model.records,function(b){if(b.type!==WebInspector.TimelineModel.RecordType.BeginFrame){var f=Math.floor((WebInspector.TimelineModel.startTimeInSeconds(b)-a)*c),g=Math.ceil((WebInspector.TimelineModel.endTimeInSeconds(b)-a)*c);b=WebInspector.TimelinePresentationModel.categoryForRecord(b);if(!(0>b.overviewStripGroupIndex)){var h=e[b.overviewStripGroupIndex];h&&h.category===b&&h.end+2>=f?g>h.end&&
(h.end=g):(h&&this._renderBar(h.start,h.end,h.category),e[b.overviewStripGroupIndex]={start:f,end:g,category:b})}}}.bind(this));for(b=0;b<e.length;++b)e[b]&&this._renderBar(e[b].start,e[b].end,e[b].category)},categoryVisibilityChanged:function(){this.update()},_renderBar:function(a,b,c){var e=a+0.5,d=c.overviewStripGroupIndex*WebInspector.TimelineEventOverview._stripHeight+WebInspector.TimelineEventOverview._stripPadding+0.5;a=Math.max(b-a,1);this._context.save();this._context.translate(e,d);this._context.fillStyle=
c.hidden?this._disabledCategoryFillStyle:this._fillStyles[c.name];this._context.fillRect(0,0,a,WebInspector.TimelineEventOverview._innerStripHeight);this._context.strokeStyle=c.hidden?this._disabledCategoryBorderStyle:c.borderColor;this._context.strokeRect(0,0,a,WebInspector.TimelineEventOverview._innerStripHeight);this._context.restore()},__proto__:WebInspector.TimelineOverviewBase.prototype};
WebInspector.TimelineFrameOverview=function(a){WebInspector.TimelineOverviewBase.call(this,a);this._canvas.classList.add("timeline-frame-overview-bars");this.reset();this._outerPadding=4;this._maxInnerBarWidth=10;this._actualPadding=5;this._actualOuterBarWidth=this._maxInnerBarWidth+this._actualPadding;this._context=this._canvas.getContext("2d");this._fillStyles={};a=WebInspector.TimelinePresentationModel.categories();for(var b in a)this._fillStyles[b]=WebInspector.TimelinePresentationModel.createFillStyleForCategory(this._context,
this._maxInnerBarWidth,0,a[b])};
WebInspector.TimelineFrameOverview.prototype={reset:function(){this._recordsPerBar=1;this._barTimes=[];this._frames=[]},update:function(){this._framesPerBar=Math.max(1,4*this._frames.length/this.element.clientWidth);this._barTimes=[];var a=this._aggregateFrames(this._framesPerBar),b=1/30;b<this._medianFrameLength&&(b=Math.min(2*this._medianFrameLength,this._maxFrameLength));this._renderBars(a,(this._canvas.clientHeight-4)/b)},addFrame:function(a){this._frames.push(a)},framePosition:function(a){a=
this._frames.indexOf(a);if(!(0>a)){var b=Math.floor(a/this._framesPerBar);a=1<this._framesPerBar?b:Math.max(b-1,0);b=1<this._framesPerBar?b:Math.min(b+1,this._barTimes.length-1);return{start:Math.ceil(this._barNumberToScreenPosition(a)-this._actualPadding/2),end:Math.floor(this._barNumberToScreenPosition(b+1)-this._actualPadding/2)}}},_aggregateFrames:function(a){for(var b=[],c=[],e=this._maxFrameLength=0,d=0;d<this._frames.length;++e){for(var f=this._frames[d].startTime,g=null,h=Math.min(Math.floor((e+
1)*a),this._frames.length);d<h;++d)if(!g||g.duration<this._frames[d].duration)g=this._frames[d];h=this._frames[d-1].endTime;g&&(this._maxFrameLength=Math.max(this._maxFrameLength,g.duration),b.push(g),this._barTimes.push({startTime:f,endTime:h}),c.push(g.duration))}this._medianFrameLength=c.qselect(Math.floor(c.length/2));return b},_renderBars:function(a,b){this._canvas.width=this._canvas.clientWidth;this._canvas.height=this._canvas.clientHeight;this._actualOuterBarWidth=Math.min((this._canvas.width-
2*this._outerPadding)/a.length,this._maxInnerBarWidth+5);this._actualPadding=Math.min(Math.floor(this._actualOuterBarWidth/3),5);for(var c=this._actualOuterBarWidth-this._actualPadding,e=0;e<a.length;++e)this._renderBar(this._barNumberToScreenPosition(e),c,a[e],b);this._drawFPSMarks(b)},_barNumberToScreenPosition:function(a){return this._outerPadding+this._actualOuterBarWidth*a},_drawFPSMarks:function(a){var b=[30,60];this._context.save();this._context.beginPath();this._context.font="9px monospace";
this._context.textAlign="right";this._context.textBaseline="top";for(var c=0,e=0;e<b.length;++e){var d=b[e],f=this._canvas.height-Math.floor(1/d*a)-0.5,d=d+" FPS ",g=this._context.measureText(d).width,h=this._canvas.width;if(c<f-12)c=f-12;else if(f+12<this._canvas.height)c=f;else break;this._context.moveTo(0,f);this._context.lineTo(this._canvas.width,f);this._context.fillStyle="rgba(255, 255, 255, 0.75)";this._context.fillRect(h-g-2,c,g+4,12);this._context.fillStyle="rgb(0, 0, 0)";this._context.fillText(d,
h,c);c+=12}this._context.strokeStyle="rgb(51, 51, 51)";this._context.stroke();this._context.restore()},_renderBar:function(a,b,c,e){var d=Object.keys(WebInspector.TimelinePresentationModel.categories());if(d.length){a=Math.floor(a)+0.5;b=Math.floor(b);for(var f=0,g=this._canvas.height;f<d.length;++f){var h=d[f],k=c.timeByCategory[h];if(k){var k=k*e,l=Math.floor(g-k)+0.5;this._context.save();this._context.translate(a,0);this._context.scale(b/this._maxInnerBarWidth,1);this._context.fillStyle=this._fillStyles[h];
this._context.fillRect(0,l,this._maxInnerBarWidth,Math.floor(k));this._context.restore();this._context.strokeStyle=WebInspector.TimelinePresentationModel.categories()[h].borderColor;this._context.strokeRect(a,l,b,Math.floor(k));g-=k-1}}c=Math.floor(g-(c.duration-c.cpuTime)*e)+0.5;e=Math.floor(g)+0.5;this._context.strokeStyle="rgb(90, 90, 90)";this._context.beginPath();this._context.moveTo(a,e);this._context.lineTo(a,c);this._context.lineTo(a+b,c);this._context.lineTo(a+b,e);this._context.stroke()}},
windowTimes:function(a,b){var c=this.element.clientWidth,e=b*c-this._outerPadding,d=Math.floor(Math.max(a*c-this._outerPadding+this._actualPadding,0)/this._actualOuterBarWidth),f=Math.min(Math.floor(e/this._actualOuterBarWidth),this._barTimes.length-1);return{startTime:d>=this._barTimes.length?Infinity:this._barTimes[d].startTime,endTime:e+3>c?Infinity:this._barTimes[f].endTime}},__proto__:WebInspector.TimelineOverviewBase.prototype};WebInspector.TimelineWindowFilter=function(a){this._pane=a};
WebInspector.TimelineWindowFilter.prototype={accept:function(a){return a.lastChildEndTime>=this._pane._windowStartTime&&a.startTime<=this._pane._windowEndTime}};WebInspector.TimelinePresentationModel=function(){this._linkifier=new WebInspector.Linkifier;this._glueRecords=!1;this._filters=[];this.reset()};
WebInspector.TimelinePresentationModel.categories=function(){if(WebInspector.TimelinePresentationModel._categories)return WebInspector.TimelinePresentationModel._categories;WebInspector.TimelinePresentationModel._categories={program:new WebInspector.TimelineCategory("program",WebInspector.UIString("Program"),-1,"#BBBBBB","#DDDDDD","#FFFFFF"),loading:new WebInspector.TimelineCategory("loading",WebInspector.UIString("Loading"),0,"#5A8BCC","#8EB6E9","#70A2E3"),scripting:new WebInspector.TimelineCategory("scripting",
WebInspector.UIString("Scripting"),1,"#D8AA34","#F3D07A","#F1C453"),rendering:new WebInspector.TimelineCategory("rendering",WebInspector.UIString("Rendering"),2,"#8266CC","#AF9AEB","#9A7EE6"),painting:new WebInspector.TimelineCategory("painting",WebInspector.UIString("Painting"),2,"#5FA050","#8DC286","#71B363")};return WebInspector.TimelinePresentationModel._categories};
WebInspector.TimelinePresentationModel._initRecordStyles=function(){if(WebInspector.TimelinePresentationModel._recordStylesMap)return WebInspector.TimelinePresentationModel._recordStylesMap;var a=WebInspector.TimelineModel.RecordType,b=WebInspector.TimelinePresentationModel.categories(),c={};c[a.Root]={title:"#root",category:b.loading};c[a.Program]={title:WebInspector.UIString("Program"),category:b.program};c[a.EventDispatch]={title:WebInspector.UIString("Event"),category:b.scripting};c[a.BeginFrame]=
{title:WebInspector.UIString("Frame Start"),category:b.rendering};c[a.ScheduleStyleRecalculation]={title:WebInspector.UIString("Schedule Style Recalculation"),category:b.rendering};c[a.RecalculateStyles]={title:WebInspector.UIString("Recalculate Style"),category:b.rendering};c[a.InvalidateLayout]={title:WebInspector.UIString("Invalidate Layout"),category:b.rendering};c[a.Layout]={title:WebInspector.UIString("Layout"),category:b.rendering};c[a.Paint]={title:WebInspector.UIString("Paint"),category:b.painting};
c[a.Rasterize]={title:WebInspector.UIString("Rasterize"),category:b.painting};c[a.ScrollLayer]={title:WebInspector.UIString("Scroll"),category:b.rendering};c[a.DecodeImage]={title:WebInspector.UIString("Image Decode"),category:b.painting};c[a.ResizeImage]={title:WebInspector.UIString("Image Resize"),category:b.painting};c[a.CompositeLayers]={title:WebInspector.UIString("Composite Layers"),category:b.painting};c[a.ParseHTML]={title:WebInspector.UIString("Parse HTML"),category:b.loading};c[a.TimerInstall]=
{title:WebInspector.UIString("Install Timer"),category:b.scripting};c[a.TimerRemove]={title:WebInspector.UIString("Remove Timer"),category:b.scripting};c[a.TimerFire]={title:WebInspector.UIString("Timer Fired"),category:b.scripting};c[a.XHRReadyStateChange]={title:WebInspector.UIString("XHR Ready State Change"),category:b.scripting};c[a.XHRLoad]={title:WebInspector.UIString("XHR Load"),category:b.scripting};c[a.EvaluateScript]={title:WebInspector.UIString("Evaluate Script"),category:b.scripting};
c[a.ResourceSendRequest]={title:WebInspector.UIString("Send Request"),category:b.loading};c[a.ResourceReceiveResponse]={title:WebInspector.UIString("Receive Response"),category:b.loading};c[a.ResourceFinish]={title:WebInspector.UIString("Finish Loading"),category:b.loading};c[a.FunctionCall]={title:WebInspector.UIString("Function Call"),category:b.scripting};c[a.ResourceReceivedData]={title:WebInspector.UIString("Receive Data"),category:b.loading};c[a.GCEvent]={title:WebInspector.UIString("GC Event"),
category:b.scripting};c[a.MarkDOMContent]={title:WebInspector.UIString("DOMContentLoaded event"),category:b.scripting};c[a.MarkLoad]={title:WebInspector.UIString("Load event"),category:b.scripting};c[a.TimeStamp]={title:WebInspector.UIString("Stamp"),category:b.scripting};c[a.Time]={title:WebInspector.UIString("Time"),category:b.scripting};c[a.TimeEnd]={title:WebInspector.UIString("Time End"),category:b.scripting};c[a.ScheduleResourceRequest]={title:WebInspector.UIString("Schedule Request"),category:b.loading};
c[a.RequestAnimationFrame]={title:WebInspector.UIString("Request Animation Frame"),category:b.scripting};c[a.CancelAnimationFrame]={title:WebInspector.UIString("Cancel Animation Frame"),category:b.scripting};c[a.FireAnimationFrame]={title:WebInspector.UIString("Animation Frame Fired"),category:b.scripting};c[a.WebSocketCreate]={title:WebInspector.UIString("Create WebSocket"),category:b.scripting};c[a.WebSocketSendHandshakeRequest]={title:WebInspector.UIString("Send WebSocket Handshake"),category:b.scripting};
c[a.WebSocketReceiveHandshakeResponse]={title:WebInspector.UIString("Receive WebSocket Handshake"),category:b.scripting};c[a.WebSocketDestroy]={title:WebInspector.UIString("Destroy WebSocket"),category:b.scripting};return WebInspector.TimelinePresentationModel._recordStylesMap=c};
WebInspector.TimelinePresentationModel.recordStyle=function(a){var b=WebInspector.TimelinePresentationModel._initRecordStyles(),c=b[a.type];c||(c={title:WebInspector.UIString("Unknown: %s",a.type),category:WebInspector.TimelinePresentationModel.categories().program},b[a.type]=c);return c};WebInspector.TimelinePresentationModel.categoryForRecord=function(a){return WebInspector.TimelinePresentationModel.recordStyle(a).category};
WebInspector.TimelinePresentationModel.isEventDivider=function(a){var b=WebInspector.TimelineModel.RecordType;return a.type===b.TimeStamp?!0:a.type!==b.MarkDOMContent&&a.type!==b.MarkLoad||!a.data||"boolean"!==typeof a.data.isMainFrame?!1:a.data.isMainFrame};
WebInspector.TimelinePresentationModel.forAllRecords=function(a,b,c){if(a)for(a=[{array:a,index:0}];a.length;){var e=a[a.length-1],d=e.array;if(e.index<d.length){d=d[e.index];if(b&&b(d))break;if(d.children)a.push({array:d.children,index:0,record:d});else if(c&&c(d))break;++e.index}else{if(e.record&&c&&c(e.record))break;a.pop()}}};
WebInspector.TimelinePresentationModel.needsPreviewElement=function(a){if(!a)return!1;var b=WebInspector.TimelineModel.RecordType;switch(a){case b.ScheduleResourceRequest:case b.ResourceSendRequest:case b.ResourceReceiveResponse:case b.ResourceReceivedData:case b.ResourceFinish:return!0;default:return!1}};
WebInspector.TimelinePresentationModel.createEventDivider=function(a,b){var c=document.createElement("div");c.className="resources-event-divider";var e=WebInspector.TimelineModel.RecordType;a===e.MarkDOMContent?c.className+=" resources-blue-divider":a===e.MarkLoad?c.className+=" resources-red-divider":a===e.TimeStamp?c.className+=" resources-orange-divider":a===e.BeginFrame&&(c.className+=" timeline-frame-divider");b&&(c.title=b);return c};WebInspector.TimelinePresentationModel._hiddenRecords={};
WebInspector.TimelinePresentationModel._hiddenRecords[WebInspector.TimelineModel.RecordType.MarkDOMContent]=1;WebInspector.TimelinePresentationModel._hiddenRecords[WebInspector.TimelineModel.RecordType.MarkLoad]=1;WebInspector.TimelinePresentationModel._hiddenRecords[WebInspector.TimelineModel.RecordType.ScheduleStyleRecalculation]=1;WebInspector.TimelinePresentationModel._hiddenRecords[WebInspector.TimelineModel.RecordType.InvalidateLayout]=1;
WebInspector.TimelinePresentationModel.prototype={addFilter:function(a){this._filters.push(a)},removeFilter:function(a){a=this._filters.indexOf(a);-1!==a&&this._filters.splice(a,1)},rootRecord:function(){return this._rootRecord},frames:function(){return this._frames},reset:function(){this._linkifier.reset();this._rootRecord=new WebInspector.TimelinePresentationModel.Record(this,{type:WebInspector.TimelineModel.RecordType.Root},null,null,null,!1);this._sendRequestRecords={};this._scheduledResourceRequests=
{};this._timerRecords={};this._requestAnimationFrameRecords={};this._eventDividerRecords=[];this._timeRecords={};this._timeRecordStack=[];this._frames=[];this._minimumRecordTime=-1;this._layoutInvalidateStack={};this._lastScheduleStyleRecalculation={};this._webSocketCreateRecords={};this._coalescingBuckets={}},addFrame:function(a){this._frames.push(a)},addRecord:function(a){if(-1===this._minimumRecordTime||a.startTime<this._minimumRecordTime)this._minimumRecordTime=WebInspector.TimelineModel.startTimeInSeconds(a);
a=a.type===WebInspector.TimelineModel.RecordType.Program?a.children:[a];for(var b=[],c=a.length,e=0;e<c;++e)b.push(this._innerAddRecord(a[e],this._rootRecord));return b},_innerAddRecord:function(a,b){var c=WebInspector.TimelineModel.RecordType,e=a.type in WebInspector.TimelinePresentationModel._hiddenRecords,d,f;if(!e){var g=this._findParentRecord(a);g&&(d=b,b=g);b===this._rootRecord&&(f=a.thread?a.type:"mainThread",g=this._findCoalescedParent(a,f))&&(d||(d=b),b=g)}var g=a.children,h;a.data&&a.data.scriptName&&
(h={scriptName:a.data.scriptName,scriptLine:a.data.scriptLine});if((a.type===c.TimerFire||a.type===c.FireAnimationFrame)&&g&&g.length){var k=g[0];k.type===c.FunctionCall&&(h={scriptName:k.data.scriptName,scriptLine:k.data.scriptLine},g=k.children.concat(g.slice(1)))}c=new WebInspector.TimelinePresentationModel.Record(this,a,b,d,h,e);WebInspector.TimelinePresentationModel.isEventDivider(c)&&this._eventDividerRecords.push(c);if(e)return c;c.collapsed=b===this._rootRecord;f&&(this._coalescingBuckets[f]=
c);e=g?g.length:0;for(f=0;f<e;++f)this._innerAddRecord(g[f],c);c.calculateAggregatedStats();d&&this._updateAncestorStats(c);b.coalesced&&b.startTime>c.startTime&&(b._record.startTime=a.startTime);d=c.origin();d.isRoot()||d.coalesced||(d.selfTime-=c.endTime-c.startTime);return c},_updateAncestorStats:function(a){for(var b=a.lastChildEndTime,c=a.aggregatedStats,e=a.parent;e&&!e.isRoot();e=e.parent){e._cpuTime+=a._cpuTime;e.lastChildEndTime<b&&(e.lastChildEndTime=b);for(var d in c)e.aggregatedStats[d]+=
c[d]}},_findCoalescedParent:function(a,b){var c=this._coalescingBuckets[b],e=WebInspector.TimelineModel.startTimeInSeconds(a),d=WebInspector.TimelineModel.endTimeInSeconds(a);return!c||c.type!==a.type||c.endTime+0.001<e||d+0.001<c.startTime?null:c.parent.coalesced?c.parent:c.parent!==this._rootRecord?null:this._replaceWithCoalescedRecord(c)},_replaceWithCoalescedRecord:function(a){var b={type:a._record.type,startTime:a._record.startTime,endTime:a._record.endTime,data:{}};a._record.thread&&(b.thread=
"aggregated");var b=new WebInspector.TimelinePresentationModel.Record(this,b,null,null,null,!1),c=a.parent;b.coalesced=!0;b.collapsed=!0;b._children.push(a);a.parent=b;b.calculateAggregatedStats();if(a.hasWarning||a.childHasWarning)b.childHasWarning=!0;b.parent=c;return c._children[c._children.indexOf(a)]=b},_findParentRecord:function(a){if(!this._glueRecords)return null;var b=WebInspector.TimelineModel.RecordType;switch(a.type){case b.ResourceReceiveResponse:case b.ResourceFinish:case b.ResourceReceivedData:return this._sendRequestRecords[a.data.requestId];
case b.ResourceSendRequest:return this._rootRecord;case b.TimerFire:return this._timerRecords[a.data.timerId];case b.ResourceSendRequest:return this._scheduledResourceRequests[a.data.url];case b.FireAnimationFrame:return this._requestAnimationFrameRecords[a.data.id];case b.Time:return this._rootRecord;case b.TimeEnd:return this._timeRecords[a.data.message]}},setGlueRecords:function(a){this._glueRecords=a},invalidateFilteredRecords:function(){delete this._filteredRecords},filteredRecords:function(){if(this._filteredRecords)return this._filteredRecords;
for(var a=[],b=[{children:this._rootRecord.children,index:0,parentIsCollapsed:!1}];b.length;){var c=b[b.length-1],e=c.children;e&&c.index<e.length?(e=e[c.index],++c.index,this.isVisible(e)&&(++e.parent._invisibleChildrenCount,c.parentIsCollapsed||a.push(e)),e._invisibleChildrenCount=0,b.push({children:e.children,index:0,parentIsCollapsed:c.parentIsCollapsed||e.collapsed,parentRecord:e,windowLengthBeforeChildrenTraversal:a.length})):(b.pop(),c.parentRecord&&(c.parentRecord._visibleChildrenCount=a.length-
c.windowLengthBeforeChildrenTraversal))}return this._filteredRecords=a},filteredFrames:function(a,b){for(var c=insertionIndexForObjectInListSortedByFunction(a,this._frames,function(a,b){return a-b.startTime}),e=insertionIndexForObjectInListSortedByFunction(b,this._frames,function(a,b){return a-b.endTime});e<this._frames.length&&this._frames[e].endTime<=b;)++e;return this._frames.slice(c,e)},eventDividerRecords:function(){return this._eventDividerRecords},isVisible:function(a){for(var b=0;b<this._filters.length;++b)if(!this._filters[b].accept(a))return!1;
return!0},generateMainThreadBarPopupContent:function(a){var b=a.firstTaskIndex,c=a.lastTaskIndex,e=a.tasks;a=c-b+1;for(var d=0,f=b;f<=c;++f)var g=e[f],d=d+(g.endTime-g.startTime);b=e[b].startTime;e=e[c].endTime-b;f=this._minimumRecordTime;c=new WebInspector.PopoverContentHelper(WebInspector.UIString("CPU"));b=WebInspector.UIString("%s (at %s)",Number.secondsToString(e,!0),Number.secondsToString(b-f,!0));c.appendTextRow(WebInspector.UIString("Duration"),b);c.appendTextRow(WebInspector.UIString("CPU time"),
Number.secondsToString(d,!0));c.appendTextRow(WebInspector.UIString("Message Count"),a);return c.contentTable()},__proto__:WebInspector.Object.prototype};
WebInspector.TimelinePresentationModel.Record=function(a,b,c,e,d,f){this._linkifier=a._linkifier;this._aggregatedStats={};this._record=b;this._children=[];!f&&c&&(this.parent=c,this.isBackground?WebInspector.TimelinePresentationModel.insertRetrospectiveRecord(c,this):c.children.push(this));e&&(this._origin=e);this._selfTime=this.endTime-this.startTime;this._lastChildEndTime=this.endTime;this._startTimeOffset=this.startTime-a._minimumRecordTime;b.data&&b.data.url&&(this.url=b.data.url);d&&(this.scriptName=
d.scriptName,this.scriptLine=d.scriptLine);c&&c.callSiteStackTrace&&(this.callSiteStackTrace=c.callSiteStackTrace);d=WebInspector.TimelineModel.RecordType;switch(b.type){case d.ResourceSendRequest:a._sendRequestRecords[b.data.requestId]=this;break;case d.ScheduleResourceRequest:a._scheduledResourceRequests[b.data.url]=this;break;case d.ResourceReceiveResponse:if(e=a._sendRequestRecords[b.data.requestId])this.url=e.url,e._refreshDetails(),e.parent!==a._rootRecord&&e.parent.type===d.ScheduleResourceRequest&&
e.parent._refreshDetails();break;case d.ResourceReceivedData:case d.ResourceFinish:if(e=a._sendRequestRecords[b.data.requestId])this.url=e.url;break;case d.TimerInstall:this.timeout=b.data.timeout;this.singleShot=b.data.singleShot;a._timerRecords[b.data.timerId]=this;break;case d.TimerFire:if(a=a._timerRecords[b.data.timerId])this.callSiteStackTrace=a.stackTrace,this.timeout=a.timeout,this.singleShot=a.singleShot;break;case d.RequestAnimationFrame:a._requestAnimationFrameRecords[b.data.id]=this;break;
case d.FireAnimationFrame:if(a=a._requestAnimationFrameRecords[b.data.id])this.callSiteStackTrace=a.stackTrace;break;case d.Time:var g=b.data.message;if(a._timeRecords[g])break;a._timeRecords[g]=this;e&&a._timeRecordStack.push(this);break;case d.TimeEnd:g=b.data.message;b=a._timeRecords[g];delete a._timeRecords[g];if(b){this.timeRecord=b;b.timeEndRecord=this;this.intervalDuration=g=this.startTime-b.startTime;b.intervalDuration=g;if(!e)break;a=a._timeRecordStack;a.splice(a.indexOf(b),1);for(e=a.length;e;--e)if(g=
a[e-1],!(g.startTime>b.startTime)){WebInspector.TimelinePresentationModel.adoptRecord(g,b);break}}break;case d.ScheduleStyleRecalculation:a._lastScheduleStyleRecalculation[this.frameId]=this;break;case d.RecalculateStyles:a=a._lastScheduleStyleRecalculation[this.frameId];if(!a)break;this.callSiteStackTrace=a.stackTrace;break;case d.InvalidateLayout:if(!a._layoutInvalidateStack[this.frameId])for(e=c;e;e=b.parent)if(e.type===d.RecalculateStyles){g=e.callSiteStackTrace;break}a._layoutInvalidateStack[this.frameId]=
g||this.stackTrace;break;case d.Layout:if(e=a._layoutInvalidateStack[this.frameId])this.callSiteStackTrace=e;this.stackTrace&&this.setHasWarning();a._layoutInvalidateStack[this.frameId]=null;this.highlightQuad=b.data.root;break;case d.Paint:this.highlightQuad=b.data.clip;break;case d.WebSocketCreate:this.webSocketURL=b.data.url;"undefined"!==typeof b.data.webSocketProtocol&&(this.webSocketProtocol=b.data.webSocketProtocol);a._webSocketCreateRecords[b.data.identifier]=this;break;case d.WebSocketSendHandshakeRequest:case d.WebSocketReceiveHandshakeResponse:case d.WebSocketDestroy:if(a=
a._webSocketCreateRecords[b.data.identifier])this.webSocketURL=a.webSocketURL,"undefined"!==typeof a.webSocketProtocol&&(this.webSocketProtocol=a.webSocketProtocol)}};WebInspector.TimelinePresentationModel.adoptRecord=function(a,b){b.parent.children.splice(b.parent.children.indexOf(b));WebInspector.TimelinePresentationModel.insertRetrospectiveRecord(a,b);b.parent=a};
WebInspector.TimelinePresentationModel.insertRetrospectiveRecord=function(a,b){a.children.splice(insertionIndexForObjectInListSortedByFunction(b.startTime,a.children,function(a,b){return a<b.startTime?-1:1}),0,b)};
WebInspector.TimelinePresentationModel.Record.prototype={get lastChildEndTime(){return this._lastChildEndTime},set lastChildEndTime(a){this._lastChildEndTime=a},get selfTime(){return this.coalesced?this._lastChildEndTime-this.startTime:this._selfTime},set selfTime(a){this._selfTime=a},get cpuTime(){return this._cpuTime},isRoot:function(){return this.type===WebInspector.TimelineModel.RecordType.Root},origin:function(){return this._origin||this.parent},get children(){return this._children},get visibleChildrenCount(){return this._visibleChildrenCount||
0},get invisibleChildrenCount(){return this._invisibleChildrenCount||0},get category(){return WebInspector.TimelinePresentationModel.recordStyle(this._record).category},get title(){return this.type===WebInspector.TimelineModel.RecordType.TimeStamp?this._record.data.message:WebInspector.TimelinePresentationModel.recordStyle(this._record).title},get startTime(){return WebInspector.TimelineModel.startTimeInSeconds(this._record)},get endTime(){return WebInspector.TimelineModel.endTimeInSeconds(this._record)},
get isBackground(){return!!this._record.thread},get data(){return this._record.data},get type(){return this._record.type},get frameId(){return this._record.frameId},get usedHeapSizeDelta(){return this._record.usedHeapSizeDelta||0},get usedHeapSize(){return this._record.usedHeapSize},get stackTrace(){return this._record.stackTrace&&this._record.stackTrace.length?this._record.stackTrace:null},containsTime:function(a){return this.startTime<=a&&a<=this.endTime},generatePopupContent:function(a){WebInspector.TimelinePresentationModel.needsPreviewElement(this.type)?
WebInspector.DOMPresentationUtils.buildImagePreviewContents(this.url,!1,this._generatePopupContentWithImagePreview.bind(this,a)):this._generatePopupContentWithImagePreview(a)},_generatePopupContentWithImagePreview:function(a,b){var c=new WebInspector.PopoverContentHelper(this.title),e=WebInspector.UIString("%s (at %s)",Number.secondsToString(this._lastChildEndTime-this.startTime,!0),Number.secondsToString(this._startTimeOffset));c.appendTextRow(WebInspector.UIString("Duration"),e);this._children.length&&
(this.coalesced||c.appendTextRow(WebInspector.UIString("Self Time"),Number.secondsToString(this._selfTime,!0)),c.appendTextRow(WebInspector.UIString("CPU Time"),Number.secondsToString(this._cpuTime,!0)),c.appendElementRow(WebInspector.UIString("Aggregated Time"),WebInspector.TimelinePresentationModel._generateAggregatedInfo(this._aggregatedStats)));if(!this.coalesced){var e=WebInspector.TimelineModel.RecordType,d,f;switch(this.type){case e.GCEvent:c.appendTextRow(WebInspector.UIString("Collected"),
Number.bytesToString(this.data.usedHeapSizeDelta));break;case e.TimerInstall:case e.TimerFire:case e.TimerRemove:c.appendTextRow(WebInspector.UIString("Timer ID"),this.data.timerId);"number"===typeof this.timeout&&(c.appendTextRow(WebInspector.UIString("Timeout"),Number.secondsToString(this.timeout/1E3)),c.appendTextRow(WebInspector.UIString("Repeats"),!this.singleShot));break;case e.FireAnimationFrame:c.appendTextRow(WebInspector.UIString("Callback ID"),this.data.id);break;case e.FunctionCall:c.appendElementRow(WebInspector.UIString("Location"),
this._linkifyScriptLocation());break;case e.ScheduleResourceRequest:case e.ResourceSendRequest:case e.ResourceReceiveResponse:case e.ResourceReceivedData:case e.ResourceFinish:c.appendElementRow(WebInspector.UIString("Resource"),WebInspector.linkifyResourceAsNode(this.url));b&&c.appendElementRow(WebInspector.UIString("Preview"),b);this.data.requestMethod&&c.appendTextRow(WebInspector.UIString("Request Method"),this.data.requestMethod);"number"===typeof this.data.statusCode&&c.appendTextRow(WebInspector.UIString("Status Code"),
this.data.statusCode);this.data.mimeType&&c.appendTextRow(WebInspector.UIString("MIME Type"),this.data.mimeType);this.data.encodedDataLength&&c.appendTextRow(WebInspector.UIString("Encoded Data Length"),WebInspector.UIString("%d Bytes",this.data.encodedDataLength));break;case e.EvaluateScript:this.data&&this.url&&c.appendElementRow(WebInspector.UIString("Script"),this._linkifyLocation(this.url,this.data.lineNumber));break;case e.Paint:c.appendTextRow(WebInspector.UIString("Location"),WebInspector.UIString("(%d, %d)",
this.data.clip[0],this.data.clip[1]));var g=WebInspector.TimelinePresentationModel.quadWidth(this.data.clip),h=WebInspector.TimelinePresentationModel.quadHeight(this.data.clip);c.appendTextRow(WebInspector.UIString("Dimensions"),WebInspector.UIString("%d \u00d7 %d",g,h));break;case e.RecalculateStyles:d=WebInspector.UIString("Styles invalidated");f=WebInspector.UIString("Styles recalculation forced");break;case e.Layout:this.data.dirtyObjects&&c.appendTextRow(WebInspector.UIString("Nodes that need layout"),
this.data.dirtyObjects);this.data.totalObjects&&c.appendTextRow(WebInspector.UIString("Layout tree size"),this.data.totalObjects);"boolean"===typeof this.data.partialLayout&&c.appendTextRow(WebInspector.UIString("Layout scope"),this.data.partialLayout?WebInspector.UIString("Partial"):WebInspector.UIString("Whole document"));d=WebInspector.UIString("Layout invalidated");this.stackTrace&&(f=WebInspector.UIString("Layout forced"),c.appendTextRow(WebInspector.UIString("Note"),WebInspector.UIString("Forced synchronous layout is a possible performance bottleneck.")));
break;case e.Time:case e.TimeEnd:c.appendTextRow(WebInspector.UIString("Message"),this.data.message);"number"===typeof this.intervalDuration&&c.appendTextRow(WebInspector.UIString("Interval Duration"),Number.secondsToString(this.intervalDuration,!0));break;case e.WebSocketCreate:case e.WebSocketSendHandshakeRequest:case e.WebSocketReceiveHandshakeResponse:case e.WebSocketDestroy:"undefined"!==typeof this.webSocketURL&&c.appendTextRow(WebInspector.UIString("URL"),this.webSocketURL);"undefined"!==typeof this.webSocketProtocol&&
c.appendTextRow(WebInspector.UIString("WebSocket Protocol"),this.webSocketProtocol);"undefined"!==typeof this.data.message&&c.appendTextRow(WebInspector.UIString("Message"),this.data.message);break;default:this.detailsNode()&&c.appendElementRow(WebInspector.UIString("Details"),this.detailsNode().childNodes[1].cloneNode())}this.scriptName&&this.type!==e.FunctionCall&&c.appendElementRow(WebInspector.UIString("Function Call"),this._linkifyScriptLocation());this.usedHeapSize&&(this.usedHeapSizeDelta?
(e=0<this.usedHeapSizeDelta?"+":"-",c.appendTextRow(WebInspector.UIString("Used Heap Size"),WebInspector.UIString("%s (%s%s)",Number.bytesToString(this.usedHeapSize),e,Number.bytesToString(this.usedHeapSizeDelta)))):this.category===WebInspector.TimelinePresentationModel.categories().scripting&&c.appendTextRow(WebInspector.UIString("Used Heap Size"),Number.bytesToString(this.usedHeapSize)));this.callSiteStackTrace&&c.appendStackTrace(d||WebInspector.UIString("Call Site stack"),this.callSiteStackTrace,
this._linkifyCallFrame.bind(this));this.stackTrace&&c.appendStackTrace(f||WebInspector.UIString("Call Stack"),this.stackTrace,this._linkifyCallFrame.bind(this))}a(c.contentTable())},_refreshDetails:function(){delete this._detailsNode},detailsNode:function(){"undefined"===typeof this._detailsNode&&(this._detailsNode=this._getRecordDetails())&&(this._detailsNode.insertBefore(document.createTextNode("("),this._detailsNode.firstChild),this._detailsNode.appendChild(document.createTextNode(")")));return this._detailsNode},
_createSpanWithText:function(a){var b=document.createElement("span");b.textContent=a;return b},_getRecordDetails:function(){var a;if(this.coalesced)return this._createSpanWithText(WebInspector.UIString("\u00d7 %d",this.children.length));switch(this.type){case WebInspector.TimelineModel.RecordType.GCEvent:a=WebInspector.UIString("%s collected",Number.bytesToString(this.data.usedHeapSizeDelta));break;case WebInspector.TimelineModel.RecordType.TimerFire:a=this._linkifyScriptLocation(this.data.timerId);
break;case WebInspector.TimelineModel.RecordType.FunctionCall:a=this._linkifyScriptLocation();break;case WebInspector.TimelineModel.RecordType.FireAnimationFrame:a=this._linkifyScriptLocation(this.data.id);break;case WebInspector.TimelineModel.RecordType.EventDispatch:a=this.data?this.data.type:null;break;case WebInspector.TimelineModel.RecordType.Paint:a=WebInspector.TimelinePresentationModel.quadWidth(this.data.clip)+"\u2009\u00d7\u2009"+WebInspector.TimelinePresentationModel.quadHeight(this.data.clip);
break;case WebInspector.TimelineModel.RecordType.DecodeImage:a=this.data.imageType;break;case WebInspector.TimelineModel.RecordType.ResizeImage:a=this.data.cached?WebInspector.UIString("cached"):WebInspector.UIString("non-cached");break;case WebInspector.TimelineModel.RecordType.TimerInstall:case WebInspector.TimelineModel.RecordType.TimerRemove:a=this._linkifyTopCallFrame(this.data.timerId);break;case WebInspector.TimelineModel.RecordType.RequestAnimationFrame:case WebInspector.TimelineModel.RecordType.CancelAnimationFrame:a=
this._linkifyTopCallFrame(this.data.id);break;case WebInspector.TimelineModel.RecordType.ParseHTML:case WebInspector.TimelineModel.RecordType.RecalculateStyles:a=this._linkifyTopCallFrame();break;case WebInspector.TimelineModel.RecordType.EvaluateScript:a=this.url?this._linkifyLocation(this.url,this.data.lineNumber,0):null;break;case WebInspector.TimelineModel.RecordType.XHRReadyStateChange:case WebInspector.TimelineModel.RecordType.XHRLoad:case WebInspector.TimelineModel.RecordType.ScheduleResourceRequest:case WebInspector.TimelineModel.RecordType.ResourceSendRequest:case WebInspector.TimelineModel.RecordType.ResourceReceivedData:case WebInspector.TimelineModel.RecordType.ResourceReceiveResponse:case WebInspector.TimelineModel.RecordType.ResourceFinish:a=
WebInspector.displayNameForURL(this.url);break;case WebInspector.TimelineModel.RecordType.Time:case WebInspector.TimelineModel.RecordType.TimeEnd:case WebInspector.TimelineModel.RecordType.TimeStamp:a=this.data.message;break;default:a=this._linkifyScriptLocation()||this._linkifyTopCallFrame()||null}return!a||a instanceof Node?a||null:this._createSpanWithText(""+a)},_linkifyLocation:function(a,b,c){return this._linkifier.linkifyLocation(a,b-1,c?c-1:0,"timeline-details")},_linkifyCallFrame:function(a){return this._linkifyLocation(a.url,
a.lineNumber,a.columnNumber)},_linkifyTopCallFrame:function(a){return this.stackTrace?this._linkifyCallFrame(this.stackTrace[0]):this.callSiteStackTrace?this._linkifyCallFrame(this.callSiteStackTrace[0]):a},_linkifyScriptLocation:function(a){return this.scriptName?this._linkifyLocation(this.scriptName,this.scriptLine,0):a?""+a:null},calculateAggregatedStats:function(){this._aggregatedStats={};this._cpuTime=this._selfTime;for(var a=this._children.length;a;--a){var b=this._children[a-1],c;for(c in b._aggregatedStats)this._aggregatedStats[c]=
(this._aggregatedStats[c]||0)+b._aggregatedStats[c]}for(c in this._aggregatedStats)this._cpuTime+=this._aggregatedStats[c];this._aggregatedStats[this.category.name]=(this._aggregatedStats[this.category.name]||0)+this._selfTime},get aggregatedStats(){return this._aggregatedStats},setHasWarning:function(){this.hasWarning=!0;for(var a=this.parent;a&&!a.childHasWarning;a=a.parent)a.childHasWarning=!0}};
WebInspector.TimelinePresentationModel._generateAggregatedInfo=function(a){var b=document.createElement("span");b.className="timeline-aggregated-info";for(var c in a){var e=document.createElement("div");e.className="timeline-aggregated-category timeline-"+c;b.appendChild(e);e=document.createElement("span");e.textContent=Number.secondsToString(a[c],!0);b.appendChild(e)}return b};
WebInspector.TimelinePresentationModel.generatePopupContentForFrame=function(a){var b=new WebInspector.PopoverContentHelper(WebInspector.UIString("Frame")),c=a.endTime-a.startTime,e=WebInspector.UIString("%s (at %s)",Number.secondsToString(a.endTime-a.startTime,!0),Number.secondsToString(a.startTimeOffset,!0));b.appendTextRow(WebInspector.UIString("Duration"),e);b.appendTextRow(WebInspector.UIString("FPS"),Math.floor(1/c));b.appendTextRow(WebInspector.UIString("CPU time"),Number.secondsToString(a.cpuTime,
!0));b.appendElementRow(WebInspector.UIString("Aggregated Time"),WebInspector.TimelinePresentationModel._generateAggregatedInfo(a.timeByCategory));return b.contentTable()};
WebInspector.TimelinePresentationModel.generatePopupContentForFrameStatistics=function(a){function b(a){return WebInspector.UIString("%s (%.0f FPS)",Number.secondsToString(a,!0),1/a)}var c=new WebInspector.PopoverContentHelper(WebInspector.UIString("Selected Range"));c.appendTextRow(WebInspector.UIString("Selected range"),WebInspector.UIString("%s\u2013%s (%d frames)",Number.secondsToString(a.startOffset,!0),Number.secondsToString(a.endOffset,!0),a.frameCount));c.appendTextRow(WebInspector.UIString("Minimum Time"),
b(a.minDuration));c.appendTextRow(WebInspector.UIString("Average Time"),b(a.average));c.appendTextRow(WebInspector.UIString("Maximum Time"),b(a.maxDuration));c.appendTextRow(WebInspector.UIString("Standard Deviation"),Number.secondsToString(a.stddev,!0));c.appendElementRow(WebInspector.UIString("Time by category"),WebInspector.TimelinePresentationModel._generateAggregatedInfo(a.timeByCategory));return c.contentTable()};
WebInspector.TimelinePresentationModel.createFillStyle=function(a,b,c,e,d,f){a=a.createLinearGradient(0,0,b,c);a.addColorStop(0,e);a.addColorStop(0.25,d);a.addColorStop(0.75,d);a.addColorStop(1,f);return a};WebInspector.TimelinePresentationModel.createFillStyleForCategory=function(a,b,c,e){return WebInspector.TimelinePresentationModel.createFillStyle(a,b,c,e.fillColorStop0,e.fillColorStop1,e.borderColor)};
WebInspector.TimelinePresentationModel.createStyleRuleForCategory=function(a){return".timeline-category-"+a.name+" .timeline-graph-bar, .timeline-category-statusbar-item.timeline-category-"+a.name+" .timeline-category-checkbox, .popover .timeline-"+a.name+", .timeline-category-"+a.name+" .timeline-tree-icon { background-image: -webkit-linear-gradient("+a.fillColorStop0+", "+a.fillColorStop1+" 25%, "+a.fillColorStop1+" 75%, "+a.borderColor+"); border-color: "+a.borderColor+"}"};
WebInspector.TimelinePresentationModel.quadWidth=function(a){return Math.round(Math.sqrt(Math.pow(a[0]-a[2],2)+Math.pow(a[1]-a[3],2)))};WebInspector.TimelinePresentationModel.quadHeight=function(a){return Math.round(Math.sqrt(Math.pow(a[0]-a[6],2)+Math.pow(a[1]-a[7],2)))};WebInspector.TimelinePresentationModel.Filter=function(){};WebInspector.TimelinePresentationModel.Filter.prototype={accept:function(a){return!1}};
WebInspector.TimelineCategory=function(a,b,c,e,d,f){this.name=a;this.title=b;this.overviewStripGroupIndex=c;this.borderColor=e;this.fillColorStop0=d;this.fillColorStop1=f;this.hidden=!1};WebInspector.TimelineCategory.Events={VisibilityChanged:"VisibilityChanged"};WebInspector.TimelineCategory.prototype={get hidden(){return this._hidden},set hidden(a){this._hidden=a;this.dispatchEventToListeners(WebInspector.TimelineCategory.Events.VisibilityChanged,this)},__proto__:WebInspector.Object.prototype};
WebInspector.TimelineFrameController=function(a,b,c){this._lastFrame=null;this._model=a;this._overviewPane=b;this._presentationModel=c;this._model.addEventListener(WebInspector.TimelineModel.Events.RecordAdded,this._onRecordAdded,this);this._model.addEventListener(WebInspector.TimelineModel.Events.RecordsCleared,this._onRecordsCleared,this);a=a.records;for(b=0;b<a.length;++b)this._addRecord(a[b])};
WebInspector.TimelineFrameController.prototype={_onRecordAdded:function(a){this._addRecord(a.data)},_onRecordsCleared:function(){this._lastFrame=null},_addRecord:function(a){a.isBackground||(a=a.type===WebInspector.TimelineModel.RecordType.Program?a.children||[]:[a],a.forEach(this._innerAddRecord,this))},_innerAddRecord:function(a){a.type===WebInspector.TimelineModel.RecordType.BeginFrame&&this._lastFrame?this._flushFrame(a):(this._lastFrame||(this._lastFrame=this._createFrame(a)),a.thread||WebInspector.TimelineModel.aggregateTimeForRecord(this._lastFrame.timeByCategory,
a),this._lastFrame.cpuTime+=WebInspector.TimelineModel.durationInSeconds(a))},_flushFrame:function(a){this._lastFrame.endTime=WebInspector.TimelineModel.startTimeInSeconds(a);this._lastFrame.duration=this._lastFrame.endTime-this._lastFrame.startTime;this._overviewPane.addFrame(this._lastFrame);this._presentationModel.addFrame(this._lastFrame);this._lastFrame=this._createFrame(a)},_createFrame:function(a){var b=new WebInspector.TimelineFrame;b.startTime=WebInspector.TimelineModel.startTimeInSeconds(a);
b.startTimeOffset=this._model.recordOffsetInSeconds(a);return b},dispose:function(){this._model.removeEventListener(WebInspector.TimelineModel.Events.RecordAdded,this._onRecordAdded,this);this._model.removeEventListener(WebInspector.TimelineModel.Events.RecordsCleared,this._onRecordsCleared,this)}};
WebInspector.FrameStatistics=function(a){this.frameCount=a.length;this.minDuration=Infinity;this.maxDuration=0;this.timeByCategory={};this.startOffset=a[0].startTimeOffset;var b=a[this.frameCount-1];this.endOffset=b.startTimeOffset+b.duration;for(var c=b=0,e=0;e<this.frameCount;++e){var d=a[e].duration,b=b+d,c=c+d*d;this.minDuration=Math.min(this.minDuration,d);this.maxDuration=Math.max(this.maxDuration,d);WebInspector.TimelineModel.aggregateTimeByCategory(this.timeByCategory,a[e].timeByCategory)}this.average=
b/this.frameCount;this.stddev=Math.sqrt(c/this.frameCount-this.average*this.average)};WebInspector.TimelineFrame=function(){this.timeByCategory={};this.cpuTime=0};
WebInspector.TimelinePanel=function(){WebInspector.Panel.call(this,"timeline");this.registerRequiredCSS("timelinePanel.css");this._model=new WebInspector.TimelineModel;this._presentationModel=new WebInspector.TimelinePresentationModel;this._overviewModeSetting=WebInspector.settings.createSetting("timelineOverviewMode",WebInspector.TimelineOverviewPane.Mode.Events);this._glueRecordsSetting=WebInspector.settings.createSetting("timelineGlueRecords",!1);this._overviewPane=new WebInspector.TimelineOverviewPane(this._model);
this._overviewPane.addEventListener(WebInspector.TimelineOverviewPane.Events.WindowChanged,this._invalidateAndScheduleRefresh.bind(this,!1,!0));this._overviewPane.addEventListener(WebInspector.TimelineOverviewPane.Events.ModeChanged,this._overviewModeChanged,this);this._overviewPane.show(this.element);this.element.addEventListener("contextmenu",this._contextMenu.bind(this),!1);this.element.tabIndex=0;this.element.addStyleClass("split-view-vertical");this._sidebarBackgroundElement=document.createElement("div");
this._sidebarBackgroundElement.className="sidebar split-view-sidebar split-view-contents-first timeline-sidebar-background";this.element.appendChild(this._sidebarBackgroundElement);this.createSidebarViewWithTree();this.element.appendChild(this.splitView.resizerElement());this._containerElement=this.splitView.element;this._containerElement.id="timeline-container";this._containerElement.addEventListener("scroll",this._onScroll.bind(this),!1);this._timelineMemorySplitter=this.element.createChild("div");
this._timelineMemorySplitter.id="timeline-memory-splitter";WebInspector.installDragHandle(this._timelineMemorySplitter,this._startSplitterDragging.bind(this),this._splitterDragging.bind(this),this._endSplitterDragging.bind(this),"ns-resize");this._timelineMemorySplitter.addStyleClass("hidden");this._includeNativeMemoryStatistics=this._includeDomCounters=!1;WebInspector.experimentsSettings.nativeMemoryTimeline.isEnabled()?(this._memoryStatistics=new WebInspector.NativeMemoryGraph(this,this._model,
this.splitView.sidebarWidth()),this._includeNativeMemoryStatistics=!0):(this._memoryStatistics=new WebInspector.DOMCountersGraph(this,this._model,this.splitView.sidebarWidth()),this._includeDomCounters=!0);WebInspector.settings.memoryCounterGraphsHeight=WebInspector.settings.createSetting("memoryCounterGraphsHeight",150);var a=new WebInspector.SidebarSectionTreeElement(WebInspector.UIString("RECORDS"),{},!0);this.sidebarTree.appendChild(a);this._sidebarListElement=document.createElement("div");this.sidebarElement.appendChild(this._sidebarListElement);
this._containerContentElement=this.splitView.mainElement;this._containerContentElement.id="resources-container-content";this._timelineGrid=new WebInspector.TimelineGrid;this._itemsGraphsElement=this._timelineGrid.itemsGraphsElement;this._itemsGraphsElement.id="timeline-graphs";this._containerContentElement.appendChild(this._timelineGrid.element);this._timelineGrid.gridHeaderElement.id="timeline-grid-header";this._memoryStatistics.setMainTimelineGrid(this._timelineGrid);this.element.appendChild(this._timelineGrid.gridHeaderElement);
this._topGapElement=document.createElement("div");this._topGapElement.className="timeline-gap";this._itemsGraphsElement.appendChild(this._topGapElement);this._graphRowsElement=document.createElement("div");this._itemsGraphsElement.appendChild(this._graphRowsElement);this._bottomGapElement=document.createElement("div");this._bottomGapElement.className="timeline-gap";this._itemsGraphsElement.appendChild(this._bottomGapElement);this._expandElements=document.createElement("div");this._expandElements.id=
"orphan-expand-elements";this._itemsGraphsElement.appendChild(this._expandElements);this._calculator=new WebInspector.TimelineCalculator(this._model);this._createStatusBarItems();this._frameMode=!1;this._boundariesAreValid=!0;this._scrollTop=0;this._popoverHelper=new WebInspector.PopoverHelper(this.element,this._getPopoverAnchor.bind(this),this._showPopover.bind(this));this.element.addEventListener("mousemove",this._mouseMove.bind(this),!1);this.element.addEventListener("mouseout",this._mouseOut.bind(this),
!1);this._durationFilter=new WebInspector.TimelineIsLongFilter;this._expandOffset=15;this._headerLineCount=1;this._adjustHeaderHeight();this._mainThreadTasks=[];this._cpuBarsElement=this._timelineGrid.gridHeaderElement.createChild("div","timeline-cpu-bars");this._mainThreadMonitoringEnabled=Capabilities.timelineCanMonitorMainThread&&WebInspector.settings.showCpuOnTimelineRuler.get();WebInspector.settings.showCpuOnTimelineRuler.addChangeListener(this._showCpuOnTimelineRulerChanged,this);this._createFileSelector();
this._model.addEventListener(WebInspector.TimelineModel.Events.RecordAdded,this._onTimelineEventRecorded,this);this._model.addEventListener(WebInspector.TimelineModel.Events.RecordsCleared,this._onRecordsCleared,this);this._registerShortcuts();this._allRecordsCount=0;this._presentationModel.addFilter(new WebInspector.TimelineWindowFilter(this._overviewPane));this._presentationModel.addFilter(new WebInspector.TimelineCategoryFilter);this._presentationModel.addFilter(this._durationFilter)};
WebInspector.TimelinePanel.rowHeight=18;WebInspector.TimelinePanel.durationFilterPresetsMs=[0,1,15];
WebInspector.TimelinePanel.prototype={_showCpuOnTimelineRulerChanged:function(){var a=WebInspector.settings.showCpuOnTimelineRuler.get();this._mainThreadMonitoringEnabled!==a&&(this._mainThreadMonitoringEnabled=a,this._refreshMainThreadBars())},_startSplitterDragging:function(a){this._dragOffset=this._timelineMemorySplitter.offsetTop+2-a.pageY;return!0},_splitterDragging:function(a){this._setSplitterPosition(a.pageY+this._dragOffset);a.preventDefault()},_endSplitterDragging:function(a){delete this._dragOffset;
this._memoryStatistics.show();WebInspector.settings.memoryCounterGraphsHeight.set(this.splitView.element.offsetHeight)},_setSplitterPosition:function(a){a=Number.constrain(a,190,this.element.offsetHeight-100);this.splitView.element.style.height=a-90+"px";this._timelineMemorySplitter.style.top=a-2+"px";this._memoryStatistics.setTopPosition(a);this._containerElementHeight=this._containerElement.clientHeight;this.onResize()},get calculator(){return this._calculator},statusBarItems:function(){return this._statusBarItems.select("element").concat([this._miscStatusBarItems])},
defaultFocusedElement:function(){return this.element},_createStatusBarItems:function(){this._statusBarItems=[];this.toggleTimelineButton=new WebInspector.StatusBarButton(WebInspector.UIString("Record"),"record-profile-status-bar-item");this.toggleTimelineButton.addEventListener("click",this._toggleTimelineButtonClicked,this);this._statusBarItems.push(this.toggleTimelineButton);this.clearButton=new WebInspector.StatusBarButton(WebInspector.UIString("Clear"),"clear-status-bar-item");this.clearButton.addEventListener("click",
this._clearPanel,this);this._statusBarItems.push(this.clearButton);this.garbageCollectButton=new WebInspector.StatusBarButton(WebInspector.UIString("Collect Garbage"),"garbage-collect-status-bar-item");this.garbageCollectButton.addEventListener("click",this._garbageCollectButtonClicked,this);this._statusBarItems.push(this.garbageCollectButton);this._glueParentButton=new WebInspector.StatusBarButton(WebInspector.UIString("Glue asynchronous events to causes"),"glue-async-status-bar-item");this._glueParentButton.toggled=
this._glueRecordsSetting.get();this._presentationModel.setGlueRecords(this._glueParentButton.toggled);this._glueParentButton.addEventListener("click",this._glueParentButtonClicked,this);this._statusBarItems.push(this._glueParentButton);this._durationFilterSelector=new WebInspector.StatusBarComboBox(this._durationFilterChanged.bind(this));for(var a=0;a<WebInspector.TimelinePanel.durationFilterPresetsMs.length;++a){var b=WebInspector.TimelinePanel.durationFilterPresetsMs[a],c=document.createElement("option");
b?(c.text=WebInspector.UIString("\u2265 %dms",b),c.title=WebInspector.UIString("Hide records shorter than %dms",b)):(c.text=WebInspector.UIString("All"),c.title=WebInspector.UIString("Show all records"));c._durationMs=b;this._durationFilterSelector.addOption(c);this._durationFilterSelector.element.title=this._durationFilterSelector.selectedOption().title}this._statusBarItems.push(this._durationFilterSelector);this._miscStatusBarItems=document.createElement("div");this._miscStatusBarItems.className=
"status-bar-items timeline-misc-status-bar-items";this._statusBarFilters=this._miscStatusBarItems.createChild("div","timeline-misc-status-bar-filters");var a=WebInspector.TimelinePresentationModel.categories(),e;for(e in a)b=a[e],0>b.overviewStripGroupIndex||this._statusBarFilters.appendChild(this._createTimelineCategoryStatusBarCheckbox(b,this._onCategoryCheckboxClicked.bind(this,b)));e=this._statusBarFilters.createChild("div");e.className="timeline-records-stats-container";this.recordsCounter=e.createChild("div");
this.recordsCounter.className="timeline-records-stats";this.frameStatistics=e.createChild("div");this.frameStatistics.className="timeline-records-stats hidden";this._frameStatisticsPopoverHelper=new WebInspector.PopoverHelper(this.frameStatistics,function(){return this.frameStatistics}.bind(this),this._showFrameStatistics.bind(this))},_createTimelineCategoryStatusBarCheckbox:function(a,b){var c=document.createElement("div");c.addStyleClass("timeline-category-statusbar-item");c.addStyleClass("timeline-category-"+
a.name);c.addStyleClass("status-bar-item");var e=document.createElement("label"),d=document.createElement("input");d.type="checkbox";d.className="timeline-category-checkbox";d.checked=!0;d.addEventListener("click",b,!1);e.appendChild(d);d=document.createElement("span");d.className="type";d.textContent=a.title;e.appendChild(d);c.appendChild(e);return c},_onCategoryCheckboxClicked:function(a,b){a.hidden=!b.target.checked;this._invalidateAndScheduleRefresh(!0,!0)},_setOperationInProgress:function(a){this._operationInProgress=
!!a;for(var b=0;b<this._statusBarItems.length;++b)this._statusBarItems[b].setEnabled(!this._operationInProgress);this._glueParentButton.setEnabled(!this._operationInProgress&&!this._frameController);this._miscStatusBarItems.removeChildren();this._miscStatusBarItems.appendChild(a?a.element:this._statusBarFilters)},_registerShortcuts:function(){this.registerShortcuts(WebInspector.TimelinePanelDescriptor.ShortcutKeys.StartStopRecording,this._toggleTimelineButtonClicked.bind(this));InspectorFrontendHost.canSave()&&
this.registerShortcuts(WebInspector.TimelinePanelDescriptor.ShortcutKeys.SaveToFile,this._saveToFile.bind(this));this.registerShortcuts(WebInspector.TimelinePanelDescriptor.ShortcutKeys.LoadFromFile,this._selectFileToLoad.bind(this))},_createFileSelector:function(){this._fileSelectorElement&&this.element.removeChild(this._fileSelectorElement);this._fileSelectorElement=WebInspector.createFileSelectorElement(this._loadFromFile.bind(this));this.element.appendChild(this._fileSelectorElement)},_contextMenu:function(a){a=
new WebInspector.ContextMenu(a);InspectorFrontendHost.canSave()&&a.appendItem(WebInspector.UIString(WebInspector.useLowerCaseMenuTitles()?"Save Timeline data\u2026":"Save Timeline Data\u2026"),this._saveToFile.bind(this),this._operationInProgress);a.appendItem(WebInspector.UIString(WebInspector.useLowerCaseMenuTitles()?"Load Timeline data\u2026":"Load Timeline Data\u2026"),this._selectFileToLoad.bind(this),this._operationInProgress);a.show()},_saveToFile:function(a){if(this._operationInProgress)return!0;
this._model.saveToFile();return!0},_selectFileToLoad:function(a){this._fileSelectorElement.click();return!0},_loadFromFile:function(a){var b=this._prepareToLoadTimeline();b&&(this._model.loadFromFile(a,b),this._createFileSelector())},loadFromURL:function(a){var b=this._prepareToLoadTimeline();b&&this._model.loadFromURL(a,b)},_prepareToLoadTimeline:function(){if(this._operationInProgress)return null;this.toggleTimelineButton.toggled&&(this.toggleTimelineButton.toggled=!1,this._model.stopRecord());
var a=new WebInspector.ProgressIndicator;a.addEventListener(WebInspector.ProgressIndicator.Events.Done,this._setOperationInProgress.bind(this,null));this._setOperationInProgress(a);return a},_rootRecord:function(){return this._presentationModel.rootRecord()},_updateRecordsCounter:function(a){this.recordsCounter.textContent=WebInspector.UIString("%d of %d records shown",a,this._allRecordsCount)},_updateFrameStatistics:function(a){if(a.length){this._lastFrameStatistics=new WebInspector.FrameStatistics(a);
var b=WebInspector.UIString("avg: %s, \u03c3: %s",Number.secondsToString(this._lastFrameStatistics.average,!0),Number.secondsToString(this._lastFrameStatistics.stddev,!0))}else this._lastFrameStatistics=null;this.frameStatistics.textContent=WebInspector.UIString("%d of %d frames shown",a.length,this._presentationModel.frames().length);b&&(this.frameStatistics.appendChild(document.createTextNode(" (")),this.frameStatistics.createChild("span","timeline-frames-stats").textContent=b,this.frameStatistics.appendChild(document.createTextNode(")")))},
_showFrameStatistics:function(a,b){b.show(WebInspector.TimelinePresentationModel.generatePopupContentForFrameStatistics(this._lastFrameStatistics),a)},_updateEventDividers:function(){this._timelineGrid.removeEventDividers();for(var a=this._graphRowsElementWidth,b=[],c=this._presentationModel.eventDividerRecords(),e=0;e<c.length;++e){var d=c[e],f=this._calculator.computeBarGraphWindowPosition(d),f=Math.round(f.left);0>f||f>=a||b[f]||(d=WebInspector.TimelinePresentationModel.createEventDivider(d.type,
d.title),d.style.left=f+"px",b[f]=d)}this._timelineGrid.addEventDividers(b)},_updateFrameBars:function(a){this._frameContainer?this._frameContainer.removeChildren():(this._frameContainer=document.createElement("div"),this._frameContainer.addStyleClass("fill"),this._frameContainer.addStyleClass("timeline-frame-container"),this._frameContainer.style.height=this._headerLineCount*WebInspector.TimelinePanel.rowHeight+1+"px",this._frameContainer.addEventListener("dblclick",this._onFrameDoubleClicked.bind(this),
!1));for(var b=[this._frameContainer],c=0;c<a.length;++c){var e=a[c],d=this._calculator.computePosition(e.startTime),f=this._calculator.computePosition(e.endTime),g=document.createElement("div");g.className="timeline-frame-strip";var h=Math.max(d,0),f=f-h;g.style.left=h+"px";g.style.width=f+"px";g._frame=e;60<f&&(g.textContent=Number.secondsToString(e.endTime-e.startTime,!0));this._frameContainer.appendChild(g);0<h&&(e=WebInspector.TimelinePresentationModel.createEventDivider(WebInspector.TimelineModel.RecordType.BeginFrame),
e.style.left=d+"px",b.push(e))}this._timelineGrid.addEventDividers(b)},_onFrameDoubleClicked:function(a){(a=a.target.enclosingNodeOrSelfWithClass("timeline-frame-strip"))&&this._overviewPane.zoomToFrame(a._frame)},_overviewModeChanged:function(a){a=a.data;var b=a===WebInspector.TimelineOverviewPane.Mode.Memory,c=a===WebInspector.TimelineOverviewPane.Mode.Frames;this._overviewModeSetting.set(a);c!==this._frameMode&&(this._frameMode=c,this._glueParentButton.setEnabled(!c),this._presentationModel.setGlueRecords(this._glueParentButton.toggled&&
!c),this._repopulateRecords(),c?(this.element.addStyleClass("timeline-frame-overview"),this.recordsCounter.addStyleClass("hidden"),this.frameStatistics.removeStyleClass("hidden"),this._frameController=new WebInspector.TimelineFrameController(this._model,this._overviewPane,this._presentationModel)):(this._frameController.dispose(),this._frameController=null,this.element.removeStyleClass("timeline-frame-overview"),this.recordsCounter.removeStyleClass("hidden"),this.frameStatistics.addStyleClass("hidden")));
b!==this._memoryStatistics.visible()&&(b?(this._timelineMemorySplitter.removeStyleClass("hidden"),this._memoryStatistics.show(),this.splitView.element.style.bottom="auto",this._setSplitterPosition(WebInspector.settings.memoryCounterGraphsHeight.get())):(this._timelineMemorySplitter.addStyleClass("hidden"),this._memoryStatistics.hide(),this.splitView.element.style.height="auto",this.splitView.element.style.bottom="0",this.onResize()))},_toggleTimelineButtonClicked:function(){if(this._operationInProgress)return!0;
this.toggleTimelineButton.toggled?(this._model.stopRecord(),this.toggleTimelineButton.title=WebInspector.UIString("Record")):(this._model.startRecord(this._includeDomCounters,this._includeNativeMemoryStatistics),this.toggleTimelineButton.title=WebInspector.UIString("Stop"),WebInspector.userMetrics.TimelineStarted.record());this.toggleTimelineButton.toggled=!this.toggleTimelineButton.toggled;return!0},_durationFilterChanged:function(){var a=this._durationFilterSelector.selectedOption();this._durationFilter.setMinimumRecordDuration(+a._durationMs/
1E3);this._durationFilterSelector.element.title=a.title;this._invalidateAndScheduleRefresh(!0,!0)},_garbageCollectButtonClicked:function(){HeapProfilerAgent.collectGarbage()},_glueParentButtonClicked:function(){var a=!this._glueParentButton.toggled;this._glueParentButton.toggled=a;this._presentationModel.setGlueRecords(a);this._glueRecordsSetting.set(a);this._repopulateRecords()},_repopulateRecords:function(){this._resetPanel();this._automaticallySizeWindow=!1;for(var a=this._model.records,b=0;b<
a.length;++b)this._innerAddRecordToTimeline(a[b]);this._invalidateAndScheduleRefresh(!1,!0)},_onTimelineEventRecorded:function(a){this._innerAddRecordToTimeline(a.data)&&this._invalidateAndScheduleRefresh(!1,!1)},_innerAddRecordToTimeline:function(a){function b(a){return a.parent!==e.rootRecord}a.type===WebInspector.TimelineModel.RecordType.Program&&this._mainThreadTasks.push({startTime:WebInspector.TimelineModel.startTimeInSeconds(a),endTime:WebInspector.TimelineModel.endTimeInSeconds(a)});a=this._presentationModel.addRecord(a);
this._allRecordsCount+=a.length;var c=!1,e=this._presentationModel;WebInspector.TimelinePresentationModel.forAllRecords(a,function(a){c|=e.isVisible(a)});return c||a.some(b)},sidebarResized:function(a){a=a.data;this._resize(a);this._sidebarBackgroundElement.style.width=a+"px";this._overviewPane.sidebarResized(a);this._memoryStatistics.setSidebarWidth(a);this._timelineGrid.gridHeaderElement.style.left=a+"px"},onResize:function(){this._resize(this.splitView.sidebarWidth())},_resize:function(a){this._closeRecordDetails();
this._scheduleRefresh(!1,!0);this._graphRowsElementWidth=this._graphRowsElement.offsetWidth;this._containerElementHeight=this._containerElement.clientHeight;var b=this._statusBarItems[this._statusBarItems.length-1].element,b=b.totalOffsetLeft()+b.offsetWidth;this._timelineGrid.gridHeaderElement.style.width=this._itemsGraphsElement.offsetWidth+"px";this._miscStatusBarItems.style.left=Math.max(b,a)+"px"},_clearPanel:function(){this._model.reset()},_onRecordsCleared:function(){this._resetPanel();this._invalidateAndScheduleRefresh(!0,
!0)},_resetPanel:function(){this._presentationModel.reset();this._boundariesAreValid=!1;this._adjustScrollPosition(0);this._closeRecordDetails();this._allRecordsCount=0;this._automaticallySizeWindow=!0;this._mainThreadTasks=[]},elementsToRestoreScrollPositionsFor:function(){return[this._containerElement]},wasShown:function(){WebInspector.Panel.prototype.wasShown.call(this);WebInspector.TimelinePanel._categoryStylesInitialized||(WebInspector.TimelinePanel._categoryStylesInitialized=!0,this._injectCategoryStyles());
this._overviewPane.setMode(this._overviewModeSetting.get());this._refresh()},willHide:function(){this._closeRecordDetails();WebInspector.Panel.prototype.willHide.call(this)},_onScroll:function(a){this._closeRecordDetails();this._scrollTop=this._containerElement.scrollTop;a=Math.max(0,this._scrollTop);this._timelineGrid.setScrollAndDividerTop(this._scrollTop,a);this._scheduleRefresh(!0,!0)},_invalidateAndScheduleRefresh:function(a,b){this._presentationModel.invalidateFilteredRecords();delete this._searchResults;
this._scheduleRefresh(a,b)},_scheduleRefresh:function(a,b){this._closeRecordDetails();this._boundariesAreValid&=a;this.isShowing()&&(a||b?this._refresh():this._refreshTimeout||(this._refreshTimeout=setTimeout(this._refresh.bind(this),300)))},_refresh:function(){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),delete this._refreshTimeout);this._timelinePaddingLeft=this._expandOffset;this._calculator.setWindow(this._overviewPane.windowStartTime(),this._overviewPane.windowEndTime());this._calculator.setDisplayWindow(this._timelinePaddingLeft,
this._graphRowsElementWidth);var a=this._refreshRecords();this._updateRecordsCounter(a);this._boundariesAreValid||(this._updateEventDividers(),(a=this._frameController&&this._presentationModel.filteredFrames(this._overviewPane.windowStartTime(),this._overviewPane.windowEndTime()))?(this._updateFrameStatistics(a),a.length&&30>a.length?(this._timelineGrid.removeDividers(),this._updateFrameBars(a)):this._timelineGrid.updateDividers(this._calculator)):this._timelineGrid.updateDividers(this._calculator),
this._mainThreadMonitoringEnabled&&this._refreshMainThreadBars());this._memoryStatistics.visible()&&this._memoryStatistics.refresh();this._boundariesAreValid=!0},revealRecordAt:function(a){var b;WebInspector.TimelinePresentationModel.forAllRecords(this._presentationModel.rootRecord().children,null,function(c){if(c.containsTime(a))return b=c,!0;if(!b||c.endTime<a&&b.endTime<c.endTime)b=c;return!1});b?this._revealRecord(b):this._containerElement.scrollTop=0},_revealRecord:function(a){this._recordToHighlight=
a;for(var b=!1,c=a.parent;c!==this._rootRecord();c=c.parent)b=b||c.collapsed,c.collapsed=!1;b&&this._invalidateAndScheduleRefresh(!0,!0);a=this._presentationModel.filteredRecords().indexOf(a);this._containerElement.scrollTop=a*WebInspector.TimelinePanel.rowHeight},_refreshRecords:function(){var a=this._presentationModel.filteredRecords(),b=this._scrollTop,c=b+this._containerElementHeight,e=WebInspector.TimelinePanel.rowHeight,d=Math.max(0,Math.min(Math.floor(b/e)-this._headerLineCount,a.length-1)),
f=Math.min(a.length,Math.ceil(c/e)),c=Math.max(0,Math.floor(c/e)-this._headerLineCount);this._automaticallySizeWindow&&a.length>c&&(this._automaticallySizeWindow=!1,f=d?a[d].startTime:this._model.minimumRecordTime(),this._overviewPane.setWindowTimes(f,a[Math.max(0,c-1)].endTime),a=this._presentationModel.filteredRecords(),f=Math.min(a.length,c));c=d*e+"px";this._topGapElement.style.height=c;this.sidebarElement.style.top=c;this._bottomGapElement.style.height=(a.length-f)*e+"px";c=this._sidebarListElement.firstChild;
this._itemsGraphsElement.removeChild(this._graphRowsElement);var g=this._graphRowsElement.firstChild,h=this._invalidateAndScheduleRefresh.bind(this,!0,!0);this._itemsGraphsElement.removeChild(this._expandElements);this._expandElements.removeChildren();this._clearRecordHighlight();var k=this._recordToHighlight;delete this._recordToHighlight;for(var l=0;l<f;++l){var m=a[l],n=!(l%2);if(l<d){if(n=l+m.visibleChildrenCount,n>=d&&n<f){var n=new WebInspector.TimelineExpandableElement(this._expandElements),
p=this._calculator.computeBarGraphWindowPosition(m);n._update(m,l,p.left-this._expandOffset,p.width)}}else c||(c=(new WebInspector.TimelineRecordListRow).element,this._sidebarListElement.appendChild(c)),g||(g=(new WebInspector.TimelineRecordGraphRow(this._itemsGraphsElement,h)).element,this._graphRowsElement.appendChild(g)),k===m&&(this._highlightedListRowElement=c,this._highlightedGraphRowElement=g),c.row.update(m,n,b),g.row.update(m,n,this._calculator,this._expandOffset,l),c=c.nextSibling,g=g.nextSibling}for(;c;)b=
c.nextSibling,c.row.dispose(),c=b;for(;g;)b=g.nextSibling,g.row.dispose(),g=b;this._itemsGraphsElement.insertBefore(this._graphRowsElement,this._bottomGapElement);this._itemsGraphsElement.appendChild(this._expandElements);this._adjustScrollPosition((a.length+this._headerLineCount)*e);this._updateSearchHighlight(!1);this._highlightedListRowElement&&(this._highlightedListRowElement.addStyleClass("highlighted-timeline-record"),this._highlightedGraphRowElement.addStyleClass("highlighted-timeline-record"));
return a.length},_clearRecordHighlight:function(){this._highlightedListRowElement&&(this._highlightedListRowElement.removeStyleClass("highlighted-timeline-record"),delete this._highlightedListRowElement,this._highlightedGraphRowElement.removeStyleClass("highlighted-timeline-record"),delete this._highlightedGraphRowElement)},_refreshMainThreadBars:function(){for(var a=WebInspector.TimelineCalculator._minWidth,b=a/2,c=this._graphRowsElementWidth,a=(this._overviewPane.windowEndTime()-this._overviewPane.windowStartTime())/
(c-a-this._timelinePaddingLeft),e=this._overviewPane.windowStartTime()-this._timelinePaddingLeft*a,a=e+c*a,d=this._mainThreadMonitoringEnabled?this._mainThreadTasks:[],f=insertionIndexForObjectInListSortedByFunction(e,d,function(a,b){return a<b.endTime?-1:1}),e=this._cpuBarsElement,g=e.firstChild,h,k,l;f<d.length;++f){var m=d[f];if(m.startTime>a)break;var n=Math.max(0,this._calculator.computePosition(m.startTime)+3-b),m=Math.min(c,this._calculator.computePosition(m.endTime)+3+b);if(h){if(3>Math.floor(n)-
Math.ceil(l)){l=m;h._tasksInfo.lastTaskIndex=f;continue}h.style.width=l-k+"px"}g||(g=e.createChild("div","timeline-graph-bar"));g.style.left=n+"px";g._tasksInfo={tasks:d,firstTaskIndex:f,lastTaskIndex:f};k=n;l=m;h=g;g=g.nextSibling}h&&(h.style.width=l-k+"px");for(;g;)b=g.nextSibling,g._tasksInfo=null,e.removeChild(g),g=b},_adjustHeaderHeight:function(){var a=this._headerLineCount*WebInspector.TimelinePanel.rowHeight;this.sidebarElement.firstChild.style.height=a+"px";this._timelineGrid.dividersLabelBarElement.style.height=
a+2+"px";this._itemsGraphsElement.style.top=a+1+"px"},_adjustScrollPosition:function(a){this._scrollTop+this._containerElementHeight>a+1&&(this._containerElement.scrollTop=a-this._containerElement.offsetHeight)},_getPopoverAnchor:function(a){return a.enclosingNodeOrSelfWithClass("timeline-graph-bar")||a.enclosingNodeOrSelfWithClass("timeline-tree-item")||a.enclosingNodeOrSelfWithClass("timeline-frame-strip")},_mouseOut:function(a){this._hideQuadHighlight()},_mouseMove:function(a){(a=this._getPopoverAnchor(a.target))&&
a.row&&a.row._record.highlightQuad?this._highlightQuad(a.row._record.highlightQuad):this._hideQuadHighlight();if(a&&a._tasksInfo){var b=a.offsetLeft;this._timelineGrid.showCurtains(0<=b?b:0,a.offsetWidth)}else this._timelineGrid.hideCurtains()},_highlightQuad:function(a){this._highlightedQuad!==a&&(this._highlightedQuad=a,DOMAgent.highlightQuad(a,WebInspector.Color.PageHighlight.Content.toProtocolRGBA(),WebInspector.Color.PageHighlight.ContentOutline.toProtocolRGBA()))},_hideQuadHighlight:function(){this._highlightedQuad&&
(delete this._highlightedQuad,DOMAgent.hideHighlight())},_showPopover:function(a,b){function c(c){b.show(c,a)}a.hasStyleClass("timeline-frame-strip")?b.show(WebInspector.TimelinePresentationModel.generatePopupContentForFrame(a._frame),a):a.row&&a.row._record?a.row._record.generatePopupContent(c):a._tasksInfo&&b.show(this._presentationModel.generateMainThreadBarPopupContent(a._tasksInfo),a,null,null,WebInspector.Popover.Orientation.Bottom)},_closeRecordDetails:function(){this._popoverHelper.hidePopover()},
_injectCategoryStyles:function(){var a=document.createElement("style"),b=WebInspector.TimelinePresentationModel.categories();a.textContent=Object.values(b).map(WebInspector.TimelinePresentationModel.createStyleRuleForCategory).join("\n");document.head.appendChild(a)},jumpToNextSearchResult:function(){this._jumpToAdjacentRecord(1)},jumpToPreviousSearchResult:function(){this._jumpToAdjacentRecord(-1)},_jumpToAdjacentRecord:function(a){if(this._searchResults&&this._searchResults.length&&this._selectedSearchResult){var b=
this._searchResults.indexOf(this._selectedSearchResult),b=(b+a+this._searchResults.length)%this._searchResults.length;this._selectSearchResult(b);this._highlightSelectedSearchResult(!0)}},_selectSearchResult:function(a){this._selectedSearchResult=this._searchResults[a];WebInspector.searchController.updateCurrentMatchIndex(a,this)},_highlightSelectedSearchResult:function(a){this._clearHighlight();if(!this._searchFilter){var b=this._selectedSearchResult;if(b){for(var c=this._sidebarListElement.firstChild;c;c=
c.nextSibling)if(c.row._record===b){c.row.highlight(this._searchRegExp,this._highlightDomChanges);return}a&&this._revealRecord(b)}}},_clearHighlight:function(){this._highlightDomChanges&&WebInspector.revertDomChanges(this._highlightDomChanges);this._highlightDomChanges=[]},_updateSearchHighlight:function(a){this._searchFilter||!this._searchRegExp?this._clearHighlight():(this._searchResults||this._updateSearchResults(),this._highlightSelectedSearchResult(a))},_updateSearchResults:function(){function a(a){e.isVisible(a)&&
WebInspector.TimelineRecordListRow.testContentMatching(a,b)&&c.push(a);return!1}var b=this._searchRegExp;if(b){var c=[],e=this._presentationModel;WebInspector.TimelinePresentationModel.forAllRecords(e.rootRecord().children,a);var d=c.length;d?(this._searchResults=c,WebInspector.searchController.updateSearchMatchesCount(d,this),d=c.indexOf(this._selectedSearchResult),-1===d&&(d=0),this._selectSearchResult(d)):(WebInspector.searchController.updateSearchMatchesCount(0,this),delete this._selectedSearchResult)}},
searchCanceled:function(){this._clearHighlight();delete this._searchResults;delete this._selectedSearchResult;delete this._searchRegExp},canFilter:function(){return!0},performFilter:function(a){this._presentationModel.removeFilter(this._searchFilter);delete this._searchFilter;this.searchCanceled();a&&(this._searchFilter=new WebInspector.TimelineSearchFilter(createPlainTextSearchRegex(a,"i")),this._presentationModel.addFilter(this._searchFilter));this._invalidateAndScheduleRefresh(!0,!0)},performSearch:function(a){this._searchRegExp=
createPlainTextSearchRegex(a,"i");delete this._searchResults;this._updateSearchHighlight(!0)},__proto__:WebInspector.Panel.prototype};WebInspector.TimelineCalculator=function(a){this._model=a};WebInspector.TimelineCalculator._minWidth=5;
WebInspector.TimelineCalculator.prototype={computePosition:function(a){return(a-this._minimumBoundary)/this.boundarySpan()*this._workingArea+this._paddingLeft},computeBarGraphPercentages:function(a){var b=(a.startTime-this._minimumBoundary)/this.boundarySpan()*100,c=(a.startTime+a.selfTime-this._minimumBoundary)/this.boundarySpan()*100,e=(a.lastChildEndTime-this._minimumBoundary)/this.boundarySpan()*100;a=a.coalesced?e-b:a.cpuTime/this.boundarySpan()*100;return{start:b,end:c,endWithChildren:e,cpuWidth:a}},
computeBarGraphWindowPosition:function(a){var b=this.computeBarGraphPercentages(a),c=0;a=this.computePosition(a.startTime);var e=(b.end-b.start)/100*this._workingArea;e<WebInspector.TimelineCalculator._minWidth&&(c=WebInspector.TimelineCalculator._minWidth-e,a-=c/2,e+=c);var d=(b.endWithChildren-b.start)/100*this._workingArea+c,f=b.cpuWidth/100*this._workingArea+c;b.endWithChildren>b.end&&(d+=c);return{left:a,width:e,widthWithChildren:d,cpuWidth:f}},setWindow:function(a,b){this._minimumBoundary=a;
this._maximumBoundary=b},setDisplayWindow:function(a,b){this._workingArea=b-WebInspector.TimelineCalculator._minWidth-a;this._paddingLeft=a},formatTime:function(a){return Number.secondsToString(a+this._minimumBoundary-this._model.minimumRecordTime())},maximumBoundary:function(){return this._maximumBoundary},minimumBoundary:function(){return this._minimumBoundary},zeroTime:function(){return this._model.minimumRecordTime()},boundarySpan:function(){return this._maximumBoundary-this._minimumBoundary}};
WebInspector.TimelineRecordListRow=function(){this.element=document.createElement("div");this.element.row=this;this.element.style.cursor="pointer";var a=document.createElement("span");a.className="timeline-tree-icon";this.element.appendChild(a);this._typeElement=document.createElement("span");this._typeElement.className="type";this.element.appendChild(this._typeElement);a=document.createElement("span");a.className="separator";a.textContent=" ";this._dataElement=document.createElement("span");this._dataElement.className=
"data dimmed";this.element.appendChild(a);this.element.appendChild(this._dataElement)};
WebInspector.TimelineRecordListRow.prototype={update:function(a,b,c){this._record=a;this._offset=c;this.element.className="timeline-tree-item timeline-category-"+a.category.name;b&&this.element.addStyleClass("even");a.hasWarning?this.element.addStyleClass("warning"):a.childHasWarning&&this.element.addStyleClass("child-warning");a.isBackground&&this.element.addStyleClass("background");this._typeElement.textContent=a.title;this._dataElement.firstChild&&this._dataElement.removeChildren();a.detailsNode()&&
this._dataElement.appendChild(a.detailsNode())},highlight:function(a,b){var c=this.element.textContent.match(a);c&&WebInspector.highlightSearchResult(this.element,c.index,c[0].length,b)},dispose:function(){this.element.parentElement.removeChild(this.element)}};WebInspector.TimelineRecordListRow.testContentMatching=function(a,b){var c=a.title;a.detailsNode()&&(c+=" "+a.detailsNode().textContent);return b.test(c)};
WebInspector.TimelineRecordGraphRow=function(a,b){this.element=document.createElement("div");this.element.row=this;this._barAreaElement=document.createElement("div");this._barAreaElement.className="timeline-graph-bar-area";this.element.appendChild(this._barAreaElement);this._barWithChildrenElement=document.createElement("div");this._barWithChildrenElement.className="timeline-graph-bar with-children";this._barWithChildrenElement.row=this;this._barAreaElement.appendChild(this._barWithChildrenElement);
this._barCpuElement=document.createElement("div");this._barCpuElement.className="timeline-graph-bar cpu";this._barCpuElement.row=this;this._barAreaElement.appendChild(this._barCpuElement);this._barElement=document.createElement("div");this._barElement.className="timeline-graph-bar";this._barElement.row=this;this._barAreaElement.appendChild(this._barElement);this._expandElement=new WebInspector.TimelineExpandableElement(a);this._expandElement._element.addEventListener("click",this._onClick.bind(this));
this._scheduleRefresh=b};
WebInspector.TimelineRecordGraphRow.prototype={update:function(a,b,c,e,d){this._record=a;this.element.className="timeline-graph-side timeline-category-"+a.category.name;b&&this.element.addStyleClass("even");a.isBackground&&this.element.addStyleClass("background");b=c.computeBarGraphWindowPosition(a);this._barWithChildrenElement.style.left=b.left+"px";this._barWithChildrenElement.style.width=b.widthWithChildren+"px";this._barElement.style.left=b.left+"px";this._barElement.style.width=b.width+"px";
this._barCpuElement.style.left=b.left+"px";this._barCpuElement.style.width=b.cpuWidth+"px";this._expandElement._update(a,d,b.left-e,b.width)},_onClick:function(a){this._record.collapsed=!this._record.collapsed;this._scheduleRefresh(!1,!0)},dispose:function(){this.element.parentElement.removeChild(this.element);this._expandElement._dispose()}};
WebInspector.TimelineExpandableElement=function(a){this._element=document.createElement("div");this._element.className="timeline-expandable";var b=document.createElement("div");b.className="timeline-expandable-left";this._element.appendChild(b);a.appendChild(this._element)};
WebInspector.TimelineExpandableElement.prototype={_update:function(a,b,c,e){var d=WebInspector.TimelinePanel.rowHeight;a.visibleChildrenCount||a.invisibleChildrenCount?(this._element.style.top=b*d+"px",this._element.style.left=c+"px",this._element.style.width=Math.max(12,e+25)+"px",a.collapsed?(this._element.style.height=d+"px",this._element.addStyleClass("timeline-expandable-collapsed"),this._element.removeStyleClass("timeline-expandable-expanded")):(this._element.style.height=(a.visibleChildrenCount+
1)*d+"px",this._element.addStyleClass("timeline-expandable-expanded"),this._element.removeStyleClass("timeline-expandable-collapsed")),this._element.removeStyleClass("hidden")):this._element.addStyleClass("hidden")},_dispose:function(){this._element.parentElement.removeChild(this._element)}};WebInspector.TimelineCategoryFilter=function(){};WebInspector.TimelineCategoryFilter.prototype={accept:function(a){return!a.category.hidden&&a.type!==WebInspector.TimelineModel.RecordType.BeginFrame}};
WebInspector.TimelineIsLongFilter=function(){this._minimumRecordDuration=0};WebInspector.TimelineIsLongFilter.prototype={setMinimumRecordDuration:function(a){this._minimumRecordDuration=a},accept:function(a){return this._minimumRecordDuration?a.lastChildEndTime-a.startTime>=this._minimumRecordDuration:!0}};WebInspector.TimelineSearchFilter=function(a){this._regExp=a};WebInspector.TimelineSearchFilter.prototype={accept:function(a){return WebInspector.TimelineRecordListRow.testContentMatching(a,this._regExp)}};
