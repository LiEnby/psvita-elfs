WebInspector.ApplicationCacheItemsView=function(a,b){WebInspector.View.call(this);this._model=a;this.element.addStyleClass("storage-view");this.element.addStyleClass("table");this.deleteButton=new WebInspector.StatusBarButton(WebInspector.UIString("Delete"),"delete-storage-status-bar-item");this.deleteButton.visible=!1;this.deleteButton.addEventListener("click",this._deleteButtonClicked,this);this.connectivityIcon=document.createElement("img");this.connectivityIcon.className="storage-application-cache-connectivity-icon";
this.connectivityIcon.src="";this.connectivityMessage=document.createElement("span");this.connectivityMessage.className="storage-application-cache-connectivity";this.connectivityMessage.textContent="";this.divider=document.createElement("span");this.divider.className="status-bar-item status-bar-divider";this.statusIcon=document.createElement("img");this.statusIcon.className="storage-application-cache-status-icon";this.statusIcon.src="";this.statusMessage=document.createElement("span");this.statusMessage.className=
"storage-application-cache-status";this.statusMessage.textContent="";this._frameId=b;this._emptyView=new WebInspector.EmptyView(WebInspector.UIString("No Application Cache information available."));this._emptyView.show(this.element);this._markDirty();var c=this._model.frameManifestStatus(b);this.updateStatus(c);this.updateNetworkState(this._model.onLine);this.deleteButton.element.style.display="none"};
WebInspector.ApplicationCacheItemsView.prototype={statusBarItems:function(){return[this.deleteButton.element,this.connectivityIcon,this.connectivityMessage,this.divider,this.statusIcon,this.statusMessage]},wasShown:function(){this._maybeUpdate()},willHide:function(){this.deleteButton.visible=!1},_maybeUpdate:function(){this.isShowing()&&this._viewDirty&&(this._update(),this._viewDirty=!1)},_markDirty:function(){this._viewDirty=!0},updateStatus:function(a){var b=this._status;this._status=a;var c={};
c[applicationCache.UNCACHED]={src:"Images/errorRedDot.png",text:"UNCACHED"};c[applicationCache.IDLE]={src:"Images/successGreenDot.png",text:"IDLE"};c[applicationCache.CHECKING]={src:"Images/warningOrangeDot.png",text:"CHECKING"};c[applicationCache.DOWNLOADING]={src:"Images/warningOrangeDot.png",text:"DOWNLOADING"};c[applicationCache.UPDATEREADY]={src:"Images/successGreenDot.png",text:"UPDATEREADY"};c[applicationCache.OBSOLETE]={src:"Images/errorRedDot.png",text:"OBSOLETE"};a=c[a]||c[applicationCache.UNCACHED];
this.statusIcon.src=a.src;this.statusMessage.textContent=a.text;!this.isShowing()||this._status!==applicationCache.IDLE||b!==applicationCache.UPDATEREADY&&this._resources||this._markDirty();this._maybeUpdate()},updateNetworkState:function(a){a?(this.connectivityIcon.src="Images/successGreenDot.png",this.connectivityMessage.textContent=WebInspector.UIString("Online")):(this.connectivityIcon.src="Images/errorRedDot.png",this.connectivityMessage.textContent=WebInspector.UIString("Offline"))},_update:function(){this._model.requestApplicationCache(this._frameId,
this._updateCallback.bind(this))},_updateCallback:function(a){a&&a.manifestURL?(this._manifest=a.manifestURL,this._creationTime=a.creationTime,this._updateTime=a.updateTime,this._size=a.size,this._resources=a.resources,this._dataGrid||this._createDataGrid(),this._populateDataGrid(),this._dataGrid.autoSizeColumns(20,80),this._dataGrid.element.removeStyleClass("hidden"),this._emptyView.detach(),this.deleteButton.visible=!0):(delete this._manifest,delete this._creationTime,delete this._updateTime,delete this._size,
delete this._resources,this._emptyView.show(this.element),this.deleteButton.visible=!1,this._dataGrid&&this._dataGrid.element.addStyleClass("hidden"))},_createDataGrid:function(){var a=[{title:WebInspector.UIString("Resource"),sort:WebInspector.DataGrid.Order.Ascending,sortable:!0},{title:WebInspector.UIString("Type"),sortable:!0},{title:WebInspector.UIString("Size"),align:WebInspector.DataGrid.Align.Right,sortable:!0}];this._dataGrid=new WebInspector.DataGrid(a);this._dataGrid.show(this.element);
this._dataGrid.addEventListener(WebInspector.DataGrid.Events.SortingChanged,this._populateDataGrid,this)},_populateDataGrid:function(){function a(a,b,c){return e*(b[a]-c[a])}function b(a,b,c){return e*(b[a]+"").localeCompare(c[a]+"")}var c=this._dataGrid.selectedNode?this._dataGrid.selectedNode.resource:null,e=this._dataGrid.isSortOrderAscending()?1:-1,d;switch(parseInt(this._dataGrid.sortColumnIdentifier(),10)){case 0:d=b.bind(this,"name");break;case 1:d=b.bind(this,"type");break;case 2:d=a.bind(this,
"size");break;default:b.bind(this,"resource")}this._resources.sort(d);this._dataGrid.rootNode().removeChildren();var f;for(d=0;d<this._resources.length;++d){var g={},h=this._resources[d];g[0]=h.url;g[1]=h.type;g[2]=Number.bytesToString(h.size);g=new WebInspector.DataGridNode(g);g.resource=h;g.selectable=!0;this._dataGrid.rootNode().appendChild(g);h===c&&(f=g,f.selected=!0)}!f&&this._dataGrid.rootNode().children.length&&(this._dataGrid.rootNode().children[0].selected=!0)},_deleteButtonClicked:function(a){this._dataGrid&&
this._dataGrid.selectedNode&&this._deleteCallback(this._dataGrid.selectedNode)},_deleteCallback:function(a){},__proto__:WebInspector.View.prototype};
WebInspector.DOMStorageItemsView=function(a,b){WebInspector.View.call(this);this.domStorage=a;this.domStorageModel=b;this.element.addStyleClass("storage-view");this.element.addStyleClass("table");this.deleteButton=new WebInspector.StatusBarButton(WebInspector.UIString("Delete"),"delete-storage-status-bar-item");this.deleteButton.visible=!1;this.deleteButton.addEventListener("click",this._deleteButtonClicked,this);this.refreshButton=new WebInspector.StatusBarButton(WebInspector.UIString("Refresh"),
"refresh-storage-status-bar-item");this.refreshButton.addEventListener("click",this._refreshButtonClicked,this);this.domStorageModel.addEventListener(WebInspector.DOMStorageModel.Events.DOMStorageItemsCleared,this._domStorageItemsCleared,this);this.domStorageModel.addEventListener(WebInspector.DOMStorageModel.Events.DOMStorageItemRemoved,this._domStorageItemRemoved,this);this.domStorageModel.addEventListener(WebInspector.DOMStorageModel.Events.DOMStorageItemAdded,this._domStorageItemAdded,this);this.domStorageModel.addEventListener(WebInspector.DOMStorageModel.Events.DOMStorageItemUpdated,
this._domStorageItemUpdated,this)};
WebInspector.DOMStorageItemsView.prototype={statusBarItems:function(){return[this.refreshButton.element,this.deleteButton.element]},wasShown:function(){this._update()},willHide:function(){this.deleteButton.visible=!1},_domStorageItemsCleared:function(a){this.isShowing()&&(this._dataGrid.rootNode().removeChildren(),this._dataGrid.addCreationNode(!1),this.deleteButton.visible=!1,a.consume(!0))},_domStorageItemRemoved:function(a){if(this.isShowing()){var b=a.data,c=this._dataGrid.rootNode(),e=c.children;
a.consume(!0);for(a=0;a<e.length;++a){var d=e[a];if(d.data.key===b.key){c.removeChild(d);this.deleteButton.visible=1<e.length;break}}}},_domStorageItemAdded:function(a){if(this.isShowing()){var b=a.data,c=this._dataGrid.rootNode(),e=c.children;a.consume(!0);this.deleteButton.visible=!0;for(a=0;a<e.length;++a)if(e[a].data.key===b.key)return;b=new WebInspector.DataGridNode({key:b.key,value:b.newValue},!1);c.insertChild(b,e.length-1)}},_domStorageItemUpdated:function(a){if(this.isShowing()){var b=a.data,
c=this._dataGrid.rootNode(),e=c.children;a.consume(!0);a=!1;for(var d=0;d<e.length;++d){var f=e[d];if(f.data.key===b.key){if(a){c.removeChild(f);break}a=!0;f.data.value!==b.newValue&&(f.data.value=b.newValue,f.refresh(),f.select(),f.reveal());this.deleteButton.visible=!0}}}},_update:function(){this.detachChildViews();this.domStorage.getItems(this._showDOMStorageItems.bind(this))},_showDOMStorageItems:function(a,b){a||(this._dataGrid=this._dataGridForDOMStorageItems(b),this._dataGrid.show(this.element),
this._dataGrid.autoSizeColumns(10),this.deleteButton.visible=1<this._dataGrid.rootNode().children.length)},_dataGridForDOMStorageItems:function(a){for(var b=[{id:"key",title:WebInspector.UIString("Key"),editable:!0},{id:"value",title:WebInspector.UIString("Value"),editable:!0}],c=[],e=[],d=a.length,f=0;f<a.length;f++){var d=a[f][0],g=new WebInspector.DataGridNode({key:d,value:a[f][1]},!1);g.selectable=!0;c.push(g);e.push(d)}a=new WebInspector.DataGrid(b,this._editingCallback.bind(this),this._deleteCallback.bind(this));
d=c.length;for(f=0;f<d;++f)a.rootNode().appendChild(c[f]);a.addCreationNode(!1);0<d&&(c[0].selected=!0);return a},_deleteButtonClicked:function(a){this._dataGrid&&this._dataGrid.selectedNode&&(this._deleteCallback(this._dataGrid.selectedNode),this._dataGrid.changeNodeAfterDeletion())},_refreshButtonClicked:function(a){this._update()},_editingCallback:function(a,b,c,e){var d=this.domStorage;"key"===b?(c&&d.removeItem(c),d.setItem(e,a.data.value),this._removeDupes(a)):d.setItem(a.data.key,e)},_removeDupes:function(a){for(var b=
this._dataGrid.rootNode(),c=b.children,e=c.length-1;0<=e;--e){var d=c[e];d.data.key===a.data.key&&a!==d&&b.removeChild(d)}},_deleteCallback:function(a){a&&!a.isCreationNode&&this.domStorage&&this.domStorage.removeItem(a.data.key)},__proto__:WebInspector.View.prototype};
WebInspector.DatabaseQueryView=function(a){WebInspector.View.call(this);this.database=a;this.element.addStyleClass("storage-view");this.element.addStyleClass("query");this.element.addStyleClass("monospace");this.element.addEventListener("selectstart",this._selectStart.bind(this),!1);this._promptElement=document.createElement("div");this._promptElement.className="database-query-prompt";this._promptElement.appendChild(document.createElement("br"));this._promptElement.addEventListener("keydown",this._promptKeyDown.bind(this),
!0);this.element.appendChild(this._promptElement);this.prompt=new WebInspector.TextPromptWithHistory(this.completions.bind(this)," ");this.prompt.attach(this._promptElement);this.element.addEventListener("click",this._messagesClicked.bind(this),!0)};WebInspector.DatabaseQueryView.Events={SchemaUpdated:"SchemaUpdated"};
WebInspector.DatabaseQueryView.prototype={_messagesClicked:function(){!this.prompt.isCaretInsidePrompt()&&window.getSelection().isCollapsed&&this.prompt.moveCaretToEndOfPrompt()},completions:function(a,b,c,e){function d(a){for(var b=0;b<a.length;++b){var c=a[b].toLowerCase();c.length<g.length||c.startsWith(g)&&h.push(a[b])}}function f(a){d(a.map(function(a){return a+" "}));d("SELECT ;FROM ;WHERE ;LIMIT ;DELETE FROM ;CREATE ;DROP ;TABLE ;INDEX ;UPDATE ;INSERT INTO ;VALUES (".split(";"));e(h)}var g=
b.toString().toLowerCase();if(g.length||c){var h=[];this.database.getTableNames(f)}},_selectStart:function(a){this._selectionTimeout&&clearTimeout(this._selectionTimeout);this.prompt.clearAutoComplete();this._selectionTimeout=setTimeout(function(){delete this._selectionTimeout;!this.prompt.isCaretInsidePrompt()&&window.getSelection().isCollapsed&&this.prompt.moveCaretToEndOfPrompt();this.prompt.autoCompleteSoon()}.bind(this),100)},_promptKeyDown:function(a){isEnterKey(a)&&this._enterKeyPressed(a)},
_enterKeyPressed:function(a){a.consume(!0);this.prompt.clearAutoComplete(!0);a=this.prompt.text;a.length&&(this.prompt.pushHistoryItem(a),this.prompt.text="",this.database.executeSql(a,this._queryFinished.bind(this,a),this._queryError.bind(this,a)))},_queryFinished:function(a,b,c){b=WebInspector.DataGrid.createSortableDataGrid(b,c);a=a.trim();b&&(b.renderInline(),this._appendViewQueryResult(a,b),b.autoSizeColumns(5));(a.match(/^create /i)||a.match(/^drop table /i))&&this.dispatchEventToListeners(WebInspector.DatabaseQueryView.Events.SchemaUpdated,
this.database)},_queryError:function(a,b){this._appendErrorQueryResult(a,b)},_appendViewQueryResult:function(a,b){var c=this._appendQueryResult(a);b.show(c);this._promptElement.scrollIntoView(!1)},_appendErrorQueryResult:function(a,b){var c=this._appendQueryResult(a);c.addStyleClass("error");c.textContent=b;this._promptElement.scrollIntoView(!1)},_appendQueryResult:function(a){var b=document.createElement("div");b.className="database-user-query";this.element.insertBefore(b,this.prompt.proxyElement);
var c=document.createElement("span");c.className="database-query-text";c.textContent=a;b.appendChild(c);a=document.createElement("div");a.className="database-query-result";b.appendChild(a);return a},__proto__:WebInspector.View.prototype};
WebInspector.DatabaseTableView=function(a,b){WebInspector.View.call(this);this.database=a;this.tableName=b;this.element.addStyleClass("storage-view");this.element.addStyleClass("table");this.refreshButton=new WebInspector.StatusBarButton(WebInspector.UIString("Refresh"),"refresh-storage-status-bar-item");this.refreshButton.addEventListener("click",this._refreshButtonClicked,this)};
WebInspector.DatabaseTableView.prototype={wasShown:function(){this.update()},statusBarItems:function(){return[this.refreshButton.element]},_escapeTableName:function(a){return a.replace(/\"/g,'""')},update:function(){this.database.executeSql('SELECT * FROM "'+this._escapeTableName(this.tableName)+'"',this._queryFinished.bind(this),this._queryError.bind(this))},_queryFinished:function(a,b){this.detachChildViews();this.element.removeChildren();var c=WebInspector.DataGrid.createSortableDataGrid(a,b);
c?(c.show(this.element),c.autoSizeColumns(5)):(this._emptyView=new WebInspector.EmptyView(WebInspector.UIString("The \u201c%s\u201d\ntable is empty.",this.tableName)),this._emptyView.show(this.element))},_queryError:function(a){this.detachChildViews();this.element.removeChildren();a=document.createElement("div");a.className="storage-table-error";a.textContent=WebInspector.UIString("An error occurred trying to\nread the \u201c%s\u201d table.",this.tableName);this.element.appendChild(a)},_refreshButtonClicked:function(a){this.update()},
__proto__:WebInspector.View.prototype};
WebInspector.DirectoryContentView=function(){var a=WebInspector.DirectoryContentView.columnIndexes,a=[{id:a.Name,title:WebInspector.UIString("Name"),sortable:!0,sort:WebInspector.DataGrid.Order.Ascending,width:"20%"},{id:a.URL,title:WebInspector.UIString("URL"),sortable:!0,width:"20%"},{id:a.Type,title:WebInspector.UIString("Type"),sortable:!0,width:"15%"},{id:a.Size,title:WebInspector.UIString("Size"),sortable:!0,width:"10%"},{id:a.ModificationTime,title:WebInspector.UIString("Modification Time"),sortable:!0,
width:"25%"}];WebInspector.DataGrid.call(this,a);this.addEventListener(WebInspector.DataGrid.Events.SortingChanged,this._sort,this)};WebInspector.DirectoryContentView.columnIndexes={Name:"0",URL:"1",Type:"2",Size:"3",ModificationTime:"4"};
WebInspector.DirectoryContentView.prototype={showEntries:function(a){this.rootNode().removeChildren();for(var b=0;b<a.length;++b)this.rootNode().appendChild(new WebInspector.DirectoryContentView.Node(a[b]))},_sort:function(){var a=this.sortColumnIdentifier();this.sortNodes(WebInspector.DirectoryContentView.Node.comparator(a,!this.isSortOrderAscending()),!1)},__proto__:WebInspector.DataGrid.prototype};
WebInspector.DirectoryContentView.Node=function(a){var b=WebInspector.DirectoryContentView.columnIndexes,c={};c[b.Name]=a.name;c[b.URL]=a.url;c[b.Type]=a.isDirectory?WebInspector.UIString("Directory"):a.mimeType;c[b.Size]="";c[b.ModificationTime]="";WebInspector.DataGridNode.call(this,c);this._entry=a;this._metadata=null;this._entry.requestMetadata(this._metadataReceived.bind(this))};
WebInspector.DirectoryContentView.Node.comparator=function(a,b){function c(a,b){return a._entry.isDirectory!=b._entry.isDirectory?b._entry.isDirectory?1:-1:0}function e(a,b){return d*a._entry.name.compareTo(b._entry.name)}var d=b?-1:1,f=WebInspector.DirectoryContentView.columnIndexes;switch(a){case f.Name:case f.URL:return function(a,b){return c(a,b)||e(a,b)};case f.Type:return function(a,b){return c(a,b)||d*(a._entry.mimeType||"").compareTo(b._entry.mimeType||"")||e(a,b)};case f.Size:return function(a,
b){return c(a,b)||d*((a._metadata?a._metadata.size:0)-(b._metadata?b._metadata.size:0))||e(a,b)};case f.ModificationTime:return function(a,b){return c(a,b)||d*((a._metadata?a._metadata.modificationTime:0)-(b._metadata?b._metadata.modificationTime:0))||e(a,b)}}};
WebInspector.DirectoryContentView.Node.prototype={_metadataReceived:function(a,b){var c=WebInspector.DirectoryContentView.columnIndexes;if(0===a){this._metadata=b;var e=this.data;e[c.Size]=this._entry.isDirectory?WebInspector.UIString("-"):Number.bytesToString(b.size);e[c.ModificationTime]=(new Date(b.modificationTime)).toGMTString();this.data=e}},__proto__:WebInspector.DataGridNode.prototype};
WebInspector.IDBDatabaseView=function(a){WebInspector.View.call(this);this.registerRequiredCSS("indexedDBViews.css");this.element.addStyleClass("fill");this.element.addStyleClass("indexed-db-database-view");this._headersListElement=this.element.createChild("ol","outline-disclosure");this._headersTreeOutline=new TreeOutline(this._headersListElement);this._headersTreeOutline.expandTreeElementsWhenArrowing=!0;this._securityOriginTreeElement=new TreeElement("",null,!1);this._securityOriginTreeElement.selectable=
!1;this._headersTreeOutline.appendChild(this._securityOriginTreeElement);this._nameTreeElement=new TreeElement("",null,!1);this._nameTreeElement.selectable=!1;this._headersTreeOutline.appendChild(this._nameTreeElement);this._intVersionTreeElement=new TreeElement("",null,!1);this._intVersionTreeElement.selectable=!1;this._headersTreeOutline.appendChild(this._intVersionTreeElement);this._stringVersionTreeElement=new TreeElement("",null,!1);this._stringVersionTreeElement.selectable=!1;this._headersTreeOutline.appendChild(this._stringVersionTreeElement);
this.update(a)};
WebInspector.IDBDatabaseView.prototype={_formatHeader:function(a,b){var c=document.createDocumentFragment();c.createChild("div","attribute-name").textContent=a+":";c.createChild("div","attribute-value source-code").textContent=b;return c},_refreshDatabase:function(){this._securityOriginTreeElement.title=this._formatHeader(WebInspector.UIString("Security origin"),this._database.databaseId.securityOrigin);this._nameTreeElement.title=this._formatHeader(WebInspector.UIString("Name"),this._database.databaseId.name);this._stringVersionTreeElement.title=
this._formatHeader(WebInspector.UIString("String Version"),this._database.version);this._intVersionTreeElement.title=this._formatHeader(WebInspector.UIString("Integer Version"),this._database.intVersion)},update:function(a){this._database=a;this._refreshDatabase()},__proto__:WebInspector.View.prototype};
WebInspector.IDBDataView=function(a,b,c,e){WebInspector.View.call(this);this.registerRequiredCSS("indexedDBViews.css");this._model=a;this._databaseId=b;this._isIndex=!!e;this.element.addStyleClass("indexed-db-data-view");a=this._createEditorToolbar();this.element.appendChild(a);this._dataGridContainer=this.element.createChild("div","fill");this._dataGridContainer.addStyleClass("data-grid-container");this._refreshButton=new WebInspector.StatusBarButton(WebInspector.UIString("Refresh"),"refresh-storage-status-bar-item");
this._refreshButton.addEventListener("click",this._refreshButtonClicked,this);this._clearButton=new WebInspector.StatusBarButton(WebInspector.UIString("Clear object store"),"clear-storage-status-bar-item");this._clearButton.addEventListener("click",this._clearButtonClicked,this);this._pageSize=50;this._skipCount=0;this.update(c,e);this._entries=[]};
WebInspector.IDBDataView.prototype={_createDataGrid:function(){var a=this._isIndex?this._index.keyPath:this._objectStore.keyPath,b=[];b.push({id:"number",title:WebInspector.UIString("#"),width:"50px"});b.push({id:"key",titleDOMFragment:this._keyColumnHeaderFragment(WebInspector.UIString("Key"),a)});this._isIndex&&b.push({id:"primaryKey",titleDOMFragment:this._keyColumnHeaderFragment(WebInspector.UIString("Primary key"),this._objectStore.keyPath)});b.push({id:"value",title:WebInspector.UIString("Value")});
return new WebInspector.DataGrid(b)},_keyColumnHeaderFragment:function(a,b){var c=document.createDocumentFragment();c.appendChild(document.createTextNode(a));if(null===b)return c;c.appendChild(document.createTextNode(" ("+WebInspector.UIString("Key path: ")));if(b instanceof Array){c.appendChild(document.createTextNode("["));for(var e=0;e<b.length;++e)0!=e&&c.appendChild(document.createTextNode(", ")),c.appendChild(this._keyPathStringFragment(b[e]));c.appendChild(document.createTextNode("]"))}else c.appendChild(this._keyPathStringFragment(b));
c.appendChild(document.createTextNode(")"));return c},_keyPathStringFragment:function(a){var b=document.createDocumentFragment();b.appendChild(document.createTextNode('"'));b.createChild("span","source-code console-formatted-string").textContent=a;b.appendChild(document.createTextNode('"'));return b},_createEditorToolbar:function(){var a=document.createElement("div");a.addStyleClass("status-bar");a.addStyleClass("data-view-toolbar");this._pageBackButton=a.createChild("button","back-button");this._pageBackButton.addStyleClass("status-bar-item");
this._pageBackButton.title=WebInspector.UIString("Show previous page.");this._pageBackButton.disabled=!0;this._pageBackButton.appendChild(document.createElement("img"));this._pageBackButton.addEventListener("click",this._pageBackButtonClicked.bind(this),!1);a.appendChild(this._pageBackButton);this._pageForwardButton=a.createChild("button","forward-button");this._pageForwardButton.addStyleClass("status-bar-item");this._pageForwardButton.title=WebInspector.UIString("Show next page.");this._pageForwardButton.disabled=
!0;this._pageForwardButton.appendChild(document.createElement("img"));this._pageForwardButton.addEventListener("click",this._pageForwardButtonClicked.bind(this),!1);a.appendChild(this._pageForwardButton);this._keyInputElement=a.createChild("input","key-input");this._keyInputElement.placeholder=WebInspector.UIString("Start from key");this._keyInputElement.addEventListener("paste",this._keyInputChanged.bind(this));this._keyInputElement.addEventListener("cut",this._keyInputChanged.bind(this));this._keyInputElement.addEventListener("keypress",
this._keyInputChanged.bind(this));this._keyInputElement.addEventListener("keydown",this._keyInputChanged.bind(this));return a},_pageBackButtonClicked:function(){this._skipCount=Math.max(0,this._skipCount-this._pageSize);this._updateData(!1)},_pageForwardButtonClicked:function(){this._skipCount+=this._pageSize;this._updateData(!1)},_keyInputChanged:function(){window.setTimeout(this._updateData.bind(this,!1),0)},update:function(a,b){this._objectStore=a;this._index=b;this._dataGrid&&this._dataGrid.detach();
this._dataGrid=this._createDataGrid();this._dataGrid.show(this._dataGridContainer);this._skipCount=0;this._updateData(!0)},_parseKey:function(a){var b;try{b=JSON.parse(a)}catch(c){b=a}return b},_stringifyKey:function(a){return"string"===typeof a?a:JSON.stringify(a)},_updateData:function(a){function b(a,b){this._refreshButton.setEnabled(!0);this.clear();this._entries=a;for(var c=0;c<a.length;++c){var e={};e.number=c+d;e.key=a[c].key;e.primaryKey=a[c].primaryKey;e.value=a[c].value;JSON.stringify(this._isIndex?
a[c].primaryKey:a[c].key);e=new WebInspector.IDBDataGridNode(e);this._dataGrid.rootNode().appendChild(e)}this._pageBackButton.disabled=0===d;this._pageForwardButton.disabled=!b}var c=this._parseKey(this._keyInputElement.value),e=this._pageSize,d=this._skipCount;this._refreshButton.setEnabled(!1);this._clearButton.setEnabled(!this._isIndex);if(a||this._lastKey!==c||this._lastPageSize!==e||this._lastSkipCount!==d){if(this._lastKey!==c||this._lastPageSize!==e)this._skipCount=d=0;this._lastKey=c;this._lastPageSize=
e;this._lastSkipCount=d;a=c?window.webkitIDBKeyRange.lowerBound(c):null;this._isIndex?this._model.loadIndexData(this._databaseId,this._objectStore.name,this._index.name,a,d,e,b.bind(this)):this._model.loadObjectStoreData(this._databaseId,this._objectStore.name,a,d,e,b.bind(this))}},_refreshButtonClicked:function(a){this._updateData(!0)},_clearButtonClicked:function(a){this._clearButton.setEnabled(!1);this._model.clearObjectStore(this._databaseId,this._objectStore.name,function(){this._clearButton.setEnabled(!0);
this._updateData(!0)}.bind(this))},statusBarItems:function(){return[this._refreshButton.element,this._clearButton.element]},clear:function(){this._dataGrid.rootNode().removeChildren();for(var a=0;a<this._entries.length;++a)this._entries[a].key.release(),this._entries[a].primaryKey.release(),this._entries[a].value.release();this._entries=[]},__proto__:WebInspector.View.prototype};WebInspector.IDBDataGridNode=function(a){WebInspector.DataGridNode.call(this,a,!1);this.selectable=!1};
WebInspector.IDBDataGridNode.prototype={createCell:function(a){var b=WebInspector.DataGridNode.prototype.createCell.call(this,a),c=this.data[a];switch(a){case "value":case "key":case "primaryKey":b.removeChildren(),this._formatValue(b,c)}return b},_formatValue:function(a,b){var c=b.subtype||b.type,e=a.createChild("div","source-code console-formatted-"+c);switch(c){case "object":case "array":c=new WebInspector.ObjectPropertiesSection(b,b.description);c.editable=!1;c.skipProto=!0;e.appendChild(c.element);
break;case "string":e.addStyleClass("primitive-value");e.appendChild(document.createTextNode('"'+b.description+'"'));break;default:e.addStyleClass("primitive-value"),e.appendChild(document.createTextNode(b.description))}},__proto__:WebInspector.DataGridNode.prototype};WebInspector.FileContentView=function(a){WebInspector.View.call(this);this._innerView=null;this._file=a;this._content=null};
WebInspector.FileContentView.prototype={wasShown:function(){this._innerView||(this._innerView=this._file.isTextFile?new WebInspector.EmptyView(""):new WebInspector.EmptyView(WebInspector.UIString("Binary File")),this.refresh());this._innerView.show(this.element)},_metadataReceived:function(a,b){if(!a&&b)if(this._content){if(this._content.updateMetadata(b)){var c=this._innerView;this._content.requestContent(c.setContent.bind(c))}}else this._innerView.detach(),this._content=new WebInspector.FileContentView.FileContentProvider(this._file,
b),this._innerView=new WebInspector.SourceFrame(this._content),this._innerView.show(this.element)},refresh:function(){this._innerView&&this._file.isTextFile&&this._file.requestMetadata(this._metadataReceived.bind(this))},__proto__:WebInspector.View.prototype};WebInspector.FileContentView.FileContentProvider=function(a,b){this._file=a;this._metadata=b};
WebInspector.FileContentView.FileContentProvider.prototype={contentURL:function(){return this._file.url},contentType:function(){return this._file.resourceType},requestContent:function(a){this._file.requestFileContent(!0,0,this._metadata.size,this._charset||"",this._fileContentReceived.bind(this,a))},_fileContentReceived:function(a,b,c,e,d){b||!c?a(null,!1,""):(this._charset=d,a(c,!1,this.contentType().canonicalMimeType()))},searchInContent:function(a,b,c,e){setTimeout(e.bind(null,[]),0)},updateMetadata:function(a){if(this._metadata.modificationTime>=
a.modificationTime)return!1;this._metadata=a.modificationTime;return!0}};
WebInspector.FileSystemView=function(a){WebInspector.SidebarView.call(this,WebInspector.SidebarView.SidebarPosition.Start,"FileSystemViewSidebarWidth");this.element.addStyleClass("file-system-view");this.element.addStyleClass("storage-view");var b=this.element.createChild("ol","filesystem-directory-tree");this._directoryTree=new TreeOutline(b);this.sidebarElement.appendChild(b);this.sidebarElement.addStyleClass("outline-disclosure");this.sidebarElement.addStyleClass("sidebar");a=new WebInspector.FileSystemView.EntryTreeElement(this,
a.root);a.expanded=!0;this._directoryTree.appendChild(a);this._visibleView=null;this._refreshButton=new WebInspector.StatusBarButton(WebInspector.UIString("Refresh"),"refresh-storage-status-bar-item");this._refreshButton.visible=!0;this._refreshButton.addEventListener("click",this._refresh,this);this._deleteButton=new WebInspector.StatusBarButton(WebInspector.UIString("Delete"),"delete-storage-status-bar-item");this._deleteButton.visible=!0;this._deleteButton.addEventListener("click",this._confirmDelete,
this)};
WebInspector.FileSystemView.prototype={statusBarItems:function(){return[this._refreshButton.element,this._deleteButton.element]},get visibleView(){return this._visibleView},showView:function(a){this._visibleView!==a&&(this._visibleView&&this._visibleView.detach(),this._visibleView=a,a.show(this.mainElement))},_refresh:function(){this._directoryTree.children[0].refresh()},_confirmDelete:function(){confirm(WebInspector.UIString("Are you sure you want to delete the selected entry?"))&&this._delete()},_delete:function(){this._directoryTree.selectedTreeElement.deleteEntry()},
__proto__:WebInspector.SidebarView.prototype};WebInspector.FileSystemView.EntryTreeElement=function(a,b){TreeElement.call(this,b.name,null,b.isDirectory);this._entry=b;this._fileSystemView=a};
WebInspector.FileSystemView.EntryTreeElement.prototype={onattach:function(){var a=this.listItemElement.createChild("div","selection");this.listItemElement.insertBefore(a,this.listItemElement.firstChild)},onselect:function(){this._view||(this._view=this._entry.isDirectory?new WebInspector.DirectoryContentView:new WebInspector.FileContentView(this._entry));this._fileSystemView.showView(this._view);this.refresh()},onpopulate:function(){this.refresh()},_directoryContentReceived:function(a,b){if(a===FileError.NOT_FOUND_ERR)this.parent!==
this.treeOutline&&this.parent.refresh();else if(0===a&&b){b.sort(WebInspector.FileSystemModel.Entry.compare);this._view&&this._view.showEntries(b);for(var c=this.children.slice(0),e=0,d=0,f=0;e<b.length&&d<c.length;){var g=b[e],h=c[d],k=g.name.compareTo(h._entry.name);0===k?(h._entry.isDirectory?h.shouldRefreshChildren=!0:h.refresh(),++e,++d,++f):0>k?(this.insertChild(new WebInspector.FileSystemView.EntryTreeElement(this._fileSystemView,g),f),++e,++f):(this.removeChildAtIndex(f),++d)}for(;e<b.length;++e)this.appendChild(new WebInspector.FileSystemView.EntryTreeElement(this._fileSystemView,
b[e]));for(;d<c.length;++d)this.removeChild(c[d])}else console.error("Failed to read directory: "+a)},refresh:function(){this._entry.isDirectory?this._entry.requestDirectoryContent(this._directoryContentReceived.bind(this)):this._view&&this._view===this._fileSystemView.visibleView&&this._view.refresh()},deleteEntry:function(){this._entry.deleteEntry(this._deletionCompleted.bind(this))},_deletionCompleted:function(){this._entry!=this._entry.fileSystem.root&&this.parent.refresh()},__proto__:TreeElement.prototype};
WebInspector.ResourcesPanel=function(a){WebInspector.Panel.call(this,"resources");this.registerRequiredCSS("resourcesPanel.css");WebInspector.settings.resourcesLastSelectedItem=WebInspector.settings.createSetting("resourcesLastSelectedItem",{});this.createSidebarViewWithTree();this.sidebarElement.addStyleClass("outline-disclosure");this.sidebarElement.addStyleClass("filter-all");this.sidebarElement.addStyleClass("children");this.sidebarElement.addStyleClass("small");this.sidebarTreeElement.removeStyleClass("sidebar-tree");
this.resourcesListTreeElement=new WebInspector.StorageCategoryTreeElement(this,WebInspector.UIString("Frames"),"Frames",["frame-storage-tree-item"]);this.sidebarTree.appendChild(this.resourcesListTreeElement);this.databasesListTreeElement=new WebInspector.StorageCategoryTreeElement(this,WebInspector.UIString("Web SQL"),"Databases",["database-storage-tree-item"]);this.sidebarTree.appendChild(this.databasesListTreeElement);this.indexedDBListTreeElement=new WebInspector.IndexedDBTreeElement(this);this.sidebarTree.appendChild(this.indexedDBListTreeElement);
this.localStorageListTreeElement=new WebInspector.StorageCategoryTreeElement(this,WebInspector.UIString("Local Storage"),"LocalStorage",["domstorage-storage-tree-item","local-storage"]);this.sidebarTree.appendChild(this.localStorageListTreeElement);this.sessionStorageListTreeElement=new WebInspector.StorageCategoryTreeElement(this,WebInspector.UIString("Session Storage"),"SessionStorage",["domstorage-storage-tree-item","session-storage"]);this.sidebarTree.appendChild(this.sessionStorageListTreeElement);
this.cookieListTreeElement=new WebInspector.StorageCategoryTreeElement(this,WebInspector.UIString("Cookies"),"Cookies",["cookie-storage-tree-item"]);this.sidebarTree.appendChild(this.cookieListTreeElement);this.applicationCacheListTreeElement=new WebInspector.StorageCategoryTreeElement(this,WebInspector.UIString("Application Cache"),"ApplicationCache",["application-cache-storage-tree-item"]);this.sidebarTree.appendChild(this.applicationCacheListTreeElement);Preferences.exposeFileSystemInspection&&
WebInspector.experimentsSettings.fileSystemInspection.isEnabled()&&(this.fileSystemListTreeElement=new WebInspector.FileSystemListTreeElement(this),this.sidebarTree.appendChild(this.fileSystemListTreeElement));this.storageViews=this.splitView.mainElement;this.storageViews.addStyleClass("diff-container");this.storageViewStatusBarItemsContainer=document.createElement("div");this.storageViewStatusBarItemsContainer.className="status-bar-items";this._databaseTableViews=new Map;this._databaseQueryViews=
new Map;this._databaseTreeElements=new Map;this._domStorageViews=new Map;this._domStorageTreeElements=new Map;this._cookieViews={};this._origins={};this._domains={};this.sidebarElement.addEventListener("mousemove",this._onmousemove.bind(this),!1);this.sidebarElement.addEventListener("mouseout",this._onmouseout.bind(this),!1);WebInspector.GoToLineDialog.install(this,function(){return this.visibleView}.bind(this));WebInspector.resourceTreeModel.cachedResourcesLoaded()&&this._cachedResourcesLoaded();
WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.OnLoad,this._onLoadEventFired,this);WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.CachedResourcesLoaded,this._cachedResourcesLoaded,this);WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.WillLoadCachedResources,this._resetWithFrames,this);WebInspector.databaseModel.databases().forEach(this._addDatabase.bind(this));WebInspector.databaseModel.addEventListener(WebInspector.DatabaseModel.Events.DatabaseAdded,
this._databaseAdded,this)};
WebInspector.ResourcesPanel.prototype={statusBarItems:function(){return[this.storageViewStatusBarItemsContainer]},wasShown:function(){WebInspector.Panel.prototype.wasShown.call(this);this._initialize()},_initialize:function(){!this._initialized&&this.isShowing()&&this._cachedResourcesWereLoaded&&(this._populateResourceTree(),this._populateDOMStorageTree(),this._populateApplicationCacheTree(),this._initDefaultSelection(),this._initialized=!0)},_onLoadEventFired:function(){this._initDefaultSelection()},_initDefaultSelection:function(){if(this._initialized){var a=
WebInspector.settings.resourcesLastSelectedItem.get();if(a)for(var b=this.sidebarTree.children[0];b;b=b.traverseNextTreeElement(!1,this.sidebarTree,!0))if(b.itemURL===a){b.revealAndSelect(!0);return}(a=WebInspector.inspectedPageURL&&this.resourcesListTreeElement&&this.resourcesListTreeElement.expanded&&WebInspector.resourceTreeModel.resourceForURL(WebInspector.inspectedPageURL))&&this.showResource(a)}},_resetWithFrames:function(){this.resourcesListTreeElement.removeChildren();this._treeElementForFrameId=
{};this._reset()},_reset:function(){this._origins={};this._domains={};for(var a=this._databaseQueryViews.values(),b=0;b<a.length;++b)a[b].removeEventListener(WebInspector.DatabaseQueryView.Events.SchemaUpdated,this._updateDatabaseTables,this);this._databaseTableViews.clear();this._databaseQueryViews.clear();this._databaseTreeElements.clear();this._domStorageViews.clear();this._domStorageTreeElements.clear();this._cookieViews={};this.databasesListTreeElement.removeChildren();this.localStorageListTreeElement.removeChildren();
this.sessionStorageListTreeElement.removeChildren();this.cookieListTreeElement.removeChildren();!this.visibleView||this.visibleView instanceof WebInspector.StorageCategoryView||this.visibleView.detach();this.storageViewStatusBarItemsContainer.removeChildren();this.sidebarTree.selectedTreeElement&&this.sidebarTree.selectedTreeElement.deselect()},_populateResourceTree:function(){function a(b){this._frameAdded({data:b});for(var c=0;c<b.childFrames.length;++c)a.call(this,b.childFrames[c]);b=b.resources();
for(c=0;c<b.length;++c)this._resourceAdded({data:b[c]})}this._treeElementForFrameId={};WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.FrameAdded,this._frameAdded,this);WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.FrameNavigated,this._frameNavigated,this);WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.FrameDetached,this._frameDetached,this);WebInspector.resourceTreeModel.addEventListener(WebInspector.ResourceTreeModel.EventTypes.ResourceAdded,
this._resourceAdded,this);a.call(this,WebInspector.resourceTreeModel.mainFrame)},_frameAdded:function(a){a=a.data;var b=a.parentFrame;if(b=b?this._treeElementForFrameId[b.id]:this.resourcesListTreeElement){var c=new WebInspector.FrameTreeElement(this,a);this._treeElementForFrameId[a.id]=c;b.appendChild(c)}else console.warn("No frame to route "+a.url+" to.")},_frameDetached:function(a){a=a.data;var b=this._treeElementForFrameId[a.id];b&&(delete this._treeElementForFrameId[a.id],b.parent&&b.parent.removeChild(b))},
_resourceAdded:function(a){a=a.data;var b=a.frameId;301<=a.statusCode&&303>=a.statusCode||(b=this._treeElementForFrameId[b])&&b.appendResource(a)},_frameNavigated:function(a){a=a.data;a.parentFrame||this._reset();var b=a.id,c=this._treeElementForFrameId[b];c&&c.frameNavigated(a);(b=this._applicationCacheFrameElements[b])&&b.frameNavigated(a)},_cachedResourcesLoaded:function(){this._cachedResourcesWereLoaded=!0;this._initialize()},_databaseAdded:function(a){this._addDatabase(a.data)},_addDatabase:function(a){var b=
new WebInspector.DatabaseTreeElement(this,a);this._databaseTreeElements.put(a,b);this.databasesListTreeElement.appendChild(b)},addDocumentURL:function(a){if(a=a.asParsedURL())a=a.host,this._domains[a]||(this._domains[a]=!0,a=new WebInspector.CookieTreeElement(this,a),this.cookieListTreeElement.appendChild(a))},_domStorageAdded:function(a){this._addDOMStorage(a.data)},_addDOMStorage:function(a){console.assert(!this._domStorageTreeElements.get(a));var b=new WebInspector.DOMStorageTreeElement(this,a,
a.isLocalStorage?"local-storage":"session-storage");this._domStorageTreeElements.put(a,b);a.isLocalStorage?this.localStorageListTreeElement.appendChild(b):this.sessionStorageListTreeElement.appendChild(b)},_domStorageRemoved:function(a){this._removeDOMStorage(a.data)},_removeDOMStorage:function(a){var b=this._domStorageTreeElements.get(a);if(b){var c=b.selected,e=b.parent;e.removeChild(b);c&&e.select();this._domStorageTreeElements.remove(b);this._domStorageViews.remove(a)}},selectDatabase:function(a){a&&
(this._showDatabase(a),this._databaseTreeElements.get(a).select())},selectDOMStorage:function(a){a&&(this._showDOMStorage(a),this._domStorageTreeElements.get(a).select())},canShowAnchorLocation:function(a){return!!WebInspector.resourceForURL(a.href)},showAnchorLocation:function(a){var b=WebInspector.resourceForURL(a.href);this.showResource(b,a.lineNumber)},showResource:function(a,b){var c=this._findTreeElementForResource(a);c&&c.revealAndSelect();"number"===typeof b&&(c=this._resourceViewForResource(a),
c.canHighlightLine()&&c.highlightLine(b));return!0},_showResourceView:function(a){(a=this._resourceViewForResource(a))?(a.searchCanceled&&a.searchCanceled(),this._innerShowView(a)):this.visibleView.detach()},_resourceViewForResource:function(a){return WebInspector.ResourceView.hasTextContent(a)?(a=this._findTreeElementForResource(a))?a.sourceView():null:WebInspector.ResourceView.nonSourceViewForResource(a)},_showDatabase:function(a,b){if(a){var c;if(b){var e=this._databaseTableViews.get(a);e||(e=
{},this._databaseTableViews.put(a,e));c=e[b];c||(c=new WebInspector.DatabaseTableView(a,b),e[b]=c)}else c=this._databaseQueryViews.get(a),c||(c=new WebInspector.DatabaseQueryView(a),this._databaseQueryViews.put(a,c),c.addEventListener(WebInspector.DatabaseQueryView.Events.SchemaUpdated,this._updateDatabaseTables,this));this._innerShowView(c)}},showIndexedDB:function(a){this._innerShowView(a)},_showDOMStorage:function(a){if(a){var b;b=this._domStorageViews.get(a);b||(b=new WebInspector.DOMStorageItemsView(a,
WebInspector.domStorageModel),this._domStorageViews.put(a,b));this._innerShowView(b)}},showCookies:function(a,b){var c=this._cookieViews[b];c||(c=new WebInspector.CookieItemsView(a,b),this._cookieViews[b]=c);this._innerShowView(c)},clearCookies:function(a){this._cookieViews[a].clear()},showApplicationCache:function(a){this._applicationCacheViews[a]||(this._applicationCacheViews[a]=new WebInspector.ApplicationCacheItemsView(this._applicationCacheModel,a));this._innerShowView(this._applicationCacheViews[a])},
showFileSystem:function(a){this._innerShowView(a)},showCategoryView:function(a){this._categoryView||(this._categoryView=new WebInspector.StorageCategoryView);this._categoryView.setText(a);this._innerShowView(this._categoryView)},_innerShowView:function(a){if(this.visibleView!==a){this.visibleView&&this.visibleView.detach();a.show(this.storageViews);this.visibleView=a;this.storageViewStatusBarItemsContainer.removeChildren();a=a.statusBarItems()||[];for(var b=0;b<a.length;++b)this.storageViewStatusBarItemsContainer.appendChild(a[b])}},
closeVisibleView:function(){this.visibleView&&(this.visibleView.detach(),delete this.visibleView)},_updateDatabaseTables:function(a){function b(a){for(var b=a.length,c=0;c<b;++c)d[a[c]]=!0;for(var l in e)l in d||(f.visibleView===e[l]&&f.closeVisibleView(),delete e[l])}if(a=a.data){var c=this._databaseTreeElements.get(a);if(c){c.shouldRefreshChildren=!0;var e=this._databaseTableViews.get(a);if(e){var d={},f=this;a.getTableNames(b)}}}},_populateDOMStorageTree:function(){WebInspector.domStorageModel.storages().forEach(this._addDOMStorage.bind(this));
WebInspector.domStorageModel.addEventListener(WebInspector.DOMStorageModel.Events.DOMStorageAdded,this._domStorageAdded,this);WebInspector.domStorageModel.addEventListener(WebInspector.DOMStorageModel.Events.DOMStorageRemoved,this._domStorageRemoved,this)},_populateApplicationCacheTree:function(){this._applicationCacheModel=new WebInspector.ApplicationCacheModel;this._applicationCacheViews={};this._applicationCacheFrameElements={};this._applicationCacheManifestElements={};this._applicationCacheModel.addEventListener(WebInspector.ApplicationCacheModel.EventTypes.FrameManifestAdded,
this._applicationCacheFrameManifestAdded,this);this._applicationCacheModel.addEventListener(WebInspector.ApplicationCacheModel.EventTypes.FrameManifestRemoved,this._applicationCacheFrameManifestRemoved,this);this._applicationCacheModel.addEventListener(WebInspector.ApplicationCacheModel.EventTypes.FrameManifestStatusUpdated,this._applicationCacheFrameManifestStatusChanged,this);this._applicationCacheModel.addEventListener(WebInspector.ApplicationCacheModel.EventTypes.NetworkStateChanged,this._applicationCacheNetworkStateChanged,
this)},_applicationCacheFrameManifestAdded:function(a){a=a.data;var b=this._applicationCacheModel.frameManifestURL(a);this._applicationCacheModel.frameManifestStatus(a);var c=this._applicationCacheManifestElements[b];c||(c=new WebInspector.ApplicationCacheManifestTreeElement(this,b),this.applicationCacheListTreeElement.appendChild(c),this._applicationCacheManifestElements[b]=c);b=new WebInspector.ApplicationCacheFrameTreeElement(this,a,b);c.appendChild(b);c.expand();this._applicationCacheFrameElements[a]=
b},_applicationCacheFrameManifestRemoved:function(a){var b=a.data,c=this._applicationCacheFrameElements[b];c&&(a=c.manifestURL,delete this._applicationCacheFrameElements[b],delete this._applicationCacheViews[b],c.parent.removeChild(c),b=this._applicationCacheManifestElements[a],0===b.children.length&&(delete this._applicationCacheManifestElements[a],b.parent.removeChild(b)))},_applicationCacheFrameManifestStatusChanged:function(a){a=a.data;var b=this._applicationCacheModel.frameManifestStatus(a);
this._applicationCacheViews[a]&&this._applicationCacheViews[a].updateStatus(b)},_applicationCacheNetworkStateChanged:function(a){a=a.data;for(var b in this._applicationCacheViews)this._applicationCacheViews[b].updateNetworkState(a)},sidebarResized:function(a){this.storageViewStatusBarItemsContainer.style.left=a.data+"px"},performSearch:function(a){this._resetSearchResults();a=WebInspector.SourceFrame.createSearchRegex(a);var b=0;PageAgent.searchInResources(a.source,!a.ignoreCase,!0,function(a,e){if(!a)for(var d=
0;d<e.length;d++){var f=e[d],g=this._treeElementForFrameId[f.frameId];g&&(g=g.resourceByURL(f.url))&&(this._findTreeElementForResource(g).searchMatchesFound(f.matchesCount),b+=f.matchesCount)}WebInspector.searchController.updateSearchMatchesCount(b,this);this._searchController=new WebInspector.ResourcesSearchController(this.resourcesListTreeElement,b);this.sidebarTree.selectedTreeElement&&this.sidebarTree.selectedTreeElement.searchMatchesCount&&this.jumpToNextSearchResult()}.bind(this))},_ensureViewSearchPerformed:function(a){function b(b){b===
this._lastViewSearchId&&(this._viewSearchInProgress=!1,a())}this._viewSearchInProgress||(this.visibleView.hasSearchResults()?a():(this._lastViewSearchId=this._lastViewSearchId?this._lastViewSearchId+1:0,this._viewSearchInProgress=!0,this.visibleView.performSearch(this.currentQuery,b.bind(this,this._lastViewSearchId))))},_showSearchResult:function(a){this._lastSearchResultIndex=a.index;this._lastSearchResultTreeElement=a.treeElement;a.treeElement!==this.sidebarTree.selectedTreeElement&&(this.showResource(a.treeElement.representedObject),
WebInspector.searchController.showSearchField());this._ensureViewSearchPerformed(function(b){this.sidebarTree.selectedTreeElement===this._lastSearchResultTreeElement&&(-1!=this._lastSearchResultIndex&&this.visibleView.jumpToSearchResult(this._lastSearchResultIndex),WebInspector.searchController.updateCurrentMatchIndex(a.currentMatchIndex-1,this))}.bind(this))},_resetSearchResults:function(){this._forAllResourceTreeElements(function(a){a._resetSearchResults()});this.visibleView&&this.visibleView.searchCanceled&&
this.visibleView.searchCanceled();this._lastSearchResultTreeElement=null;this._lastSearchResultIndex=-1;this._viewSearchInProgress=!1},searchCanceled:function(){WebInspector.searchController.updateSearchMatchesCount(0,this);this._resetSearchResults();this._forAllResourceTreeElements(function(a){a._updateErrorsAndWarningsBubbles()})},jumpToNextSearchResult:function(){if(this.currentSearchMatches){var a=this._searchController.nextSearchResult(this.sidebarTree.selectedTreeElement);this._showSearchResult(a)}},
jumpToPreviousSearchResult:function(){if(this.currentSearchMatches){var a=this._searchController.previousSearchResult(this.sidebarTree.selectedTreeElement);this._showSearchResult(a)}},_forAllResourceTreeElements:function(a){for(var b=!1,c=this.resourcesListTreeElement;!b&&c;c=c.traverseNextTreeElement(!1,this.resourcesListTreeElement,!0))c instanceof WebInspector.FrameResourceTreeElement&&(b=a(c))},_findTreeElementForResource:function(a){return this.sidebarTree.findTreeElement(a,function(a,c){return!1},
function(a){return null})},showView:function(a){a&&this.showResource(a.resource)},_onmousemove:function(a){if(a=document.elementFromPoint(a.pageX,a.pageY))if(a=a.enclosingNodeOrSelfWithNodeName("li"))a=a.treeElement,this._previousHoveredElement!==a&&(this._previousHoveredElement&&(this._previousHoveredElement.hovered=!1,delete this._previousHoveredElement),a instanceof WebInspector.FrameTreeElement&&(this._previousHoveredElement=a,a.hovered=!0))},_onmouseout:function(a){this._previousHoveredElement&&
(this._previousHoveredElement.hovered=!1,delete this._previousHoveredElement)},__proto__:WebInspector.Panel.prototype};WebInspector.BaseStorageTreeElement=function(a,b,c,e,d,f){TreeElement.call(this,"",b,d);this._storagePanel=a;this._titleText=c;this._iconClasses=e;this._noIcon=f};
WebInspector.BaseStorageTreeElement.prototype={onattach:function(){this.listItemElement.removeChildren();if(this._iconClasses)for(var a=0;a<this._iconClasses.length;++a)this.listItemElement.addStyleClass(this._iconClasses[a]);a=document.createElement("div");a.className="selection";this.listItemElement.appendChild(a);this._noIcon||(this.imageElement=document.createElement("img"),this.imageElement.className="icon",this.listItemElement.appendChild(this.imageElement));this.titleElement=document.createElement("div");
this.titleElement.className="base-storage-tree-element-title";this._titleTextNode=document.createTextNode("");this.titleElement.appendChild(this._titleTextNode);this._updateTitle();this._updateSubtitle();this.listItemElement.appendChild(this.titleElement)},get displayName(){return this._displayName},_updateDisplayName:function(){this._displayName=this._titleText||"";this._subtitleText&&(this._displayName+=" ("+this._subtitleText+")")},_updateTitle:function(){this._updateDisplayName();this.titleElement&&
(this._titleTextNode.textContent=this._titleText||"")},_updateSubtitle:function(){this._updateDisplayName();this.titleElement&&(this._subtitleText?(this._subtitleElement||(this._subtitleElement=document.createElement("span"),this._subtitleElement.className="base-storage-tree-element-subtitle",this.titleElement.appendChild(this._subtitleElement)),this._subtitleElement.textContent="("+this._subtitleText+")"):this._subtitleElement&&(this.titleElement.removeChild(this._subtitleElement),delete this._subtitleElement))},
onselect:function(a){a&&(a=this.itemURL)&&WebInspector.settings.resourcesLastSelectedItem.set(a)},onreveal:function(){this.listItemElement&&this.listItemElement.scrollIntoViewIfNeeded(!1)},get titleText(){return this._titleText},set titleText(a){this._titleText=a;this._updateTitle()},get subtitleText(){return this._subtitleText},set subtitleText(a){this._subtitleText=a;this._updateSubtitle()},get searchMatchesCount(){return 0},__proto__:TreeElement.prototype};
WebInspector.StorageCategoryTreeElement=function(a,b,c,e,d){WebInspector.BaseStorageTreeElement.call(this,a,null,b,e,!0,d);this._expandedSettingKey="resources"+c+"Expanded";WebInspector.settings[this._expandedSettingKey]=WebInspector.settings.createSetting(this._expandedSettingKey,"Frames"===c);this._categoryName=b};
WebInspector.StorageCategoryTreeElement.prototype={get itemURL(){return"category://"+this._categoryName},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel.showCategoryView(this._categoryName)},onattach:function(){WebInspector.BaseStorageTreeElement.prototype.onattach.call(this);WebInspector.settings[this._expandedSettingKey].get()&&this.expand()},onexpand:function(){WebInspector.settings[this._expandedSettingKey].set(!0)},oncollapse:function(){WebInspector.settings[this._expandedSettingKey].set(!1)},
__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.FrameTreeElement=function(a,b){WebInspector.BaseStorageTreeElement.call(this,a,null,"",["frame-storage-tree-item"]);this._frame=b;this.frameNavigated(b)};
WebInspector.FrameTreeElement.prototype={frameNavigated:function(a){this.removeChildren();this._frameId=a.id;this.titleText=a.name;this.subtitleText=(new WebInspector.ParsedURL(a.url)).displayName;this._categoryElements={};this._treeElementForResource={};this._storagePanel.addDocumentURL(a.url)},get itemURL(){return"frame://"+encodeURI(this.displayName)},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel.showCategoryView(this.displayName);this.listItemElement.removeStyleClass("hovered");
DOMAgent.hideHighlight()},set hovered(a){a?(this.listItemElement.addStyleClass("hovered"),DOMAgent.highlightFrame(this._frameId,WebInspector.Color.PageHighlight.Content.toProtocolRGBA(),WebInspector.Color.PageHighlight.ContentOutline.toProtocolRGBA())):(this.listItemElement.removeStyleClass("hovered"),DOMAgent.hideHighlight())},appendResource:function(a){if(!a.isHidden()){var b=a.type.name(),c=a.type===WebInspector.resourceTypes.Document?this:this._categoryElements[b];c||(c=new WebInspector.StorageCategoryTreeElement(this._storagePanel,
a.type.categoryTitle(),b,null,!0),this._categoryElements[a.type.name()]=c,this._insertInPresentationOrder(this,c));b=new WebInspector.FrameResourceTreeElement(this._storagePanel,a);this._insertInPresentationOrder(c,b);this._treeElementForResource[a.url]=b}},resourceByURL:function(a){return(a=this._treeElementForResource[a])?a.representedObject:null},appendChild:function(a){this._insertInPresentationOrder(this,a)},_insertInPresentationOrder:function(a,b){function c(a){return a instanceof WebInspector.StorageCategoryTreeElement?
2:a instanceof WebInspector.FrameTreeElement?1:3}function e(a,b){var d=c(a),e=c(b);return d>e?1:d<e?-1:(a.displayName||a.titleText).localeCompare(b.displayName||b.titleText)}var d=a.children,f;for(f=0;f<d.length&&!(0>e(b,d[f]));++f);a.insertChild(b,f)},__proto__:WebInspector.BaseStorageTreeElement.prototype};
WebInspector.FrameResourceTreeElement=function(a,b){WebInspector.BaseStorageTreeElement.call(this,a,b,b.displayName,["resource-sidebar-tree-item","resources-type-"+b.type.name()]);this._resource=b;this._resource.addEventListener(WebInspector.Resource.Events.MessageAdded,this._consoleMessageAdded,this);this._resource.addEventListener(WebInspector.Resource.Events.MessagesCleared,this._consoleMessagesCleared,this);this.tooltip=b.url};
WebInspector.FrameResourceTreeElement.prototype={get itemURL(){return this._resource.url},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel._showResourceView(this._resource)},ondblclick:function(a){InspectorFrontendHost.openInNewTab(this._resource.url)},onattach:function(){WebInspector.BaseStorageTreeElement.prototype.onattach.call(this);if(this._resource.type===WebInspector.resourceTypes.Image){var a=document.createElement("img");a.className=
"image-resource-icon-preview";this._resource.populateImageSource(a);var b=document.createElement("div");b.className="icon";b.appendChild(a);this.listItemElement.replaceChild(b,this.imageElement)}this._statusElement=document.createElement("div");this._statusElement.className="status";this.listItemElement.insertBefore(this._statusElement,this.titleElement);this.listItemElement.draggable=!0;this.listItemElement.addEventListener("dragstart",this._ondragstart.bind(this),!1);this.listItemElement.addEventListener("contextmenu",
this._handleContextMenuEvent.bind(this),!0);this._updateErrorsAndWarningsBubbles()},_ondragstart:function(a){a.dataTransfer.setData("text/plain",this._resource.content);a.dataTransfer.effectAllowed="copy";return!0},_handleContextMenuEvent:function(a){a=new WebInspector.ContextMenu(a);a.appendApplicableItems(this._resource);this._resource.request&&a.appendApplicableItems(this._resource.request);a.show()},_setBubbleText:function(a){this._bubbleElement||(this._bubbleElement=document.createElement("div"),
this._bubbleElement.className="bubble",this._statusElement.appendChild(this._bubbleElement));this._bubbleElement.textContent=a},_resetBubble:function(){this._bubbleElement&&(this._bubbleElement.textContent="",this._bubbleElement.removeStyleClass("search-matches"),this._bubbleElement.removeStyleClass("warning"),this._bubbleElement.removeStyleClass("error"))},_resetSearchResults:function(){this._resetBubble();this._searchMatchesCount=0},get searchMatchesCount(){return this._searchMatchesCount},searchMatchesFound:function(a){this._resetSearchResults();
this._searchMatchesCount=a;this._setBubbleText(a);this._bubbleElement.addStyleClass("search-matches");for(a=this.parent;a&&!a.root;)a.expanded||a.expand(),a=a.parent},_updateErrorsAndWarningsBubbles:function(){this._storagePanel.currentQuery||(this._resetBubble(),(this._resource.warnings||this._resource.errors)&&this._setBubbleText(this._resource.warnings+this._resource.errors),this._resource.warnings&&this._bubbleElement.addStyleClass("warning"),this._resource.errors&&this._bubbleElement.addStyleClass("error"))},
_consoleMessagesCleared:function(){this._sourceView&&this._sourceView.clearMessages();this._updateErrorsAndWarningsBubbles()},_consoleMessageAdded:function(a){a=a.data;this._sourceView&&this._sourceView.addMessage(a);this._updateErrorsAndWarningsBubbles()},sourceView:function(){if(!this._sourceView&&(this._sourceView=new WebInspector.ResourceSourceFrame(this._resource),this._resource.messages))for(var a=0;a<this._resource.messages.length;a++)this._sourceView.addMessage(this._resource.messages[a]);
return this._sourceView},__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.DatabaseTreeElement=function(a,b){WebInspector.BaseStorageTreeElement.call(this,a,null,b.name,["database-storage-tree-item"],!0);this._database=b};
WebInspector.DatabaseTreeElement.prototype={get itemURL(){return"database://"+encodeURI(this._database.name)},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel._showDatabase(this._database)},onexpand:function(){this._updateChildren()},_updateChildren:function(){this.removeChildren();this._database.getTableNames(function(a){for(var b=a.length,c=0;c<b;++c)this.appendChild(new WebInspector.DatabaseTableTreeElement(this._storagePanel,this._database,
a[c]))}.bind(this))},__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.DatabaseTableTreeElement=function(a,b,c){WebInspector.BaseStorageTreeElement.call(this,a,null,c,["database-storage-tree-item"]);this._database=b;this._tableName=c};
WebInspector.DatabaseTableTreeElement.prototype={get itemURL(){return"database://"+encodeURI(this._database.name)+"/"+encodeURI(this._tableName)},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel._showDatabase(this._database,this._tableName)},__proto__:WebInspector.BaseStorageTreeElement.prototype};
WebInspector.IndexedDBTreeElement=function(a){WebInspector.StorageCategoryTreeElement.call(this,a,WebInspector.UIString("IndexedDB"),"IndexedDB",["indexed-db-storage-tree-item"])};
WebInspector.IndexedDBTreeElement.prototype={onexpand:function(){WebInspector.StorageCategoryTreeElement.prototype.onexpand.call(this);this._indexedDBModel||this._createIndexedDBModel()},onattach:function(){WebInspector.StorageCategoryTreeElement.prototype.onattach.call(this);this.listItemElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0)},_handleContextMenuEvent:function(a){a=new WebInspector.ContextMenu(a);a.appendItem(WebInspector.UIString("Refresh IndexedDB"),this.refreshIndexedDB.bind(this));
a.show()},_createIndexedDBModel:function(){this._indexedDBModel=new WebInspector.IndexedDBModel;this._idbDatabaseTreeElements=[];this._indexedDBModel.addEventListener(WebInspector.IndexedDBModel.EventTypes.DatabaseAdded,this._indexedDBAdded,this);this._indexedDBModel.addEventListener(WebInspector.IndexedDBModel.EventTypes.DatabaseRemoved,this._indexedDBRemoved,this);this._indexedDBModel.addEventListener(WebInspector.IndexedDBModel.EventTypes.DatabaseLoaded,this._indexedDBLoaded,this)},refreshIndexedDB:function(){this._indexedDBModel?
this._indexedDBModel.refreshDatabaseNames():this._createIndexedDBModel()},_indexedDBAdded:function(a){a=a.data;var b=new WebInspector.IDBDatabaseTreeElement(this._storagePanel,this._indexedDBModel,a);this._idbDatabaseTreeElements.push(b);this.appendChild(b);this._indexedDBModel.refreshDatabase(a)},_indexedDBRemoved:function(a){if(a=this._idbDatabaseTreeElement(a.data))a.clear(),this.removeChild(a),this._idbDatabaseTreeElements.remove(a)},_indexedDBLoaded:function(a){a=a.data;var b=this._idbDatabaseTreeElement(a.databaseId);
b&&b.update(a)},_idbDatabaseTreeElement:function(a){for(var b=-1,c=0;c<this._idbDatabaseTreeElements.length;++c)if(this._idbDatabaseTreeElements[c]._databaseId.equals(a)){b=c;break}return-1!==b?this._idbDatabaseTreeElements[c]:null},__proto__:WebInspector.StorageCategoryTreeElement.prototype};WebInspector.FileSystemListTreeElement=function(a){WebInspector.StorageCategoryTreeElement.call(this,a,WebInspector.UIString("FileSystem"),"FileSystem",["file-system-storage-tree-item"])};
WebInspector.FileSystemListTreeElement.prototype={onexpand:function(){WebInspector.StorageCategoryTreeElement.prototype.onexpand.call(this);this._refreshFileSystem()},onattach:function(){WebInspector.StorageCategoryTreeElement.prototype.onattach.call(this);this.listItemElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0)},_handleContextMenuEvent:function(a){a=new WebInspector.ContextMenu(a);a.appendItem(WebInspector.UIString(WebInspector.useLowerCaseMenuTitles()?"Refresh FileSystem list":
"Refresh FileSystem List"),this._refreshFileSystem.bind(this));a.show()},_fileSystemAdded:function(a){a=new WebInspector.FileSystemTreeElement(this._storagePanel,a.data);this.appendChild(a)},_fileSystemRemoved:function(a){if(a=this._fileSystemTreeElementByName(a.data.name))a.clear(),this.removeChild(a)},_fileSystemTreeElementByName:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b].fileSystemName===a)return this.children[b];return null},_refreshFileSystem:function(){this._fileSystemModel||
(this._fileSystemModel=new WebInspector.FileSystemModel,this._fileSystemModel.addEventListener(WebInspector.FileSystemModel.EventTypes.FileSystemAdded,this._fileSystemAdded,this),this._fileSystemModel.addEventListener(WebInspector.FileSystemModel.EventTypes.FileSystemRemoved,this._fileSystemRemoved,this));this._fileSystemModel.refreshFileSystemList()},__proto__:WebInspector.StorageCategoryTreeElement.prototype};
WebInspector.IDBDatabaseTreeElement=function(a,b,c){WebInspector.BaseStorageTreeElement.call(this,a,null,c.name+" - "+c.securityOrigin,["indexed-db-storage-tree-item"]);this._model=b;this._databaseId=c;this._idbObjectStoreTreeElements={}};
WebInspector.IDBDatabaseTreeElement.prototype={get itemURL(){return"indexedDB://"+this._databaseId.securityOrigin+"/"+this._databaseId.name},onattach:function(){WebInspector.BaseStorageTreeElement.prototype.onattach.call(this);this.listItemElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0)},_handleContextMenuEvent:function(a){a=new WebInspector.ContextMenu(a);a.appendItem(WebInspector.UIString("Refresh IndexedDB"),this._refreshIndexedDB.bind(this));a.show()},_refreshIndexedDB:function(){this._model.refreshDatabaseNames()},
update:function(a){this._database=a;var b={},c;for(c in this._database.objectStores){var e=this._database.objectStores[c];b[e.name]=!0;if(!this._idbObjectStoreTreeElements[e.name]){var d=new WebInspector.IDBObjectStoreTreeElement(this._storagePanel,this._model,this._databaseId,e);this._idbObjectStoreTreeElements[e.name]=d;this.appendChild(d)}this._idbObjectStoreTreeElements[e.name].update(e)}for(c in this._idbObjectStoreTreeElements)b[c]||this._objectStoreRemoved(c);this.children.length&&(this.hasChildren=
!0,this.expand());this._view&&this._view.update(a);this._updateTooltip()},_updateTooltip:function(){this.tooltip=WebInspector.UIString("Version")+": "+this._database.version},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._view||(this._view=new WebInspector.IDBDatabaseView(this._database));this._storagePanel.showIndexedDB(this._view)},_objectStoreRemoved:function(a){var b=this._idbObjectStoreTreeElements[a];b.clear();this.removeChild(b);delete this._idbObjectStoreTreeElements[a]},
clear:function(){for(var a in this._idbObjectStoreTreeElements)this._objectStoreRemoved(a)},__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.IDBObjectStoreTreeElement=function(a,b,c,e){WebInspector.BaseStorageTreeElement.call(this,a,null,e.name,["indexed-db-object-store-storage-tree-item"]);this._model=b;this._databaseId=c;this._idbIndexTreeElements={}};
WebInspector.IDBObjectStoreTreeElement.prototype={get itemURL(){return"indexedDB://"+this._databaseId.securityOrigin+"/"+this._databaseId.name+"/"+this._objectStore.name},onattach:function(){WebInspector.BaseStorageTreeElement.prototype.onattach.call(this);this.listItemElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0)},_handleContextMenuEvent:function(a){a=new WebInspector.ContextMenu(a);a.appendItem(WebInspector.UIString("Clear"),this._clearObjectStore.bind(this));
a.show()},_clearObjectStore:function(){this._model.clearObjectStore(this._databaseId,this._objectStore.name,function(){this.update(this._objectStore)}.bind(this))},update:function(a){this._objectStore=a;a={};for(var b in this._objectStore.indexes){var c=this._objectStore.indexes[b];a[c.name]=!0;if(!this._idbIndexTreeElements[c.name]){var e=new WebInspector.IDBIndexTreeElement(this._storagePanel,this._model,this._databaseId,this._objectStore,c);this._idbIndexTreeElements[c.name]=e;this.appendChild(e)}this._idbIndexTreeElements[c.name].update(c)}for(b in this._idbIndexTreeElements)a[b]||
this._indexRemoved(b);for(b in this._idbIndexTreeElements)a[b]||(this.removeChild(this._idbIndexTreeElements[b]),delete this._idbIndexTreeElements[b]);this.children.length&&(this.hasChildren=!0,this.expand());this._view&&this._view.update(this._objectStore);this._updateTooltip()},_updateTooltip:function(){var a=this._objectStore.keyPathString,a=null!==a?WebInspector.UIString("Key path: ")+a:"";this._objectStore.autoIncrement&&(a+="\n"+WebInspector.UIString("autoIncrement"));this.tooltip=a},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,
a);this._view||(this._view=new WebInspector.IDBDataView(this._model,this._databaseId,this._objectStore,null));this._storagePanel.showIndexedDB(this._view)},_indexRemoved:function(a){var b=this._idbIndexTreeElements[a];b.clear();this.removeChild(b);delete this._idbIndexTreeElements[a]},clear:function(){for(var a in this._idbIndexTreeElements)this._indexRemoved(a);this._view&&this._view.clear()},__proto__:WebInspector.BaseStorageTreeElement.prototype};
WebInspector.IDBIndexTreeElement=function(a,b,c,e,d){WebInspector.BaseStorageTreeElement.call(this,a,null,d.name,["indexed-db-index-storage-tree-item"]);this._model=b;this._databaseId=c;this._objectStore=e;this._index=d};
WebInspector.IDBIndexTreeElement.prototype={get itemURL(){return"indexedDB://"+this._databaseId.securityOrigin+"/"+this._databaseId.name+"/"+this._objectStore.name+"/"+this._index.name},update:function(a){this._index=a;this._view&&this._view.update(this._index);this._updateTooltip()},_updateTooltip:function(){var a=[],b=this._index.keyPathString;a.push(WebInspector.UIString("Key path: ")+b);this._index.unique&&a.push(WebInspector.UIString("unique"));this._index.multiEntry&&a.push(WebInspector.UIString("multiEntry"));
this.tooltip=a.join("\n")},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._view||(this._view=new WebInspector.IDBDataView(this._model,this._databaseId,this._objectStore,this._index));this._storagePanel.showIndexedDB(this._view)},clear:function(){this._view&&this._view.clear()},__proto__:WebInspector.BaseStorageTreeElement.prototype};
WebInspector.DOMStorageTreeElement=function(a,b,c){WebInspector.BaseStorageTreeElement.call(this,a,null,b.securityOrigin?b.securityOrigin:WebInspector.UIString("Local Files"),["domstorage-storage-tree-item",c]);this._domStorage=b};
WebInspector.DOMStorageTreeElement.prototype={get itemURL(){return"storage://"+this._domStorage.securityOrigin+"/"+(this._domStorage.isLocalStorage?"local":"session")},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel._showDOMStorage(this._domStorage)},__proto__:WebInspector.BaseStorageTreeElement.prototype};
WebInspector.CookieTreeElement=function(a,b){WebInspector.BaseStorageTreeElement.call(this,a,null,b?b:WebInspector.UIString("Local Files"),["cookie-storage-tree-item"]);this._cookieDomain=b};
WebInspector.CookieTreeElement.prototype={get itemURL(){return"cookies://"+this._cookieDomain},onattach:function(){WebInspector.BaseStorageTreeElement.prototype.onattach.call(this);this.listItemElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0)},_handleContextMenuEvent:function(a){a=new WebInspector.ContextMenu(a);a.appendItem(WebInspector.UIString("Clear"),this._clearCookies.bind(this));a.show()},_clearCookies:function(a){this._storagePanel.clearCookies(this._cookieDomain)},
onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel.showCookies(this,this._cookieDomain)},__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.ApplicationCacheManifestTreeElement=function(a,b){var c=(new WebInspector.ParsedURL(b)).displayName;WebInspector.BaseStorageTreeElement.call(this,a,null,c,["application-cache-storage-tree-item"]);this._manifestURL=this.tooltip=b};
WebInspector.ApplicationCacheManifestTreeElement.prototype={get itemURL(){return"appcache://"+this._manifestURL},get manifestURL(){return this._manifestURL},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel.showCategoryView(this._manifestURL)},__proto__:WebInspector.BaseStorageTreeElement.prototype};
WebInspector.ApplicationCacheFrameTreeElement=function(a,b,c){WebInspector.BaseStorageTreeElement.call(this,a,null,"",["frame-storage-tree-item"]);this._frameId=b;this._manifestURL=c;this._refreshTitles()};
WebInspector.ApplicationCacheFrameTreeElement.prototype={get itemURL(){return"appcache://"+this._manifestURL+"/"+encodeURI(this.displayName)},get frameId(){return this._frameId},get manifestURL(){return this._manifestURL},_refreshTitles:function(){var a=WebInspector.resourceTreeModel.frameForId(this._frameId);a?(this.titleText=a.name,this.subtitleText=(new WebInspector.ParsedURL(a.url)).displayName):this.subtitleText=WebInspector.UIString("new frame")},frameNavigated:function(){this._refreshTitles()},
onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._storagePanel.showApplicationCache(this._frameId)},__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.FileSystemTreeElement=function(a,b){WebInspector.BaseStorageTreeElement.call(this,a,null,b.type+" - "+b.origin,["file-system-storage-tree-item"]);this._fileSystem=b};
WebInspector.FileSystemTreeElement.prototype={get fileSystemName(){return this._fileSystem.name},get itemURL(){return"filesystem://"+this._fileSystem.name},onselect:function(a){WebInspector.BaseStorageTreeElement.prototype.onselect.call(this,a);this._fileSystemView=new WebInspector.FileSystemView(this._fileSystem);this._storagePanel.showFileSystem(this._fileSystemView)},clear:function(){this.fileSystemView&&this._storagePanel.visibleView===this.fileSystemView&&this._storagePanel.closeVisibleView()},
__proto__:WebInspector.BaseStorageTreeElement.prototype};WebInspector.StorageCategoryView=function(){WebInspector.View.call(this);this.element.addStyleClass("storage-view");this._emptyView=new WebInspector.EmptyView("");this._emptyView.show(this.element)};WebInspector.StorageCategoryView.prototype={setText:function(a){this._emptyView.text=a},__proto__:WebInspector.View.prototype};
WebInspector.ResourcesSearchController=function(a,b){this._root=a;this._matchesCount=b;this._traverser=new WebInspector.SearchResultsTreeElementsTraverser(a);this._lastTreeElement=null;this._lastIndex=-1};
WebInspector.ResourcesSearchController.prototype={nextSearchResult:function(a){return a?a.searchMatchesCount?this._lastTreeElement!==a||-1===this._lastIndex?this._searchResult(a,0):this._lastIndex===a.searchMatchesCount-1?this._searchResult(this._traverser.next(a),0,this._currentMatchIndex%this._matchesCount+1):this._searchResult(a,this._lastIndex+1,this._currentMatchIndex+1):this._searchResult(this._traverser.next(a),0):this._searchResult(this._traverser.first(),0,1)},previousSearchResult:function(a){if(!a)return a=
this._traverser.last(),this._searchResult(a,a.searchMatchesCount-1,this._matchesCount);if(a.searchMatchesCount&&this._lastTreeElement===a){if(0<this._lastIndex)return this._searchResult(a,this._lastIndex-1,this._currentMatchIndex-1);a=this._traverser.previous(a);return this._searchResult(a,a.searchMatchesCount-1,this._currentMatchIndex-1?this._currentMatchIndex-1:this._matchesCount)}a=this._traverser.previous(a);return this._searchResult(a,a.searchMatchesCount-1)},_searchResult:function(a,b,c){this._lastTreeElement=
a;this._lastIndex=b;c||(c=this._traverser.matchIndex(a,b));this._currentMatchIndex=c;return{treeElement:a,index:b,currentMatchIndex:c}}};WebInspector.SearchResultsTreeElementsTraverser=function(a){this._root=a};
WebInspector.SearchResultsTreeElementsTraverser.prototype={first:function(){return this.next(this._root)},last:function(){return this.previous(this._root)},next:function(a){var b=a;do b=this._traverseNext(b)||this._root;while(b!=a&&!this._elementSearchMatchesCount(b));return b},previous:function(a){var b=a;do b=this._traversePrevious(b)||this._lastTreeElement();while(b!=a&&!this._elementSearchMatchesCount(b));return b},matchIndex:function(a,b){for(var c=1,e=this._root;e!=a;)if(c+=this._elementSearchMatchesCount(e),
e=this._traverseNext(e)||this._root,e===this._root)return 0;return c+b},_elementSearchMatchesCount:function(a){return a.searchMatchesCount},_traverseNext:function(a){return a.traverseNextTreeElement(!1,this._root,!0)},_traversePrevious:function(a){return a.traversePreviousTreeElement(!1,!0)},_lastTreeElement:function(){for(var a=this._root,b;b=this._traverseNext(a);)a=b;return a}};
